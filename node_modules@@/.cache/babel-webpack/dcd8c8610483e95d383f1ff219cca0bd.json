{"ast":null,"code":"import _asyncToGenerator from \"C:/FH/fh-cloud-app/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"!C:\\\\FH\\\\fh-cloud-app\\\\node_modules\\\\@ngtools\\\\webpack\\\\src\\\\loaders\\\\direct-resource.js!./expense-payment-detail.component.html\";\nimport __NG_CLI_RESOURCE__1 from \"./expense-payment-detail.component.css\";\nimport { Component, ViewChild } from \"@angular/core\";\nimport * as moment from \"moment\";\nimport { AccountService } from \"src/app/services/account.service\";\nimport { ListService } from \"src/app/services/list.service\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { NgbModal } from \"@ng-bootstrap/ng-bootstrap\";\nimport * as html2pdf from \"html2pdf.js\";\nlet ExpensePaymentDetailComponent = class ExpensePaymentDetailComponent {\n  constructor(accountService, listService, route, modalService) {\n    this.accountService = accountService;\n    this.listService = listService;\n    this.route = route;\n    this.modalService = modalService;\n    this.paymentData = {\n      entityName: \"\",\n      paymentTo: null,\n      entityId: null,\n      paymentNo: \"\",\n      txnDate: moment().format(\"YYYY-MM-DD\"),\n      fromDate: null,\n      toDate: null,\n      settlementIds: [],\n      advancePayIds: [],\n      payMode: null,\n      payModeNo: \"\",\n      payModeDate: null,\n      currency: \"CAD\",\n      finalAmount: 0,\n      accountID: null,\n      advData: [],\n      transactionLog: [],\n      expData: [],\n      expIds: [],\n      advTotal: 0,\n      expTotal: 0,\n      isFeatEnabled: false\n    };\n    this.showModal = false;\n    this.paymentID = \"\";\n    this.accountsObjects = {};\n    this.downloadDisabled = true;\n  }\n\n  ngOnInit() {\n    this.paymentID = this.route.snapshot.params[\"paymentID\"]; // this.fetchAccountsByIDs();\n\n    this.fetchPayment();\n  }\n\n  showCheque() {\n    this.showModal = true;\n    let obj = {\n      entityId: this.paymentData.entityId,\n      chequeDate: this.paymentData.payModeDate,\n      chequeAmount: this.paymentData.finalAmount,\n      type: \"expensePayment\",\n      paymentTo: this.paymentData.paymentTo,\n      chequeNo: this.paymentData.payModeNo,\n      currency: this.paymentData.currency,\n      showModal: this.showModal,\n      fromDate: this.paymentData.fromDate,\n      toDate: this.paymentData.toDate,\n      finalAmount: this.paymentData.finalAmount,\n      txnDate: this.paymentData.txnDate,\n      page: \"detail\"\n    };\n    this.listService.openPaymentChequeModal(obj);\n  }\n\n  fetchPayment() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.downloadDisabled = true;\n      const result = yield _this.accountService.getData(`expense-payments/detail/${_this.paymentID}`).toPromise();\n      _this.paymentData = result;\n      _this.companyLogo = result.carrierDtl.logo;\n      _this.tagLine = result.carrierDtl.tagLine;\n      _this.carrierName = result.carrierDtl.carrierName;\n      _this.downloadDisabled = false;\n\n      if (!_this.paymentData.isFeatEnabled) {\n        _this.fetchAccountsByIDs();\n      }\n    })();\n  }\n\n  fetchAccountsByIDs() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.accountsObjects = yield _this2.accountService.getData(\"chartAc/get/all/list\").toPromise();\n    })();\n  }\n\n  openModal() {\n    let ngbModalOptions = {\n      keyboard: false,\n      backdrop: \"static\",\n      windowClass: \"preview-sale-order\"\n    };\n    this.expPayRef = this.modalService.open(this.previewExpPayment, ngbModalOptions);\n  }\n\n  generatePaymentPDF() {\n    let data = document.getElementById(\"print-exp-pay\");\n    html2pdf(data, {\n      margin: 0.5,\n      pagebreak: {\n        mode: \"avoid-all\",\n        before: 'print-exp-pay'\n      },\n      filename: `expense-payment-${this.paymentData.paymentNo}.pdf`,\n      image: {\n        type: \"jpeg\",\n        quality: 0.98\n      },\n      html2canvas: {\n        scale: 2,\n        logging: true,\n        dpi: 192,\n        letterRendering: true,\n        allowTaint: true,\n        useCORS: true\n      },\n      jsPDF: {\n        unit: \"in\",\n        format: \"a4\",\n        orientation: \"portrait\"\n      }\n    });\n    this.expPayRef.close();\n    this.downloadDisabled = false;\n  }\n\n};\n\nExpensePaymentDetailComponent.ctorParameters = () => [{\n  type: AccountService\n}, {\n  type: ListService\n}, {\n  type: ActivatedRoute\n}, {\n  type: NgbModal\n}];\n\nExpensePaymentDetailComponent.propDecorators = {\n  previewExpPayment: [{\n    type: ViewChild,\n    args: [\"previewExpPayment\", {\n      static: true\n    }]\n  }]\n};\nExpensePaymentDetailComponent = __decorate([Component({\n  selector: \"app-expense-payment-detail\",\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], ExpensePaymentDetailComponent);\nexport { ExpensePaymentDetailComponent };","map":null,"metadata":{},"sourceType":"module"}