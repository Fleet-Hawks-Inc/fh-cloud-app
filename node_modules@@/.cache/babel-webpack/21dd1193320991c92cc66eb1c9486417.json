{"ast":null,"code":"import _asyncToGenerator from \"C:/FH/fh-cloud-app/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { animate, style, transition, trigger } from \"@angular/animations\";\nimport { MapInfoWindow } from \"@angular/google-maps\";\nimport { Subject } from \"rxjs\";\nimport { environment } from \"src/environments/environment\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"primeng/button\";\nimport * as i4 from \"@angular/google-maps\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/router\";\n\nfunction MapDashboardComponent_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 37);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r0.driverPositions.length, \" Drivers\");\n  }\n}\n\nfunction MapDashboardComponent_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 37);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r1.assetPositions.length, \" Assets\");\n  }\n}\n\nfunction MapDashboardComponent_button_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 37);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r2.vehicleDashPositions.length, \" Vehicles\");\n  }\n}\n\nfunction MapDashboardComponent_map_marker_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"map-marker\", 38, 39);\n    i0.ɵɵlistener(\"mapClick\", function MapDashboardComponent_map_marker_14_Template_map_marker_mapClick_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const driverPosition_r10 = restoredCtx.$implicit;\n\n      const _r11 = i0.ɵɵreference(1);\n\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.openInfoWindow(_r11, driverPosition_r10.data, \"driver\");\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const driverPosition_r10 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"position\", driverPosition_r10.position)(\"options\", ctx_r3.driverMarkerOptions);\n  }\n}\n\nfunction MapDashboardComponent_map_marker_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"map-marker\", 38, 39);\n    i0.ɵɵlistener(\"mapClick\", function MapDashboardComponent_map_marker_16_Template_map_marker_mapClick_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const assetPosition_r14 = restoredCtx.$implicit;\n\n      const _r15 = i0.ɵɵreference(1);\n\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.openInfoWindow(_r15, assetPosition_r14.data, \"asset\");\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const assetPosition_r14 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"position\", assetPosition_r14.position)(\"options\", ctx_r4.assetMarkerOptions);\n  }\n}\n\nfunction MapDashboardComponent_map_marker_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"map-marker\", 38, 39);\n    i0.ɵɵlistener(\"mapClick\", function MapDashboardComponent_map_marker_17_Template_map_marker_mapClick_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r21);\n      const vehiclePosition_r18 = restoredCtx.$implicit;\n\n      const _r19 = i0.ɵɵreference(1);\n\n      const ctx_r20 = i0.ɵɵnextContext();\n      return ctx_r20.openInfoWindow(_r19, vehiclePosition_r18.data, \"vehicle\");\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const vehiclePosition_r18 = ctx.$implicit;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"position\", vehiclePosition_r18.position)(\"options\", ctx_r5.vehicleMarkerOptions);\n  }\n}\n\nfunction MapDashboardComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵelementStart(1, \"section\", 41);\n    i0.ɵɵelementStart(2, \"header\", 42);\n    i0.ɵɵelementStart(3, \"div\", 43);\n    i0.ɵɵelement(4, \"a\", 44);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"h2\", 45);\n    i0.ɵɵelement(6, \"i\", 46);\n    i0.ɵɵtext(7, \"\\u00A0\\u00A0\\u00A0 Entire Fleet \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 47);\n    i0.ɵɵelementStart(9, \"select\", 48);\n    i0.ɵɵelementStart(10, \"optgroup\", 49);\n    i0.ɵɵelementStart(11, \"option\", 50);\n    i0.ɵɵtext(12, \"Groups\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"option\", 51);\n    i0.ɵɵtext(14, \"Vehicles\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"option\", 51);\n    i0.ɵɵtext(16, \"Drivers\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"option\", 51);\n    i0.ɵɵtext(18, \"Assets\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"div\", 52);\n    i0.ɵɵelementStart(20, \"div\", 53);\n    i0.ɵɵelementStart(21, \"ul\");\n    i0.ɵɵelementStart(22, \"li\", 54);\n    i0.ɵɵtext(23, \" Entire Fleet \");\n    i0.ɵɵelementStart(24, \"ul\");\n    i0.ɵɵelementStart(25, \"li\", 55);\n    i0.ɵɵtext(26, \" Long Haul \");\n    i0.ɵɵelementStart(27, \"ul\");\n    i0.ɵɵelementStart(28, \"li\", 56);\n    i0.ɵɵtext(29, \" John Smith \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"li\", 56);\n    i0.ɵɵtext(31, \" Mike William \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"li\", 56);\n    i0.ɵɵtext(33, \" Harry Johnson \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"li\", 56);\n    i0.ɵɵtext(35, \" James \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(36, \"li\", 56);\n    i0.ɵɵtext(37, \" Juan Carlos \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(38, \"li\", 56);\n    i0.ɵɵtext(39, \" Mike Jones \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(40, \"li\", 56);\n    i0.ɵɵtext(41, \" Sarah Smith \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(42, \"li\", 57);\n    i0.ɵɵtext(43, \" Short Haul \");\n    i0.ɵɵelementStart(44, \"ul\");\n    i0.ɵɵelementStart(45, \"li\", 56);\n    i0.ɵɵtext(46, \" John Smith \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(47, \"li\", 56);\n    i0.ɵɵtext(48, \" Mike William \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(49, \"li\", 56);\n    i0.ɵɵtext(50, \" Harry Johnson \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(51, \"li\", 56);\n    i0.ɵɵtext(52, \" James Rodriguez \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(53, \"li\", 56);\n    i0.ɵɵtext(54, \" Juan Carlos \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(55, \"li\", 56);\n    i0.ɵɵtext(56, \" Mike Jones \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(57, \"li\", 56);\n    i0.ɵɵtext(58, \" Sarah Smith \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(59, \"li\", 57);\n    i0.ɵɵtext(60, \" Regions \");\n    i0.ɵɵelementStart(61, \"ul\");\n    i0.ɵɵelementStart(62, \"li\", 56);\n    i0.ɵɵtext(63, \" Canada \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(64, \"li\", 56);\n    i0.ɵɵtext(65, \" Central \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(66, \"li\", 56);\n    i0.ɵɵtext(67, \" Mexico \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(68, \"li\", 56);\n    i0.ɵɵtext(69, \" Northeast \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(70, \"li\", 56);\n    i0.ɵɵtext(71, \" Southeast \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(72, \"li\", 56);\n    i0.ɵɵtext(73, \" Southeast \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(74, \"li\", 56);\n    i0.ɵɵtext(75, \" West \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(76, \"li\", 57);\n    i0.ɵɵtext(77, \"Ungrouped\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MapDashboardComponent_div_61_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 58);\n    i0.ɵɵelementStart(1, \"a\", 59);\n    i0.ɵɵlistener(\"click\", function MapDashboardComponent_div_61_Template_a_click_1_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return ctx_r22.valuechange();\n    });\n    i0.ɵɵelement(2, \"i\", 60);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MapDashboardComponent_div_62_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 61);\n    i0.ɵɵelementStart(1, \"a\", 59);\n    i0.ɵɵlistener(\"click\", function MapDashboardComponent_div_62_Template_a_click_1_listener() {\n      i0.ɵɵrestoreView(_r25);\n      const ctx_r24 = i0.ɵɵnextContext();\n      return ctx_r24.valuechange();\n    });\n    i0.ɵɵelement(2, \"i\", 62);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MapDashboardComponent_div_64_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 66);\n    i0.ɵɵelement(1, \"img\", 67);\n    i0.ɵɵelement(2, \"br\");\n    i0.ɵɵelementStart(3, \"div\", 68);\n    i0.ɵɵelementStart(4, \"p\", 69);\n    i0.ɵɵtext(5, \" There are no active trips.\");\n    i0.ɵɵelement(6, \"br\");\n    i0.ɵɵtext(7, \" Only the started trips with driver driving will be shown here. \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MapDashboardComponent_div_64_div_2_div_1_a_7_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \" | \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MapDashboardComponent_div_64_div_2_div_1_a_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 75);\n    i0.ɵɵtemplate(1, MapDashboardComponent_div_64_div_2_div_1_a_7_span_1_Template, 2, 0, \"span\", 65);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const data_r29 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", data_r29.driverData.main && data_r29.driverData.other);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", data_r29.driverData.other ? data_r29.driverData.other.fullName : \"\", \" \");\n  }\n}\n\nfunction MapDashboardComponent_div_64_div_2_div_1_span_16_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \",\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MapDashboardComponent_div_64_div_2_div_1_span_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵtemplate(2, MapDashboardComponent_div_64_div_2_div_1_span_16_span_2_Template, 2, 0, \"span\", 65);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const asst_r34 = ctx.$implicit;\n    const astInd_r35 = ctx.index;\n    const data_r29 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", asst_r34.assetIdentification, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", astInd_r35 < data_r29.assetData.length - 1);\n  }\n}\n\nfunction MapDashboardComponent_div_64_div_2_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 71);\n    i0.ɵɵelementStart(1, \"div\", 72);\n    i0.ɵɵelementStart(2, \"div\", 4);\n    i0.ɵɵelementStart(3, \"div\", 73);\n    i0.ɵɵelementStart(4, \"p\", 74);\n    i0.ɵɵelementStart(5, \"a\", 75);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, MapDashboardComponent_div_64_div_2_div_1_a_7_Template, 3, 2, \"a\", 76);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"div\", 77);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 4);\n    i0.ɵɵelementStart(10, \"div\", 78);\n    i0.ɵɵelementStart(11, \"p\", 79);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 80);\n    i0.ɵɵelementStart(14, \"p\", 79);\n    i0.ɵɵtext(15, \" Assets: \");\n    i0.ɵɵtemplate(16, MapDashboardComponent_div_64_div_2_div_1_span_16_Template, 3, 2, \"span\", 81);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"p\", 82);\n    i0.ɵɵtext(18, \" Trip \");\n    i0.ɵɵelementStart(19, \"span\", 83);\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"a\", 84);\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"span\", 85);\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const data_r29 = ctx.$implicit;\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"\", data_r29.driverData.main ? data_r29.driverData.main.fullName : \"\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", data_r29.driverData.other);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" Vehicle: \", data_r29.vehicleData[0].vehicleIdentification, \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", data_r29.assetData);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(data_r29.tripStatus);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Trip#: \", data_r29.tripNo, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(data_r29.tripType);\n  }\n}\n\nfunction MapDashboardComponent_div_64_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, MapDashboardComponent_div_64_div_2_div_1_Template, 25, 7, \"div\", 70);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r27 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r27.activeTrips);\n  }\n}\n\nfunction MapDashboardComponent_div_64_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 63);\n    i0.ɵɵtemplate(1, MapDashboardComponent_div_64_div_1_Template, 8, 0, \"div\", 64);\n    i0.ɵɵtemplate(2, MapDashboardComponent_div_64_div_2_Template, 2, 1, \"div\", 65);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"@slideInOut\", undefined);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.activeTrips.length == 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.activeTrips.length > 0);\n  }\n}\n\nexport class MapDashboardComponent {\n  constructor(apiService) {\n    this.apiService = apiService;\n    this.environment = environment.isFeatureEnabled;\n    this.title = \"Map Dashboard\";\n    this.visible = false;\n    this.width = \"100%\";\n    this.height = \"100%\";\n    this.infoDetail = \"No data\";\n    this.searchTerm = new Subject(); // Google Maps\n\n    this.mapOptions = {\n      center: {\n        lat: 48.48248695279594,\n        lng: -99.0688673798094\n      },\n      zoomControl: true,\n      mapTypeControl: true,\n      streetViewControl: false,\n      fullscreenControl: true,\n      zoom: 5,\n      mapId: '620eb1a41a9e36d4'\n    };\n    this.lat = -104.618896;\n    this.lng = 50.44521;\n    this.driverMarkerOptions = {\n      draggable: false,\n      icon: 'assets/driver-marker.png',\n      animation: google.maps.Animation.DROP\n    };\n    this.assetMarkerOptions = {\n      draggable: false,\n      icon: 'assets/asset-marker.png',\n      animation: google.maps.Animation.DROP\n    };\n    this.vehicleMarkerOptions = {\n      draggable: false,\n      icon: 'assets/vehicle-marker.png',\n      animation: google.maps.Animation.DROP\n    };\n    this.driverPositions = [];\n    this.assetPositions = [];\n    this.vehicleDashPositions = [];\n    this.isControlAdded = false;\n    this.frontEndData = {\n      drivers: {}\n    };\n    this.activeTrips = [];\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.getCurrentDriverLocation();\n      yield _this.getCurrentAssetLocation();\n      yield _this.getVehicleLocationByDashCam();\n    })();\n  }\n  /**\r\n   * Get driver location for last 24 hours\r\n   */\n\n\n  getCurrentDriverLocation() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.apiService.getData('dashboard/drivers/getCurrentDriverLocation').subscribe(data => {\n        if (data) {\n          _this2.driverPositions = [];\n\n          for (const key in data) {\n            const value = data[key];\n            const speedVal = parseInt(value.speed) / 3.6;\n\n            _this2.driverPositions.push({\n              position: {\n                lng: parseFloat(value.lng),\n                lat: parseFloat(value.lat)\n              },\n              data: {\n                userId: value.userId,\n                time: `${new Date(value.timeCreated).toLocaleDateString()} | ${new Date(value.timeCreated).toLocaleTimeString()}`,\n                speed: speedVal.toFixed(2),\n                driverId: key,\n                altitude: parseInt(value.altitude).toFixed(2),\n                location: value.location\n              }\n            });\n          }\n        } else {// console.log('No data');\n        }\n      });\n    })();\n  }\n  /**\r\n  * Get driver location for last 24 hours\r\n  */\n\n\n  getCurrentAssetLocation() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      _this3.apiService.getData('dashboard/assets/getCurrentAssetLocation').subscribe(data => {\n        if (data) {\n          _this3.assetPositions = [];\n\n          for (const asset of data) {\n            _this3.assetPositions.push({\n              position: {\n                lng: parseFloat(asset.lng),\n                lat: parseFloat(asset.lat)\n              },\n              data: {\n                assetIdentification: asset.assetIdentification,\n                time: `${new Date(asset.timeModified).toLocaleDateString()} | ${new Date(asset.timeModified).toLocaleTimeString()}`,\n                speed: asset.speed,\n                assetID: asset.assetID,\n                altitude: parseInt(asset.altitude).toFixed(2),\n                battery: asset.battery,\n                temp: asset.temp,\n                location: asset.location\n              }\n            });\n          }\n        } else {// console.log('No data');\n        }\n      });\n    })();\n  }\n  /**\r\n  * Get vehicle location by dashCam\r\n  */\n\n\n  getVehicleLocationByDashCam() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      _this4.apiService.getData('dashboard/vehicle/getLocationViaDashCam').subscribe(data => {\n        if (data) {\n          _this4.vehicleDashPositions = [];\n\n          for (const devices of data) {\n            _this4.vehicleDashPositions.push({\n              position: {\n                lng: parseFloat(devices.location.lng),\n                lat: parseFloat(devices.location.lat)\n              },\n              data: {\n                vehicleIdentification: devices.vehicleIdentification,\n                time: `${new Date(devices.timeModified).toLocaleDateString()} | ${new Date(devices.timeModified).toLocaleTimeString()}`,\n                speed: devices.location.speed || 0.00,\n                vehicleID: devices.vehicleID,\n                location: devices.location.label,\n                deviceId: devices.deviceSerialNo.split('#')[1]\n              }\n            });\n          }\n        } else {// Do nothing\n        }\n      });\n    })();\n  }\n\n  openInfoWindow(marker, data, infoType) {\n    let content;\n\n    switch (infoType) {\n      case 'driver':\n        this.infoDetail = this.prepareDriverInfoTemplate(data);\n        break;\n\n      case 'asset':\n        this.infoDetail = this.prepareAssetInfoTemplate(data);\n        break;\n\n      case 'vehicle':\n        this.infoDetail = this.prepareVehicleInfoTemplate(data);\n        break;\n\n      default:\n        throw new Error('Unable to get Marker type info');\n    }\n\n    this.infoWindow.open(marker);\n  }\n\n  prepareDriverInfoTemplate(data) {\n    return `<a href='#/fleet/drivers/detail/${data.driverId}' target=_blank'><h4> Driver: ${data.userId}</h4></a> \n    Speed: ${data.speed} KM/H | Altitude: ${data.altitude} <br/> <br/>\n    Time : ${data.time} <br/><br/>\n    `;\n  }\n\n  prepareAssetInfoTemplate(data) {\n    // console.log('data', data);\n    return `<b> Asset: ${data.assetIdentification}</b><br/>\n    Speed: ${data.speed} | Altitude: ${data.altitude} <br/>\n    Time : ${data.time}<br/> \n    Temp. : ${data.temp} | Battery : ${data.battery}\n    <br/>\n    <a class='link' target='_blank' href = '#/fleet/tracking/asset-tracker/${data.assetIdentification}?assetId=${data.assetID}' style='color:blue;font-size:9px'>Asset Report</a> | \n    <a href='#/fleet/assets/detail/${data.assetID}' target=_blank'>Asset Details</a>\n     `;\n  }\n\n  prepareVehicleInfoTemplate(data) {\n    return `<b>Vehicle: ${data.vehicleIdentification}</b></b><br/>\n   <span> Speed: ${parseFloat(data.speed).toFixed(2)} KM/H</span><br/>   \n      <a class='link' target='_blank' href = '#/fleet/tracking/vehicle-dash-cam-tracker/${data.deviceId}?vehicleId=${data.vehicleID}' style='color:blue;font-size:9px'>Realtime view</a> | \n      <a class='link' target='_blank' href ='#/fleet/vehicles/detail/${data.vehicleID}' style='color:blue;font-size:9px'>Vehicle details</a>\n        `;\n  }\n\n  valuechange() {\n    this.visible = !this.visible;\n  }\n\n  ngAfterViewInit() {}\n\n  refresh() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this5.getCurrentAssetLocation();\n      yield _this5.getVehicleLocationByDashCam();\n    })();\n  }\n\n}\n\nMapDashboardComponent.ɵfac = function MapDashboardComponent_Factory(t) {\n  return new (t || MapDashboardComponent)(i0.ɵɵdirectiveInject(i1.ApiService));\n};\n\nMapDashboardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MapDashboardComponent,\n  selectors: [[\"app-map-dashboard\"]],\n  viewQuery: function MapDashboardComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(MapInfoWindow, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.infoWindow = _t.first);\n    }\n  },\n  decls: 65,\n  vars: 14,\n  consts: [[1, \"body\"], [1, \"inner-wrapper\"], [\"role\", \"main\", 1, \"content-body\"], [1, \"page-header\", \"flex\", \"align-items-center\", \"justify-content-start\"], [1, \"row\"], [1, \"col\", \"header-title\"], [1, \"col\", \"header-buttons\"], [\"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", \"class\", \"p-button-text\", 4, \"ngIf\"], [\"id\", \"btnResetFilter\", \"type\", \"button\", \"pButton\", \"\", \"tooltipPosition\", \"left\", \"icon\", \"pi pi-refresh\", \"pTooltip\", \"Refresh\", 1, \"pull-right\", 3, \"click\"], [2, \"height\", \"calc(100vh - 110px)\", \"width\", \"100%\"], [3, \"options\", \"width\", \"height\"], [3, \"position\", \"options\", \"mapClick\", 4, \"ngFor\", \"ngForOf\"], [1, \"marker-info\", 3, \"innerHTML\"], [1, \"mapclass\", \"drivermain\"], [\"id\", \"map_collapse_sidebar\", 4, \"ngIf\"], [\"id\", \"vehicleLoc1\", 1, \"vehicle_moving\", \"vehicle-item\"], [\"href\", \"#\"], [1, \"fas\", \"fa-location-arrow\"], [1, \"vehicle-description\"], [1, \"fas\", \"fa-user\"], [1, \"fas\", \"fa-calendar-day\"], [1, \"fas\", \"fa-map-marker-alt\"], [\"id\", \"vehicleLoc2\", 1, \"vehicle_moving\"], [\"id\", \"vehicleLoc3\", 1, \"vehicle_moving\"], [\"id\", \"vehicleLoc4\", 1, \"vehicle_moving\"], [\"id\", \"vehicleLoc5\", 1, \"vehicle_moving\"], [\"id\", \"vehicleStopLoc1\", 1, \"vehicle_stop\"], [\"id\", \"vehicleStopLoc2\", 1, \"vehicle_stop\"], [\"id\", \"vehicleStopLoc3\", 1, \"vehicle_stop\"], [\"id\", \"vehicleIdleLoc1\", 1, \"vehicle_idle\"], [\"id\", \"vehicleIdleLoc2\", 1, \"vehicle_idle\"], [\"id\", \"vehicleIdleLoc3\", 1, \"vehicle_idle\"], [\"id\", \"vehicleIdleLoc4\", 1, \"vehicle_idle\"], [\"class\", \"iconR\", \"id\", \"arrowR\", 4, \"ngIf\"], [\"class\", \"iconL\", \"id\", \"arrowL\", 4, \"ngIf\"], [\"method\", \"\"], [\"class\", \"drivelist\", \"style\", \"overflow: hidden scroll; height: 100%; display: block\", \"id\", \"driverList\", 4, \"ngIf\"], [\"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", 1, \"p-button-text\"], [3, \"position\", \"options\", \"mapClick\"], [\"marker\", \"mapMarker\"], [\"id\", \"map_collapse_sidebar\"], [1, \"card\"], [1, \"card-header\", 2, \"border-radius\", \"none\"], [1, \"card-actions\"], [\"href\", \"javascript:;\", \"data-card-toggle\", \"\", 1, \"card-action\", \"card-action-toggle\"], [1, \"card-title\", 2, \"width\", \"230px\"], [1, \"fas\", \"fa-sitemap\"], [1, \"mt-3\"], [\"data-plugin-selectTwo\", \"\", 1, \"form-control\", \"populate\"], [\"label\", \"Select Truck\"], [\"value\", \"1\"], [\"value\", \"2\"], [1, \"card-body\", 2, \"display\", \"block\"], [\"id\", \"treeCheckbox\"], [\"data-jstree\", \"{\\\" opened\\\" : true }\"], [\"data-jstree\", \"{\\\" opened\\\" : false }\"], [\"data-jstree\", \"{\\\" icon\\\" :\\\" fas fa-user\\\"\\n                                          }\"], [\"data-jstree\", \"\"], [\"id\", \"arrowR\", 1, \"iconR\"], [3, \"routerLink\", \"click\"], [1, \"fas\", \"fa-arrow-right\"], [\"id\", \"arrowL\", 1, \"iconL\"], [1, \"fas\", \"fa-arrow-left\"], [\"id\", \"driverList\", 1, \"drivelist\", 2, \"overflow\", \"hidden scroll\", \"height\", \"100%\", \"display\", \"block\"], [\"class\", \"notrip-oview align-items-center\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"notrip-oview\", \"align-items-center\"], [\"src\", \"assets/img/notrip.png\"], [1, \"d-flex\", \"align-items-center\", \"justify-content-center\"], [1, \"font-weight-bold\"], [\"class\", \"driverdetail\", 4, \"ngFor\", \"ngForOf\"], [1, \"driverdetail\"], [1, \"driverleftmain\"], [1, \"col-lg-12\"], [1, \"mb-1\", \"font-weight-semibold\", \"text-dark\"], [\"href\", \"javascript:;\", 1, \"text-5\", \"text-capitalize\"], [\"href\", \"javascript:;\", \"class\", \"text-5 text-capitalize\", 4, \"ngIf\"], [1, \"col-lg-4\", \"pl-0\", \"text-right\"], [1, \"col-lg-6\"], [1, \"mb-1\", \"text-3\", \"font-weight-semibold\", \"text-dark\"], [1, \"col-lg-6\", \"text-right\"], [4, \"ngFor\", \"ngForOf\"], [1, \"mb-1\", \"text-4\", \"font-weight-semibold\", \"text-dark\"], [1, \"badge\", \"badge-dark\", \"p-1\"], [\"href\", \"javascript:;\", 1, \"pull-right\", \"mx-1\"], [1, \"pull-right\", \"LTLload\"]],\n  template: function MapDashboardComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"section\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"section\", 2);\n      i0.ɵɵelementStart(3, \"header\", 3);\n      i0.ɵɵelementStart(4, \"div\", 4);\n      i0.ɵɵelementStart(5, \"div\", 5);\n      i0.ɵɵtext(6, \" Entire Fleet \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"div\", 6);\n      i0.ɵɵtemplate(8, MapDashboardComponent_button_8_Template, 2, 1, \"button\", 7);\n      i0.ɵɵtemplate(9, MapDashboardComponent_button_9_Template, 2, 1, \"button\", 7);\n      i0.ɵɵtemplate(10, MapDashboardComponent_button_10_Template, 2, 1, \"button\", 7);\n      i0.ɵɵelementStart(11, \"button\", 8);\n      i0.ɵɵlistener(\"click\", function MapDashboardComponent_Template_button_click_11_listener() {\n        return ctx.refresh();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"div\", 9);\n      i0.ɵɵelementStart(13, \"google-map\", 10);\n      i0.ɵɵtemplate(14, MapDashboardComponent_map_marker_14_Template, 2, 2, \"map-marker\", 11);\n      i0.ɵɵelement(15, \"map-info-window\", 12);\n      i0.ɵɵtemplate(16, MapDashboardComponent_map_marker_16_Template, 2, 2, \"map-marker\", 11);\n      i0.ɵɵtemplate(17, MapDashboardComponent_map_marker_17_Template, 2, 2, \"map-marker\", 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"div\", 13);\n      i0.ɵɵtemplate(19, MapDashboardComponent_div_19_Template, 78, 0, \"div\", 14);\n      i0.ɵɵelementStart(20, \"div\", 15);\n      i0.ɵɵelementStart(21, \"a\", 16);\n      i0.ɵɵelement(22, \"i\", 17);\n      i0.ɵɵelementStart(23, \"p\", 18);\n      i0.ɵɵelement(24, \"i\", 19);\n      i0.ɵɵtext(25, \" Manjit Singh\");\n      i0.ɵɵelement(26, \"br\");\n      i0.ɵɵelement(27, \"i\", 20);\n      i0.ɵɵtext(28, \" Cycle: 10 D\");\n      i0.ɵɵelement(29, \"br\");\n      i0.ɵɵelement(30, \"i\", 21);\n      i0.ɵɵtext(31, \" Location: Kingston, Toronto\");\n      i0.ɵɵelement(32, \"br\");\n      i0.ɵɵelementStart(33, \"strong\");\n      i0.ɵɵtext(34, \"HOS Summary\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(35, \"br\");\n      i0.ɵɵtext(36, \" Break: 10 h, Hours: 5 h\");\n      i0.ɵɵelement(37, \"br\");\n      i0.ɵɵtext(38, \" Shift: 2nd, Cycle Reset: 4:25 h \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(39, \"div\", 22);\n      i0.ɵɵelement(40, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(41, \"div\", 23);\n      i0.ɵɵelement(42, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(43, \"div\", 24);\n      i0.ɵɵelement(44, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(45, \"div\", 25);\n      i0.ɵɵelement(46, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(47, \"div\", 26);\n      i0.ɵɵelement(48, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(49, \"div\", 27);\n      i0.ɵɵelement(50, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(51, \"div\", 28);\n      i0.ɵɵelement(52, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(53, \"div\", 29);\n      i0.ɵɵelement(54, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(55, \"div\", 30);\n      i0.ɵɵelement(56, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(57, \"div\", 31);\n      i0.ɵɵelement(58, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(59, \"div\", 32);\n      i0.ɵɵelement(60, \"i\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(61, MapDashboardComponent_div_61_Template, 3, 0, \"div\", 33);\n      i0.ɵɵtemplate(62, MapDashboardComponent_div_62_Template, 3, 0, \"div\", 34);\n      i0.ɵɵelementStart(63, \"form\", 35);\n      i0.ɵɵtemplate(64, MapDashboardComponent_div_64_Template, 3, 3, \"div\", 36);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngIf\", ctx.driverPositions.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.assetPositions.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.vehicleDashPositions.length > 0);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"options\", ctx.mapOptions)(\"width\", ctx.width)(\"height\", ctx.height);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.driverPositions);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"innerHTML\", ctx.infoDetail, i0.ɵɵsanitizeHtml);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.assetPositions);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.vehicleDashPositions);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", !ctx.environment);\n      i0.ɵɵadvance(42);\n      i0.ɵɵproperty(\"ngIf\", ctx.visible);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.visible);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.visible);\n    }\n  },\n  directives: [i2.NgIf, i3.ButtonDirective, i4.GoogleMap, i2.NgForOf, i4.MapInfoWindow, i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.NgForm, i4.MapMarker, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i6.RouterLinkWithHref],\n  styles: [\".marker-info[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] {\\r\\n    font-size: 10px;\\r\\n    color: black;\\r\\n}\\r\\n\\r\\n.marker-info[_ngcontent-%COMP%]   link[_ngcontent-%COMP%] {\\r\\n    font-size: 11px;\\r\\n}\\r\\n\\r\\n.map-container[_ngcontent-%COMP%] {\\r\\n    width: 800px;\\r\\n    height: 600px;\\r\\n}\", \".vehicle_idle[_ngcontent-%COMP%], .vehicle_stop[_ngcontent-%COMP%], .vehicle_moving[_ngcontent-%COMP%] {\\n        display: none;\\n    }\"],\n  data: {\n    animation: [trigger(\"slideInOut\", [transition(\":enter\", [style({\n      transform: \"translateX(100%)\"\n    }), animate(\"400ms\", style({\n      transform: \"translateX(0%)\"\n    }))]), transition(\":leave\", [animate(\"400ms\", style({\n      transform: \"translateX(100%)\"\n    }))])])]\n  }\n});","map":null,"metadata":{},"sourceType":"module"}