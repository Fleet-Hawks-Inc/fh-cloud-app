{"ast":null,"code":"import _asyncToGenerator from \"C:/FH/fh-cloud-app/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport Constants from '../../constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../services/api.service\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"primeng/button\";\nimport * as i5 from \"primeng/tooltip\";\nimport * as i6 from \"ngx-infinite-scroll\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"@angular/common\";\n\nfunction DeviceListComponent_tr_50_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 33);\n    i0.ɵɵelementStart(1, \"td\", 34);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.dataMessage);\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    vehicleId: a0\n  };\n};\n\nfunction DeviceListComponent_tr_51_td_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵelementStart(1, \"a\", 47);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const device_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/fleet/tracking/vehicle-dash-cam-tracker/\", device_r3.deviceSerialNo.split(\"#\")[1], \"\");\n    i0.ɵɵproperty(\"queryParams\", i0.ɵɵpureFunction1(3, _c0, device_r3.vehicle.vehicleID));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", device_r3.vehicle.vehicleIdentification, \"\");\n  }\n}\n\nconst _c1 = function (a0) {\n  return {\n    assetId: a0\n  };\n};\n\nfunction DeviceListComponent_tr_51_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵelementStart(1, \"a\", 48);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const device_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/fleet/tracking/asset-tracker/\", device_r3.asset.assetIdentification, \"\");\n    i0.ɵɵproperty(\"queryParams\", i0.ɵɵpureFunction1(3, _c1, device_r3.asset.assetID));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", device_r3.asset.assetIdentification, \"\");\n  }\n}\n\nfunction DeviceListComponent_tr_51_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\", 35);\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 36);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 36);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, DeviceListComponent_tr_51_td_7_Template, 3, 5, \"td\", 37);\n    i0.ɵɵtemplate(8, DeviceListComponent_tr_51_ng_template_8_Template, 3, 5, \"ng-template\", null, 38, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵelementStart(11, \"span\", 39);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\", 40);\n    i0.ɵɵelementStart(14, \"div\", 41);\n    i0.ɵɵelementStart(15, \"button\", 42);\n    i0.ɵɵelement(16, \"i\", 43);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 44);\n    i0.ɵɵelementStart(18, \"a\", 45);\n    i0.ɵɵtext(19, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"a\", 46);\n    i0.ɵɵlistener(\"click\", function DeviceListComponent_tr_51_Template_a_click_20_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const device_r3 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.deactivateDevice(device_r3.deviceType, device_r3.deviceID, !device_r3.deviceStatus);\n    });\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const device_r3 = ctx.$implicit;\n\n    const _r5 = i0.ɵɵreference(9);\n\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", device_r3.deviceType, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/manage/devices/detail/\", device_r3.deviceSerialNo.replace(\"#\", \"/\"), \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", device_r3.deviceSerialNo.split(\"#\")[1], \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/manage/devices/detail/\", device_r3.deviceSerialNo.replace(\"#\", \"/\"), \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", device_r3.deviceName, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", device_r3.vehicle.vehicleIdentification)(\"ngIfElse\", _r5);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(device_r3.deviceStatus === true ? \"Active\" : \"Inactive\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/manage/devices/edit/\", device_r3.deviceSerialNo.replace(\"#\", \"/\"), \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(device_r3.deviceStatus === true ? \"Deactivate\" : \"Activate\");\n  }\n}\n\nfunction DeviceListComponent_div_52_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 49);\n    i0.ɵɵelementStart(1, \"button\", 50);\n    i0.ɵɵlistener(\"click\", function DeviceListComponent_div_52_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.onScroll();\n    });\n    i0.ɵɵtext(2, \" Load More.. \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport class DeviceListComponent {\n  constructor(apiService, toastr, router) {\n    this.apiService = apiService;\n    this.toastr = toastr;\n    this.router = router;\n    this.next = 'null';\n    this.dataMessage = Constants.FETCHING_DATA;\n    this.devices = [];\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.next = 'null';\n      _this.devices = [];\n      yield _this.fetchDevices();\n    })();\n  }\n\n  refreshData() {\n    this.next = 'null';\n    this.devices = [];\n    this.fetchDevices();\n  }\n\n  fetchDevices() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        if (_this2.next === 'end') {\n          return;\n        }\n\n        _this2.dataMessage = Constants.FETCHING_DATA;\n        const result = yield _this2.apiService.getData(`devices/getDevices/${_this2.next}`).toPromise();\n\n        if (result && result.data.length > 0) {\n          result.data.forEach(device => {\n            let deviceItem = {\n              deviceName: device.deviceName,\n              deviceStatus: device.deviceStatus,\n              deviceSerialNo: device.deviceSerialNo,\n              description: device.description,\n              deviceType: device.deviceType,\n              deviceID: device.deviceID,\n              vehicle: {\n                vehicleID: '',\n                vehicleIdentification: ''\n              },\n              asset: {\n                assetID: '',\n                assetIdentification: ''\n              }\n            };\n\n            if (device.vehicleIdentification) {\n              deviceItem.vehicle.vehicleID = device.vehicleID;\n              deviceItem.vehicle.vehicleIdentification = device.vehicleIdentification;\n            }\n\n            if (device.assetIdentification) {\n              deviceItem.asset.assetID = device.assetID;\n              deviceItem.asset.assetIdentification = device.assetIdentification;\n            }\n\n            _this2.devices.push(deviceItem);\n          });\n          _this2.next = result.nextPage || 'end';\n        } else {\n          _this2.next = 'end';\n          _this2.dataMessage = Constants.NO_RECORDS_FOUND;\n        }\n      } catch (error) {\n        _this2.dataMessage = Constants.NO_RECORDS_FOUND;\n        console.error(error);\n        throw new Error(error);\n      }\n    })();\n  }\n\n  deactivateDevice(devicesType, deviceID, activate) {\n    const confirmationText = activate == true ? 'activate' : 'deactivate';\n    const status = activate == true ? 'activated' : 'deactivated';\n\n    if (confirm(`Are you sure you want to ${confirmationText}?`) === true) {\n      try {\n        let body = {\n          deviceType: devicesType,\n          deviceID: deviceID,\n          activate: activate\n        };\n        this.apiService.putData(`devices/deactivate`, body).subscribe(result => {\n          if (result) {\n            this.devices = [];\n            this.next = 'null';\n            this.fetchDevices();\n            this.toastr.success(`Device ${status} Successfully`);\n          }\n        });\n      } catch (error) {\n        console.error(error);\n        throw new Error(error);\n      }\n    }\n  }\n\n  onScroll() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this3.fetchDevices();\n    })();\n  }\n\n  gotoAssetTracker(device) {\n    this.router.navigate([`/fleet/tracking/asset-tracker/${device.asset.assetIdentification}`], {\n      queryParams: {\n        assetId: device.asset.assetID\n      }\n    });\n  }\n\n}\n\nDeviceListComponent.ɵfac = function DeviceListComponent_Factory(t) {\n  return new (t || DeviceListComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.ToastrService), i0.ɵɵdirectiveInject(i3.Router));\n};\n\nDeviceListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DeviceListComponent,\n  selectors: [[\"app-device-list\"]],\n  decls: 53,\n  vars: 5,\n  consts: [[1, \"body\"], [1, \"inner-wrapper\"], [\"role\", \"main\", 1, \"content-body\", \"pl-0\", \"pt-0\", \"pr-0\"], [1, \"page-header\"], [1, \"row\"], [1, \"col\", \"header-title\"], [1, \"mt-0\", \"mb-0\"], [1, \"col\", \"header-buttons\"], [\"id\", \"btnLiveVideo\", \"type\", \"button\", \"pButton\", \"\", \"tooltipPosition\", \"left\", \"icon\", \"pi pi-refresh\", \"pTooltip\", \"Refresh\", 1, \"mr-1\", 3, \"click\"], [\"id\", \"btnLiveVideo\", \"type\", \"button\", \"pButton\", \"\", \"tooltipPosition\", \"left\", \"icon\", \"pi pi-plus\", \"routerLink\", \"/manage/devices/add\", \"pTooltip\", \"Add Device\", 1, \"mr-1\", 3, \"click\"], [1, \"m-2\"], [1, \"row\", \"mb-3\"], [1, \"col-lg-12\"], [\"infiniteScroll\", \"\", 3, \"infiniteScrollDistance\", \"infiniteScrollUpDistance\", \"scrolled\"], [1, \"bg-white\", \"p-3\", \"text-dark\"], [\"id\", \"simple-table_wrapper\", 1, \"dataTables_wrapper\", \"dt-bootstrap4\", \"no-footer\"], [1, \"col-lg-6\"], [\"id\", \"simple-table_length\", 1, \"dataTables_length\"], [\"name\", \"simple-table_length\", \"aria-controls\", \"simple-table\", 1, \"custom-select\", \"custom-select-sm\", \"form-control\", \"form-control-sm\"], [\"value\", \"10\"], [\"value\", \"25\"], [\"value\", \"50\"], [\"value\", \"100\"], [1, \"table-responsive\"], [\"id\", \"simple-table\", \"role\", \"grid\", 1, \"row-border\", \"hover\", \"table\", \"table-bordered\", \"table-striped\", \"mb-0\"], [\"width\", \"10%\", 1, \"col3\", 2, \"width\", \"135px\"], [\"width\", \"25%\", 1, \"col2\", 2, \"width\", \"371px\"], [\"width\", \"15%\", 1, \"col4\", 2, \"width\", \"213px\"], [\"width\", \"10%\", 1, \"col1\", 2, \"width\", \"136px\"], [\"id\", \"\", 1, \"minWidth50\", 2, \"width\", \"20px\"], [\"class\", \"text-center\", 4, \"ngIf\"], [\"role\", \"row\", \"class\", \"odd\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"col-lg-12 mt-3 text-center\", 4, \"ngIf\"], [1, \"text-center\"], [\"colspan\", \"15\"], [\"role\", \"row\", 1, \"odd\"], [3, \"routerLink\"], [4, \"ngIf\", \"ngIfElse\"], [\"elseBlock\", \"\"], [1, \"badge\", \"badge-success\", \"text-3\"], [1, \"border-0\"], [1, \"dropdown\", \"dropright\"], [\"type\", \"button\", \"data-toggle\", \"dropdown\", \"aria-haspopup\", \"true\", \"aria-expanded\", \"false\", 1, \"bg-transparent\", \"border-0\"], [1, \"fas\", \"fa-ellipsis-v\"], [1, \"dropdown-menu\"], [1, \"dropdown-item\", 3, \"routerLink\"], [\"href\", \"javascript:;\", 1, \"dropdown-item\", 3, \"click\"], [\"target\", \"_blank\", 2, \"color\", \"blue\", \"text-decoration\", \"none\", 3, \"routerLink\", \"queryParams\"], [\"target\", \"_blank\", \"queryParamsHandling\", \"merge\", 2, \"color\", \"blue\", \"text-decoration\", \"none\", 3, \"routerLink\", \"queryParams\"], [1, \"col-lg-12\", \"mt-3\", \"text-center\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", \"btn-sm\", \"text-light\", 3, \"click\"]],\n  template: function DeviceListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"section\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"section\", 2);\n      i0.ɵɵelementStart(3, \"header\", 3);\n      i0.ɵɵelementStart(4, \"div\", 4);\n      i0.ɵɵelementStart(5, \"div\", 5);\n      i0.ɵɵelementStart(6, \"label\", 6);\n      i0.ɵɵtext(7, \" Devices\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"div\", 7);\n      i0.ɵɵelementStart(9, \"button\", 8);\n      i0.ɵɵlistener(\"click\", function DeviceListComponent_Template_button_click_9_listener() {\n        return ctx.refreshData();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"button\", 9);\n      i0.ɵɵlistener(\"click\", function DeviceListComponent_Template_button_click_10_listener() {\n        return ctx.refreshData();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"section\", 10);\n      i0.ɵɵelementStart(12, \"div\", 11);\n      i0.ɵɵelementStart(13, \"div\", 12);\n      i0.ɵɵelementStart(14, \"div\", 13);\n      i0.ɵɵlistener(\"scrolled\", function DeviceListComponent_Template_div_scrolled_14_listener() {\n        return ctx.onScroll();\n      });\n      i0.ɵɵelementStart(15, \"div\", 14);\n      i0.ɵɵelementStart(16, \"div\", 15);\n      i0.ɵɵelementStart(17, \"div\", 4);\n      i0.ɵɵelementStart(18, \"div\", 16);\n      i0.ɵɵelementStart(19, \"div\", 17);\n      i0.ɵɵelementStart(20, \"label\");\n      i0.ɵɵtext(21, \"Show \");\n      i0.ɵɵelementStart(22, \"select\", 18);\n      i0.ɵɵelementStart(23, \"option\", 19);\n      i0.ɵɵtext(24, \"10\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(25, \"option\", 20);\n      i0.ɵɵtext(26, \"25\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(27, \"option\", 21);\n      i0.ɵɵtext(28, \"50\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(29, \"option\", 22);\n      i0.ɵɵtext(30, \"100\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(31, \" entries\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(32, \"div\", 16);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(33, \"div\", 23);\n      i0.ɵɵelementStart(34, \"table\", 24);\n      i0.ɵɵelementStart(35, \"thead\");\n      i0.ɵɵelementStart(36, \"tr\");\n      i0.ɵɵelementStart(37, \"th\", 25);\n      i0.ɵɵtext(38, \" Type \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(39, \"th\", 25);\n      i0.ɵɵtext(40, \" Serial/IMEI \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(41, \"th\", 26);\n      i0.ɵɵtext(42, \" Device Name \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(43, \"th\", 27);\n      i0.ɵɵtext(44, \" Vehicle/Asset \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(45, \"th\", 28);\n      i0.ɵɵtext(46, \" Status \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(47, \"th\", 29);\n      i0.ɵɵtext(48, \" Actions \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(49, \"tbody\");\n      i0.ɵɵtemplate(50, DeviceListComponent_tr_50_Template, 3, 1, \"tr\", 30);\n      i0.ɵɵtemplate(51, DeviceListComponent_tr_51_Template, 22, 10, \"tr\", 31);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(52, DeviceListComponent_div_52_Template, 3, 0, \"div\", 32);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"infiniteScrollDistance\", 1)(\"infiniteScrollUpDistance\", 2);\n      i0.ɵɵadvance(36);\n      i0.ɵɵproperty(\"ngIf\", ctx.devices.length == 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.devices);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.devices.length !== 0 && ctx.next != \"end\");\n    }\n  },\n  directives: [i4.ButtonDirective, i5.Tooltip, i3.RouterLink, i6.InfiniteScrollDirective, i7.NgSelectOption, i7.ɵNgSelectMultipleOption, i8.NgIf, i8.NgForOf, i3.RouterLinkWithHref],\n  styles: [\"\"]\n});","map":null,"metadata":{},"sourceType":"module"}