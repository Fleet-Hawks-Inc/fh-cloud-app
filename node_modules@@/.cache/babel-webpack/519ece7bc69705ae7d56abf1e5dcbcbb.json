{"ast":null,"code":"import _asyncToGenerator from \"C:/FH/fh-cloud-app/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"!C:\\\\FH\\\\fh-cloud-app\\\\node_modules\\\\@ngtools\\\\webpack\\\\src\\\\loaders\\\\direct-resource.js!./journal-list.component.html\";\nimport __NG_CLI_RESOURCE__1 from \"./journal-list.component.css\";\nimport { Component } from '@angular/core';\nimport { AccountService } from '../../../../services';\nimport { ToastrService } from 'ngx-toastr';\nimport Constants from '../../../fleet/constants';\nlet JournalListComponent = class JournalListComponent {\n  constructor(toaster, accountService) {\n    this.toaster = toaster;\n    this.accountService = accountService;\n    this.dataMessage = Constants.FETCHING_DATA;\n    this.journals = [];\n    this.dateMinLimit = {\n      year: 1950,\n      month: 1,\n      day: 1\n    };\n    this.date = new Date();\n    this.futureDatesLimit = {\n      year: this.date.getFullYear() + 30,\n      month: 12,\n      day: 31\n    };\n    this.filter = {\n      jrNo: null,\n      startDate: null,\n      endDate: null\n    };\n    this.lastItemSK = '';\n    this.loaded = false;\n    this.disableSearch = false;\n  }\n\n  ngOnInit() {\n    this.fetchJournals();\n  }\n\n  fetchJournals(refresh) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let searchParam = null;\n\n      if (refresh === true) {\n        _this.lastItemSK = '';\n        _this.journals = [];\n      }\n\n      if (_this.lastItemSK !== 'end') {\n        if (_this.filter.jrNo !== null && _this.filter.jrNo !== '') {\n          searchParam = encodeURIComponent(`\"${_this.filter.jrNo}\"`);\n        } else {\n          searchParam = null;\n        }\n\n        _this.accountService.getData(`journal/paging?jrNo=${searchParam}&startDate=${_this.filter.startDate}&endDate=${_this.filter.endDate}&lastKey=${_this.lastItemSK}`).subscribe( /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (result) {\n            if (result.length === 0) {\n              _this.disableSearch = false;\n              _this.dataMessage = Constants.NO_RECORDS_FOUND;\n            }\n\n            if (result.length > 0) {\n              _this.disableSearch = false;\n\n              if (result[result.length - 1].sk !== undefined) {\n                _this.lastItemSK = encodeURIComponent(result[result.length - 1].sk);\n              } else {\n                _this.lastItemSK = 'end';\n              }\n\n              result.map(v => {\n                _this.journals.push(v);\n              });\n              _this.loaded = true;\n            }\n          });\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      }\n    })();\n  }\n\n  deleteJournal(journalID) {\n    if (confirm('Are you sure you want to delete?') === true) {\n      this.accountService.deleteData(`journal/delete/${journalID}`).subscribe(result => {\n        if (result !== undefined) {\n          this.dataMessage = Constants.FETCHING_DATA;\n          this.lastItemSK = '';\n          this.journals = [];\n          this.fetchJournals();\n          this.toaster.success('Manual journal deleted successfully.');\n        }\n      });\n    }\n  }\n\n  searchFilter() {\n    if (this.filter.jrNo !== null || this.filter.endDate !== null || this.filter.startDate !== null) {\n      this.disableSearch = true;\n\n      if (this.filter.startDate !== '' && this.filter.endDate === '') {\n        this.toaster.error('Please select both start and end dates.');\n        return false;\n      } else if (this.filter.startDate === '' && this.filter.endDate !== '') {\n        this.toaster.error('Please select both start and end dates.');\n        return false;\n      } else if (this.filter.startDate > this.filter.endDate) {\n        this.toaster.error('Start date should be less then end date');\n        return false;\n      } else {\n        this.dataMessage = Constants.FETCHING_DATA;\n        this.lastItemSK = '';\n        this.journals = [];\n        this.fetchJournals();\n      }\n    }\n  }\n\n  resetFilter() {\n    this.disableSearch = true;\n    this.dataMessage = Constants.FETCHING_DATA;\n    this.filter = {\n      jrNo: null,\n      startDate: null,\n      endDate: null\n    };\n    this.lastItemSK = '';\n    this.journals = [];\n    this.fetchJournals();\n  }\n\n  onScroll() {\n    if (this.loaded) {\n      this.fetchJournals();\n    }\n\n    this.loaded = false;\n  }\n\n  refreshData() {\n    this.disableSearch = true;\n    this.dataMessage = Constants.FETCHING_DATA;\n    this.filter = {\n      jrNo: null,\n      startDate: null,\n      endDate: null\n    };\n    this.lastItemSK = '';\n    this.journals = [];\n    this.fetchJournals();\n  }\n\n};\n\nJournalListComponent.ctorParameters = () => [{\n  type: ToastrService\n}, {\n  type: AccountService\n}];\n\nJournalListComponent = __decorate([Component({\n  selector: 'app-journal-list',\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], JournalListComponent);\nexport { JournalListComponent };","map":null,"metadata":{},"sourceType":"module"}