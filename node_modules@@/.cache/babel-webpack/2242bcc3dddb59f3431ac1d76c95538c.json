{"ast":null,"code":"import _asyncToGenerator from \"C:/FH/fh-cloud-app/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"!C:\\\\FH\\\\fh-cloud-app\\\\node_modules\\\\@ngtools\\\\webpack\\\\src\\\\loaders\\\\direct-resource.js!./vendor-payments-list.component.html\";\nimport __NG_CLI_RESOURCE__1 from \"./vendor-payments-list.component.css\";\nimport { Component } from \"@angular/core\";\nimport Constants from \"src/app/pages/fleet/constants\";\nimport { AccountService } from \"src/app/services/account.service\";\nimport { ApiService } from \"src/app/services/api.service\";\nlet VendorPaymentsListComponent = class VendorPaymentsListComponent {\n  constructor(apiService, accountService) {\n    this.apiService = apiService;\n    this.accountService = accountService;\n    this.dataMessage = Constants.FETCHING_DATA;\n    this.dateMinLimit = {\n      year: 1950,\n      month: 1,\n      day: 1\n    };\n    this.date = new Date();\n    this.futureDatesLimit = {\n      year: this.date.getFullYear() + 30,\n      month: 12,\n      day: 31\n    };\n    this.filter = {\n      amount: null,\n      startDate: null,\n      endDate: null\n    };\n    this.disableSearch = true;\n    this.lastItemSK = \"\";\n    this.loaded = false;\n    this.payments = [];\n    this.vendors = [];\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.fetchVendor();\n\n      _this.fetchPayments();\n    })();\n  }\n\n  fetchPayments() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this2.lastItemSK !== \"end\") {\n        _this2.disableSearch = false;\n        let filterAmount = null;\n\n        if (_this2.filter.amount) {\n          filterAmount = encodeURIComponent(`\"${_this2.filter.amount}\"`);\n        }\n\n        let result = yield _this2.accountService.getData(`purchase-payments/paging?amount=${filterAmount}&start=${_this2.filter.startDate}&end=${_this2.filter.endDate}&lastKey=${_this2.lastItemSK}`).toPromise(); // this.payments = result;\n\n        if (result.length === 0) {\n          _this2.dataMessage = Constants.NO_RECORDS_FOUND;\n        }\n\n        _this2.lastItemSK = \"end\";\n\n        if (result.length > 0 && result[result.length - 1].sk !== undefined) {\n          _this2.lastItemSK = encodeURIComponent(result[result.length - 1].sk);\n        } else {\n          _this2.lastItemSK = \"end\";\n        }\n\n        result.map(v => {\n          v.payMode = v.payMode.replace(\"_\", \" \");\n          v.url = `/accounts/purchases/vendor-payments/detail/${v.paymentID}`;\n\n          _this2.payments.push(v);\n        });\n      }\n    })();\n  }\n\n  fetchVendor() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      let result = yield _this3.apiService.getData(`contacts/get/list/vendor`).toPromise();\n      _this3.vendors = result;\n    })();\n  }\n\n  searchFilter() {\n    if (this.filter.amount !== null || this.filter.startDate !== null || this.filter.endDate !== null) {\n      this.payments = [];\n      this.disableSearch = true;\n      this.lastItemSK = \"\";\n      this.dataMessage = Constants.FETCHING_DATA;\n      this.fetchPayments();\n    }\n  }\n\n  resetFilter() {\n    this.filter = {\n      amount: null,\n      startDate: null,\n      endDate: null\n    };\n    this.payments = [];\n    this.disableSearch = true;\n    this.lastItemSK = \"\";\n    this.dataMessage = Constants.FETCHING_DATA;\n    this.fetchPayments();\n  }\n\n  onScroll() {\n    if (this.loaded) {\n      this.fetchPayments();\n    }\n\n    this.loaded = false;\n  }\n\n};\n\nVendorPaymentsListComponent.ctorParameters = () => [{\n  type: ApiService\n}, {\n  type: AccountService\n}];\n\nVendorPaymentsListComponent = __decorate([Component({\n  selector: \"app-vendor-payments-list\",\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], VendorPaymentsListComponent);\nexport { VendorPaymentsListComponent };","map":null,"metadata":{},"sourceType":"module"}