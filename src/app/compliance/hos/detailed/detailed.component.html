<section class="body">
  <!-- start: header -->
  <app-header></app-header>
  <!-- end: header -->

  <div class="inner-wrapper">
    <!-- start: sidebar -->
    <app-sidebar></app-sidebar>
    <!-- end: sidebar -->

    <section role="main" class="content-body">
      <header class="page-header">
        <h2>{{ title }}</h2>

        <div class="right-wrapper text-right">
          <ol class="breadcrumbs pr-3">
            <li>
              <a routerLink="">
                <i class="fas fa-home"></i>
              </a>
            </li>
            <li>
              <span>{{ title }}</span>
            </li>
          </ol>
        </div>
      </header>

      <section class="card mb-4">
        <div class="card-body">
          <h2 class="card-title mt-2 mb-3">Driver Logs</h2>
          <form class="form-horizontal form-bordered" method="get">
            <div class="form-group row">
              <div class="col-lg-3">
                <div class="input-group mb-1">
                  <span class="input-group-prepend positionsta">
                    <span class="input-group-text"
                      ><i class="fas fa-search"></i
                    ></span>
                  </span>
                  <select
                    data-plugin-selectTwo
                    class="form-control populate"
                    [(ngModel)]="userName"
                    name="userName"
                  >
                    <optgroup label="">
                      <option>All</option>
                      <option
                        *ngFor="let driver of drivers"
                        value="{{ driver.userName }}"
                        >{{ driver.userName }}</option
                      >
                    </optgroup>
                  </select>
                </div>
              </div>

              <div class="col-lg-3">
                <div class="input-group mb-1">
                  <span class="input-group-prepend positionsta">
                    <span class="input-group-text"
                      ><i class="fas fa-search"></i
                    ></span>
                  </span>
                  <select
                    data-plugin-selectTwo
                    class="form-control populate"
                    name="violation"
                  >
                    <optgroup label="">
                      <option>Violation</option>
                      <option>Non Violation</option>
                    </optgroup>
                  </select>
                </div>
              </div>

              <div class="col-lg-3">
                <div class="input-group mb-1">
                  <span class="input-group-prepend positionsta">
                    <span class="input-group-text" (click)="from.toggle()"
                      ><i class="fas fa-calendar-alt"></i
                    ></span>
                  </span>
                  <input
                    readonly
                    ngbDatepicker #from="ngbDatepicker"
                    type="date"
                    class="form-control"
                    placeholder="From Date"
                    [(ngModel)]="fromDate"
                    name="fromDate"
                  />
                </div>
              </div>
              <div class="col-lg-3">
                <div class="input-group mb-1">
                  <span class="input-group-prepend positionsta">
                    <span class="input-group-text"
                          (click)="to.toggle()"
                      ><i class="fas fa-calendar-alt"></i
                    ></span>
                  </span>
                  <input
                    readonly
                    type="date"
                    class="form-control"
                    placeholder="To Date"
                    [(ngModel)]="toDate"
                    name="toDate"
                    ngbDatepicker #to="ngbDatepicker"
                  />
                </div>
              </div>
            </div>
            <div class="form-group row">
              <div class="col-lg-12">
                <button
                  class="btn btn-dark mar-top-asg-stock-btn pull-right"
                  (click)="getFilteredLogs()"
                >
                  Find
                </button>
              </div>
            </div>
          </form>
        </div>
      </section>

      <div class="row">
        <div class="col">
          <section class="card">
            <div class="card-body">
              <div class="row">
                <div class="col-lg-12">
                  <p class="hoshvalue">
                    <span
                      class="hosvalue text-4 font-weight-bold text-dark pl-2"
                      >Driver</span
                    >
                    <span
                      class="hosvalue text-4 font-weight-bold text-dark pl-2"
                      >Date</span
                    >
                    <span
                      class="hosvalue text-4 font-weight-bold text-dark text-center"
                      >On Duty Hours</span
                    >
                    <span
                      class="hosvalue text-4 font-weight-bold text-dark text-center"
                      >Drive Hours</span
                    >
                    <span
                      class="hosvalue text-4 font-weight-bold text-dark text-center"
                      >Break Hours</span
                    >
                    <span
                      class="hosvalue text-4 font-weight-bold text-dark text-center"
                      >Violation</span
                    >

                    <span
                      class="hosvalue text-4 font-weight-bold text-dark text-center"
                      >Action</span
                    >
                    <span
                      class="hosvalue text-4 font-weight-bold text-dark text-center"
                      >&nbsp;</span
                    >
                  </p>
                </div>

                <div class="col-lg-12">
                  <div class="">
                    <ng-container *ngFor="let log of logs; let i = index ">
                      <section class="toggle mt-0" (click)="getData(log.date)">
                        <label>
                          <span class="hosvalue text-dark">{{ log.driver }}</span>
                          <span class="hosvalue text-dark">{{ log.date }}</span>
                          <span class="hosvalue text-dark text-center">{{
                            log.onDuty * 1000 | date: "H:mm:ss":"UTC"
                          }}</span>
                          <span class="hosvalue text-dark text-center">{{
                            log.onDrive * 1000 | date: "H:mm:ss":"UTC"
                          }}</span>
                          <span class="hosvalue text-dark text-center">{{
                            log.onBreak * 1000 | date: "H:mm:ss":"UTC"
                          }}</span>

                          <span class="hosvalue text-dark text-center"
                            >Violation</span
                          >
                          <span class="hosvalue text-4 font-weight-bold text-dark text-center">
                            <a class="btn btn-dark btn-sm mt-0 modal-confirm"
                              routerLink="/compliance/hos/edit/{{log.driver}}/{{ log.date }}"
                              >Edit</a
                            >
                          </span>
                        </label>
                        <div class="toggle-content" id="{{ log.date }}" style="display: none;">
                          <table class="table table-responsive-md mb-0">
                            <tbody>
                              <thead>
                                <tr>
                                  <th class="line-height-lg">Trip Info</th>
                                  <th class="line-height-lg text-right">
                                    Date of Trip
                                  </th>
                                </tr>
                              </thead>

                              <tr>
                                <td class="line-height-lg">Carrier Name</td>
                                <td class="line-height-lg text-right">ABC</td>
                              </tr>
                              <tr>
                                <td class="line-height-lg">Carrier Address</td>
                                <td class="line-height-lg text-right">
                                  Dummy address toronto, Canada
                                </td>
                              </tr>
                            </tbody>
                          </table>

                          <div class="row pl-3 pr-3 mt-4">
                            <table
                              class="table table-responsive-md mb-0 col-md-6"
                            >
                              <tbody>
                                <thead>
                                  <tr>
                                    <th class="line-height-lg">Shipper Info</th>
                                    <th class="line-height-lg text-right">
                                      &nbsp;
                                    </th>
                                  </tr>
                                </thead>

                                <tr>
                                  <td class="line-height-lg">Shipper Name</td>
                                  <td class="line-height-lg text-right">ABC</td>
                                </tr>
                                <tr>
                                  <td class="line-height-lg">
                                    Shipper Address
                                  </td>
                                  <td class="line-height-lg text-right">
                                    Dummy address toronto, Canada
                                  </td>
                                </tr>
                              </tbody>
                            </table>

                            <table
                              class="table table-responsive-md mb-0 col-md-6"
                            >
                              <tbody>
                                <thead>
                                  <tr>
                                    <th class="line-height-lg">
                                      Reciever Info
                                    </th>
                                    <th class="line-height-lg text-right">
                                      &nbsp;
                                    </th>
                                  </tr>
                                </thead>

                                <tr>
                                  <td class="line-height-lg">Reciever Name</td>
                                  <td class="line-height-lg text-right">ABC</td>
                                </tr>
                                <tr>
                                  <td class="line-height-lg">
                                    Reciever Address
                                  </td>
                                  <td class="line-height-lg text-right">
                                    Dummy address toronto, Canada
                                  </td>
                                </tr>
                              </tbody>
                            </table>

                            <div class="col-md-12">
                              <label
                                class="control-label text-dark font-weight-bold text-4 text-lg-right pt-2"
                                for="textareaAutosize"
                                >Current Status</label
                              >
                              <textarea
                                class="form-control"
                                rows="3"
                                id="textareaAutosize"
                                data-plugin-textarea-autosize=""
                                style="
                                  overflow: hidden;
                                  overflow-wrap: break-word;
                                  resize: none;
                                  height: 89px;
                                "
                              ></textarea>
                            </div>

                            <div class="col-md-12 mt-4">
                              <h4 class="text-dark font-weight-bold">Logs</h4>
                              <div class="hosgmainbox2">
                                <div class="hosgrightbox2 text-left">
                                  <h5 class="font-weight-bold text-dark">
                                    {{ accumulatedOFF * 1000 | date: "H:mm:ss":"UTC" }}
                                  </h5>
                                  <h5 class="pt-5 font-weight-bold text-dark">
                                    {{accumulatedSB * 1000 | date: "H:mm:ss":"UTC"}}
                                  </h5>
                                  <h5 class="pt-5 font-weight-bold text-dark">
                                    {{accumulatedD * 1000 | date: "H:mm:ss":"UTC"}}
                                  </h5>
                                  <h5 class="pt-5 font-weight-bold text-dark">
                                    {{accumulatedON * 1000 | date: "H:mm:ss":"UTC"}}
                                  </h5>
                                </div>

                                <div class="hosgbox2">
                                  <svg style="height: 100%; width: 100%;">

                                    <ng-container *ngFor="let duty of duties; let i = index;">
<!-- When index is 0  and there is last event-->
<line *ngIf="i == 0 && lastEvent.HOSEventDescription != undefined" x1="0" attr.y1="{{ types[duty.type] }}" attr.x2="{{duty.time*coordinates}}" attr.y2="{{ types[duty.type] }}" style="stroke:rgb(0,0,0);stroke-width:2" />
<line *ngIf="i == 0 && duties[i+1] != undefined && lastEvent.HOSEventDescription != undefined" attr.x1="{{duty.time*coordinates}}" attr.y1="{{ types[duties[i+1].type] }}" attr.x2="{{duty.time*coordinates}}" attr.y2="{{ types[duty.type] }}" style="stroke:rgb(0,0,0);stroke-width:2" />

<!-- When index is 0 and there is no last event-->
<line *ngIf="i == 0 && lastEvent.HOSEventDescription === undefined" attr.x1="{{(duty.time)*coordinates}}" attr.y1="{{ types[duty.type] }}" attr.x2="{{duty.nextStart*coordinates}}" attr.y2="{{ types[duty.type] }}" style="stroke:rgb(0,0,0);stroke-width:2" />
<line *ngIf="i == 0 && duties[i+1] != undefined && lastEvent.HOSEventDescription === undefined" attr.x1="{{duty.nextStart*coordinates}}" attr.y1="{{ types[duties[i+1].type] }}" attr.x2="{{duty.nextStart*coordinates}}" attr.y2="{{ types[duty.type] }}" style="stroke:rgb(0,0,0);stroke-width:2" />


<!-- When index is not 0 -->
<line *ngIf="i != 0" attr.x1="{{ duties[i-1].nextStart*coordinates }}" attr.y1="{{ types[duty.type] }}" attr.x2="{{ (duties[i-1].nextStart + duty.time)*coordinates}}" attr.y2="{{ types[duty.type] }}" style="stroke:rgb(0,0,0);stroke-width:2" />
<line *ngIf="i != 0 && duties[i+1] != undefined" attr.x1="{{ (duties[i-1].nextStart + duty.time)*coordinates }}" attr.y1="{{ types[duties[i+1].type] }}" attr.x2="{{ (duties[i-1].nextStart + duty.time)*coordinates}}" attr.y2="{{ types[duty.type] }}" style="stroke:rgb(0,0,0);stroke-width:2" />


                                  </ng-container>

                                  </svg>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </section>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </section>
  </div>
</section>
