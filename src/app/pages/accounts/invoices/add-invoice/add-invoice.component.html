<section class="body">
  <div class="inner-wrapper">
    <section role="main" class="content-body pl-0 pr-0 pt-0">
      <header class="page-header">
        <div class="row pr-5 " style="padding-top:10px;">
          <div class="col-md-4 col-lg-4 font-weight-bold text-4 text-dark"> {{ pageTitle }}</div>
          <div class="col-md-8  col-lg-8 text-right pr-4"> <a routerLink="/accounts/invoices/list"
              class="btn btn-default"><i class="fas fa-list"></i> All Invoices</a> </div>
        </div>
      </header>
      <section class="card mt-0 mb-4">
        <div class="card-body">
          <div class="row">
            <div class="col pr-0">
              <div class="card-body text-dark">
                <form class="form-horizontal form-bordered" method="get">
                  <div class=" row">
                    <div class="col-lg-5 offset-lg-1">
                      <div class="row">
                        <div class="col-lg-5">
                          <label class="control-label font-weight-bold font-bold text-lg-right pt-2">Invoice#</label>
                          <input type="text" class="form-control" [(ngModel)]="invoiceData.invNo" name="invNo">
                        </div>
                        <div class="col-lg-5">
                          <label class="control-label font-weight-bold font-bold text-lg-right pt-2">Invoice
                            Date</label>
                          <input type="date" [(ngModel)]="invoiceData.invDate" name="invDate" class="form-control"
                            placeholder="mm/dd/yyyy">
                        </div>
                      </div>
                      <div class="row pt-2">
                        <div class="col-lg-10">
                          <label class="control-label font-weight-bold font-bold text-lg-right pt-2">Customer</label>
                          <ng-select [(ngModel)]="invoiceData.invCustomerID" name="invCustomerID"
                            (change)="selectedCustomer($event)" placeholder="Select Customer" class="form-control">
                            <ng-option *ngFor="let customer of customers | async" value="{{customer.contactID}}">
                              {{customer.companyName}}
                            </ng-option>
                          </ng-select>
                        </div>
                        <div class="col-lg-2  mar-top-37">
                          <!-- <a class="btn btn-success btn-sm text-light" data-dismiss="modal" data-toggle="modal" data-target="#addOrderCustomerModal"><i
                          class="fas fa-plus"></i>
                    </a> -->
                        </div>
                        <div class="col-11"  *ngIf="notOfficeAddress">
                          <div class="rounded p-2 mt-2" style="background-color:#e1e2e3;">
                             There is no office address of this customer
                          </div>
                       </div>

                       <div class="col-lg-11 mt-4" *ngIf="customerSelected.officeAddr">
                          <div class="" style="border: 0.4px solid #e1e2e3; border-radius: 0px 0px 15px 15px;">
                             <div class="row pl-3 pr-3">
                                <div class="col-lg-6" style="background-color:#e1e2e3;">
                                   <h5 class=" font-weight-bold">Details</h5>
                                </div>
                                <div class="col-lg-6 text-right" style="background-color:#e1e2e3;">
                                   <!-- <button type="button" class="btn btn-default btn-xs mt-2" data-toggle="modal" data-target="#addressModal"><i class="fas fa-pencil-alt"></i>Edit</button> -->
                                </div>
                             </div>
                             <div class="row pl-3 pr-3">
                                <div class="col-lg-12">

                                   <div class="" *ngFor="let address of customerSelected.address">
                                      <div class="row" *ngIf="address.addressType =='Office'">
                                         <div class="col-lg-6">
                                            <label class="control-label" *ngIf="address.manual"><span class=" font-weight-bold">Address:</span>
                                               {{address.address1}}
                                               {{address.address2}}</label>

                                            <label class="control-label" *ngIf="!address.manual"><span class=" font-weight-bold">Address:</span>
                                               {{address.userLocation}}</label>
                                         </div>
                                         <div class="col-lg-6">
                                            <label class="control-label"><span class=" font-weight-bold">Phone:</span> {{customerSelected.phone}}</label>
                                         </div>
                                         <div class="col-lg-6">
                                            <label class="control-label"><span class=" font-weight-bold">City:</span>
                                               {{address.cityName}}</label>
                                         </div>
                                         <div class="col-lg-6">
                                            <label class="control-label"><span class=" font-weight-bold">Province:</span>
                                               {{address.stateName}}</label>
                                         </div>
                                         <div class="col-lg-6">
                                            <label class="control-label"><span class=" font-weight-bold">Country:</span>
                                               {{address.countryName}}</label>
                                         </div>
                                         <div class="col-lg-6">
                                            <label class="control-label"><span class=" font-weight-bold">Email:</span>
                                               {{customerSelected.email}}</label>
                                         </div>
                                      </div>

                                   </div>


                                </div>

                             </div>
                          </div>
                       </div>
                      </div>
                    </div>
                    <div class="col-lg-5 offset-lg-1">
                      <div class="row">
                        <div class="col-lg-10">
                          <label class="control-label font-weight-bold font-bold text-lg-right pt-2">
                            Reference#/Order#</label>
                          <input type="text" class="form-control" [(ngModel)]="invRef" name="invRef"
                            placeholder="Enter Unique Reference Number">
                        </div>
                      </div>
                      <div class="row pt-2">
                        <div class="col-lg-5">
                          <label class="control-label font-weight-bold font-bold text-lg-right pt-2">Due Date</label>
                          <input type="date" class="form-control" [(ngModel)]="invoiceData.invDueDate" name="invDueDate">
                        </div>
                        <div class="col-lg-5">
                          <label class="control-label font-weight-bold font-bold text-lg-right pt-2">Payment
                            Terms</label>
                          <ng-select class="form-control populate" [(ngModel)]="invoiceData.invPayTerms" name="invPayTerms">
                              <ng-option value="1">15 Days</ng-option>
                              <ng-option value="2">30 Days</ng-option>
                              <ng-option value="2">45 Days</ng-option>
                              <ng-option value="2">Due On Receipt</ng-option>
                              <ng-option value="2">Due End Of The Month</ng-option>
                          </ng-select>
                        </div>
                      </div>
                      <div class="row pt-2">
                        <div class="col-lg-10">
                          <label class="control-label font-weight-bold font-bold text-lg-right pt-2">
                            Salesperson</label>
                          <ng-select class="form-control populate" [(ngModel)]="invoiceData.invSalesman" name="invSalesman">
                            <optgroup label="Select">
                              <ng-option value="Salesman 1">Salesman 1</ng-option>
                              <ng-option value="Salesman 2">Salesman 2</ng-option>
                              <ng-option value="Salesman 3">Salesman 3</ng-option>
                              <ng-option value="Salesman 4">Salesman 4</ng-option>
                              <ng-option value="Salesman 5">Salesman 5</ng-option>
                            </optgroup>
                          </ng-select>
                        </div>
                      </div>
                      <div class="row pt-2">
                        <div class="col-lg-10">
                          <label class="control-label font-weight-bold font-bold text-lg-right pt-2">Invoice
                            Subject</label>
                          <input type="text" class="form-control" placeholder="Rent Invoice" [(ngModel)]="invoiceData.invSubject"
                            name="invSubject">
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-12">
                      <div class="row">
                        <div class="col-lg-6">
                          <h4>Details</h4>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-10 offset-lg-1">
                      <div class="row pt-2">
                        <table class="table table-bordered">
                          <thead>
                            <tr>
                              <th width="25%">Commodity/Service</th>
                              <th width="15%">Quantity/Hours</th>
                              <th width="10%">Price/Rate</th>
                              <th width="20%">Amount</th>
                              <th width="25%">Account</th>
                              <th width="5%">Action</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let dt of invoiceData.details; let d = index;">
                              <td>
                                <input type="text" class="form-control" [(ngModel)]="dt.commodityService" name="commodityService{{d}}">
                              </td>
                              <td>
                                <div class="row">
                                  <div class="col-lg-12">
                                    <input type="text" class="form-control" [(ngModel)]="dt.qtyHours" name="qtyHours{{d}}">
                                  </div>
                                </div>
                              </td>
                              <td>
                                <div class="row">
                                  <div class="col-lg-12">
                                    <input type="text" class="form-control" [(ngModel)]="dt.priceRate" name="priceRate{{d}}">
                                  </div>
                                </div>
                              </td>
                              <td>
                                <div class="row">
                                  <div class="col-lg-6 pr-0">
                                    <input type="text" class="form-control" placeholder="0.00" [(ngModel)]="dt.amount" name="amount{{d}}" (change)="calculateAmount()">
                                  </div>
                                  <div class="col-lg-6 pl-0">
                                    <ng-select class="form-control populate" [(ngModel)]="dt.amtCur" name="amtCur{{d}}">
                                        <ng-option value="CAD">CAD</ng-option>
                                        <ng-option value="USD">USD</ng-option>
                                    </ng-select>
                                  </div>
                                </div>
                              </td>
                              <td>
                                <div class="row">
                                  <div class="col-lg-12">
                                    <ng-select class="form-control populate" [(ngModel)]="dt.accountID" name="accountID{{d}}">
                                        <ng-option *ngFor="let act of accounts | async" value="{{act.actID}}">{{act.actNo}} - {{act.actName}}</ng-option>
                                    </ng-select>
                                  </div>
                                </div>
                              </td>
                              <td class="text-center">
                               <span *ngIf="d>0"><i class="fas fa-trash" (click)="deleteDetail(dt.amount,d)"></i></span>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <button type="button" class="btn btn-success btn-sm" (click)="addDetails()"><i class="fas fa-plus"></i> Add Another Line</button>
                      <div class="row mb-3">
                        <div class="col-12">
                          <div class="bg-white text-dark">
                            <div class=" pt-2 ">
                              <div class="row">
                                <div class="col-lg-6">
                                  <label class="control-label font-weight-bold">Remarks</label>
                                  <textarea class="form-control" rows="7" [(ngModel)]="invoiceData.remarks" name="remarks"></textarea>
                                </div>
                                <div class="col-lg-6">
                                  <div class="row">
                                    <div class="col-lg-5 offset-lg-2">
                                      <div class="row mt-4">
                                        <div class="col-lg-5">
                                          <input type="text" class="form-control" disabled value="Discount">
                                        </div>
                                        <div class="col-lg-7">
                                          <div class="row">
                                            <div class="col-lg-6 pr-0">
                                              <input type="text" class="form-control" placeholder="0.00" [(ngModel)]="invoiceData.discount" name="discount" (change)="calculateAmount()">
                                            </div>
                                            <div class="col-lg-6 pl-0">
                                              <ng-select class="form-control populate" [(ngModel)]="invoiceData.discountUnit" name="discountUnit" (change)="calculateAmount()">
                                                <ng-option value="%">%</ng-option>
                                                <ng-option value="CAD">CAD</ng-option>
                                                <ng-option value="USD">USD</ng-option>
                                              </ng-select>
                                            </div>
                                          </div>
                                        </div>
                                      </div>

                                      <div class="row mt-3">
                                        <div class="col-lg-10 offset-lg-2">
                                          <span>&nbsp;</span>
                                        </div>
                                      </div>

                                      <div class="row mt-4">
                                        <div class="col-lg-10 offset-lg-2">
                                          <span>&nbsp;</span>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="col-lg-5">
                                      <div class="row mt-1 pb-1 mb-1">
                                        <div class="col-lg-9 pt-1">
                                        </div>
                                        <div class="col-lg-3 pt-1">
                                          <p class="text-right">{{midAmt}}</p>
                                        </div>
                                      </div>
                                      <div class="row">
                                        <div class="col-lg-9 bordtop pt-1">
                                          <h5 class="text-right font-weight-bold text-4 text-dark">Subtotal</h5>
                                        </div>

                                        <div class="col-lg-3 bordtop pt-1">
                                          <p class="text-right">{{invoiceData.subTotal}}</p>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-lg-10 offset-lg-2">
                                      <label class="control-label font-weight-bold text-3 text-dark"
                                        for="inputDefault">Province/State</label>
                                    </div>
                                    <div class="col-lg-5 offset-lg-2">
                                      <ng-select
                                      [(ngModel)]="invoiceData.invStateProvince"
                                      name="invStateProvince"
                                       (change)="stateSelectChange()"
                                         class="form-control populate">
                                         <ng-option *ngFor="let stateTax of stateTaxes" selected value="{{stateTax.stateTaxID}}">{{stateTax.stateName}}</ng-option>
                                      </ng-select>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-lg-7 offset-lg-2">
                                          <div class="row mt-4" *ngFor="let item of invoiceData.taxesInfo; let i = index;">
                                             <div class="col-lg-5">
                                                <input type="text" class="form-control" value="{{item.name}}" disabled>
                                             </div>
                                             <div class="col-lg-7">
                                                <div class="input-group">
                                                   <input type="text" class="form-control" placeholder="0.00" value="{{item.amount}}" disabled>
                                                   <span class="input-group-append">
                                                   <span class="input-group-text pt-0 pb-0">%</span>
                                                   </span>
                                                </div>
                                             </div>
                                          </div>
                                          <div class="row mt-3">
                                             <div class="col-lg-10 offset-lg-2">
                                                <span>&nbsp;</span>
                                             </div>
                                          </div>
                                    </div>
                                    <div class="col-lg-3">
                                          <div class="row mt-4 pb-1 mb-1" *ngFor="let item of newTaxes; let i = index">
                                             <div class="col-lg-12 pt-1">
                                                <p class="text-right m-0">{{item.taxAmount ? item.taxAmount : 0}}</p>
                                             </div>
                                          </div>
                                    </div>
                                 </div>
                                  <div class="row">
                                    <div class="col-lg-5 offset-lg-7">
                                      <div class="row">
                                        <div class="col-lg-9 bordtop pt-1">
                                          <h5 class="text-right font-weight-bold text-4 text-dark">Total Amount</h5>
                                        </div>
                                        <div class="col-lg-3 bordtop pt-1">
                                          <p class="text-right">{{invoiceData.totalAmount}}</p>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="form-group row mt-4">
                    <div class="col-lg-11 text-right">
                      <button type="button" class="btn btn-default mr-2" onclick="goBack()">Cancel</button>
                      <button class="btn btn-success mr-2" type="button" *ngIf="!invID" (click)="addInvoice()">Save</button>
                      <button class="btn btn-success mr-2" type="button" *ngIf="invID" (click)="updateInvoice()">Update</button>
                      <!-- <a href="#templateSelectionModal" class="modal-with-form btn btn-success">Save & Send</a> -->
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </section>
    </section>
  </div>
</section>
<div class="modal fade" id="addAccountModal" tabindex="-1" role="dialog" aria-labelledby="addAccountModal"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add Account</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <i class="far fa-window-close modal-dismiss" style="font-size:25px;"> </i>
        </button>
      </div>
      <div class="modal-body text-dark">
        <div class="form-row">
          <div class="form-group col-lg-12">
            <label class="control-label font-weight-bold">Account Type</label>
            <ng-select class="form-control populate">
              <ng-option value="2">Current Assets</ng-option>
              <ng-option value="2">Bank</ng-option>
              <ng-option value="2">Credit Card/Loan</ng-option>
              <ng-option value="2">Depreciation</ng-option>
              <ng-option value="2">Direct Expenses</ng-option>
              <ng-option value="2">Equity</ng-option>
              <ng-option value="2">Expenses</ng-option>
              <ng-option value="2">Fixed Assets</ng-option>
              <ng-option value="2">Future Assets</ng-option>
              <ng-option value="2">Liabilities</ng-option>
              <ng-option value="2">Future Liabilities</ng-option>
              <ng-option value="2">Other Income</ng-option>
              <ng-option value="2">Overheads</ng-option>
              <ng-option value="2">Sales</ng-option>
            </ng-select>

          </div>
        </div>
        <div class="form-row mt-2">
          <div class="form-group col-lg-12">
            <label class="control-label font-weight-bold">Account Number</label>
            <input type="text" class="form-control">
          </div>
        </div>
        <div class="form-row mt-2">
          <div class="form-group col-lg-12">
            <label class="control-label font-weight-bold">Account Name</label>
            <input type="text" class="form-control">
          </div>
        </div>
        <div class="form-row mt-2">
          <div class="form-group col-lg-12">
            <label class="control-label font-weight-bold">Balance</label>
            <div class="row">
              <div class="col-lg-3 pr-0">
                <input type="text" class="form-control" placeholder="0.00"> </div>
              <div class="col-lg-3 pl-0">
                <ng-select class="form-control populate">
                  <optgroup label="">
                    <ng-option value="2">CAD</ng-option>
                    <ng-option value="2">USD</ng-option>
                  </optgroup>
                </ng-select>
              </div>
              <div class="col-lg-1 pr-0">
                <label class="control-label font-weight-bold">as of</label>
              </div>
              <div class="col-lg-4 pr-0">
                <input type="date" class="form-control"> </div>
            </div>
          </div>
        </div>
        <div class="form-row mt-2">
          <div class="form-group col-lg-12">
            <div class="checkbox-custom">
              <input type="checkbox" class="form-control">
              <label class="control-label font-weight-bold">Add To Dashboard Watch List</label>
            </div>
          </div>
        </div>
        <div class="form-row mt-2">
          <div class="form-group col-lg-12">
            <label class="control-label font-weight-bold">Description</label>
            <textarea rows="3" class="form-control"></textarea>
          </div>
        </div>
        <div class="form-row mt-2">
          <div class="col-lg-12 text-right">
            <button class="btn btn-default modal-dismiss mr-2">Cancel</button>
            <button class="btn btn-success modal-dismiss">Save</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
