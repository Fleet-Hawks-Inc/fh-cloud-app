<section class="body">
    <div class="inner-wrapper">
        <section role="main" class="content-body pl-0 pr-0 pt-0">
            <header class="page-header pr19 pl7">
                <div class="row" style="padding-top:10px;">
                    <div class="col-md-2 col-lg-2">
                        <h4 class="text-4 mt-0 mb-0 font-weight-bold text-dark">Settlement</h4>
                    </div>
                    <div class="col-md-10 col-lg-10 pr-1 text-right">
                        <a routerLink="/accounts/settlements/list"
                            class="btn btn-default btn-sm"><i class="fas
                                fa-list"></i> All Settlements</a>
                    </div>
                </div>
            </header>

            <section class="m-2">
                <form class="form-horizontal form-bordered" method="get"
                    #settlementForm="ngForm">

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <div class="bg-white p-3 text-dark">
                                <div class="form-group row adddriverpl pt-3">
                                    <div class="col-lg-6">
                                        <div class="row" id="settlementListDiv">
                                            <div class="col-lg-10">
                                                <label class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Settlement
                                                    For <span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span></label>
                                                <ng-select
                                                    [(ngModel)]="settlementData.type"
                                                    name="SettlementType"
                                                    placeholder="Select
                                                    Settlement For"
                                                    [disabled]="editDisabled"
                                                    (change)="resetFormValues();
                                                    checkSearchDisable();"
                                                    #stlmntFor="ngModel"
                                                    required>
                                                    <ng-option value="driver">Driver</ng-option>
                                                    <ng-option value="carrier">Carrier</ng-option>
                                                    <ng-option
                                                        value="owner_operator">Owner
                                                        Operator</ng-option>
                                                </ng-select>

                                                <div *ngIf="stlmntFor.invalid &&
                                                    (stlmntFor.dirty ||
                                                    stlmntFor.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="stlmntFor.errors.required">
                                                        Settlement is required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="row">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Settlement
                                                    Date <span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span></label>
                                                <input
                                                    [(ngModel)]="settlementData.txnDate"
                                                    name="setDate"
                                                    type="text"
                                                    placeholder="yyyy/mm/dd"
                                                    (click)="setDate.toggle()"
                                                    ngbDatepicker
                                                    #setDate="ngbDatepicker"
                                                    class="form-control"
                                                    autocomplete="off"
                                                    [minDate]="dateMinLimit"
                                                    [maxDate]="futureDatesLimit"
                                                    #setDt="ngModel" required>
                                                <div *ngIf="setDt.invalid &&
                                                    (setDt.dirty ||
                                                    setDt.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="setDt.errors.required">
                                                        Settlement date is
                                                        required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-6">
                                        <div class="row" id="driverListDiv"
                                            *ngIf="settlementData.type ==
                                            'driver'">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Select
                                                    Driver<span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span></label>
                                                <ng-select
                                                    [(ngModel)]="settlementData.entityId"
                                                    name="type"
                                                    placeholder="Select Driver"
                                                    (change)="fetchDriverDetail($event);
                                                    resetAlldata();
                                                    checkSearchDisable();"
                                                    #driverID="ngModel" required
                                                    [disabled]="editDisabled">
                                                    <ng-option value="{{
                                                        data.key }}"
                                                        *ngFor="let data of
                                                        drivers | keyvalue">{{
                                                        data.value }}
                                                    </ng-option>
                                                </ng-select>

                                                <div *ngIf="driverID.invalid &&
                                                    (driverID.dirty ||
                                                    driverID.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="driverID.errors.required">
                                                        Driver is required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" id="carrierListDiv"
                                            *ngIf="settlementData.type ==
                                            'carrier'">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Select
                                                    Carrier<span
                                                        class="mandfield text-2
                                                        ml-1"><sup>*</sup></span></label>
                                                <ng-select
                                                    [(ngModel)]="settlementData.entityId"
                                                    name="type"
                                                    placeholder="Select Carrier"
                                                    (change)="fetchCarrierDetails($event);
                                                    resetAlldata();
                                                    checkSearchDisable();"
                                                    #carrierID="ngModel"
                                                    required
                                                    [disabled]="editDisabled">
                                                    <ng-option value="{{
                                                        data.contactID}}"
                                                        *ngFor="let data of
                                                        allCarriers">{{
                                                        data.companyName }}
                                                    </ng-option>
                                                </ng-select>

                                                <div *ngIf="carrierID.invalid &&
                                                    (carrierID.dirty ||
                                                    carrierID.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="carrierID.errors.required">
                                                        Carrier is required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row"
                                            id="ownerOperatorListDiv"
                                            *ngIf="settlementData.type ==
                                            'owner_operator'">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Select
                                                    Owner Operator<span
                                                        class="mandfield text-2
                                                        ml-1"><sup>*</sup></span></label>
                                                <ng-select
                                                    [(ngModel)]="settlementData.entityId"
                                                    name="type"
                                                    placeholder="Select Owner
                                                    Operator" #ownerID="ngModel"
                                                    required
                                                    (change)="fetchCarrierDetails($event);
                                                    resetAlldata();
                                                    checkSearchDisable();"
                                                    [disabled]="editDisabled">
                                                    <ng-option value="{{
                                                        data.contactID }}"
                                                        *ngFor="let data of
                                                        allOwnerOperators">{{
                                                        data.companyName }}
                                                    </ng-option>
                                                </ng-select>

                                                <div *ngIf="ownerID.invalid &&
                                                    (ownerID.dirty ||
                                                    ownerID.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="ownerID.errors.required">
                                                        Owner operator is
                                                        required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-2"
                                        *ngIf="settlementData.type">
                                        <label class="control-label
                                            font-weight-bold pt-2">From Date<span
                                                class="mandfield text-2 ml-1"><sup>*</sup></span></label>
                                        <input
                                            [(ngModel)]="settlementData.fromDate"
                                            name="fromDate" type="text"
                                            placeholder="yyyy/mm/dd"
                                            (click)="fromDate.toggle()"
                                            ngbDatepicker
                                            #fromDate="ngbDatepicker"
                                            class="form-control"
                                            autocomplete="off"
                                            (dateSelect)="checkSearchDisable();"
                                            [minDate]="dateMinLimit"
                                            [maxDate]="futureDatesLimit"
                                            readonly [disabled]="editDisabled">
                                    </div>
                                    <div class="col-lg-2"
                                        *ngIf="settlementData.type">
                                        <label class="control-label
                                            font-weight-bold pt-2">To Date<span
                                                class="mandfield text-2 ml-1"><sup>*</sup></span></label>
                                        <input
                                            [(ngModel)]="settlementData.toDate"
                                            name="toDate" type="text"
                                            placeholder="yyyy/mm/dd"
                                            (click)="toDate.toggle()"
                                            ngbDatepicker
                                            #toDate="ngbDatepicker"
                                            class="form-control"
                                            autocomplete="off"
                                            (dateSelect)="checkSearchDisable();"
                                            [minDate]="dateMinLimit"
                                            [maxDate]="futureDatesLimit"
                                            readonly [disabled]="editDisabled">
                                    </div>
                                    <div class="col-lg-1 text-right"
                                        *ngIf="settlementData.type &&
                                        !editDisabled">
                                        <button class="btn btn-success
                                            mar-top-37" (click)="searchFnc()"
                                            [disabled]="searchDisabled">Search</button>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <div class="bg-white p-3 text-dark">
                                <div class="form-group row adddriverpl pt-3"
                                    *ngIf="settlementID">
                                    <div class="col-lg-12">
                                        <h4>Settled Trips</h4>
                                    </div>

                                </div>

                                <div id="driverSettlementDiv"
                                    *ngIf="settlementID">
                                    <!-- trip list -->
                                    <div class="row">
                                        <div class="col-lg-10 offset-lg-1">
                                            <table class="table table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th width="5%"
                                                            *ngIf="!settlementData.paymentLinked"></th>
                                                        <th>Trip</th>
                                                        <th>Date</th>
                                                        <th>Order#</th>
                                                        <th>Pick-up</th>
                                                        <th>Delivery</th>
                                                        <th>Driver</th>
                                                        <th>Vehicle</th>
                                                        <th>Assets</th>
                                                        <th>Carrier</th>
                                                        <th>Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="text-center"
                                                        *ngIf="settledTrips.length
                                                        === 0">
                                                        <td colspan="11">{{
                                                            noRecordMsg }}</td>
                                                    </tr>
                                                    <ng-container *ngFor="let
                                                        trp of settledTrips; let
                                                        t=index;">
                                                        <tr>
                                                            <td
                                                                *ngIf="!settlementData.paymentLinked">
                                                                <!--<span *ngIf="settledTrips.length > 1 && trp.subTripCount === 0">-->
                                                                <!--    <a href="javascript:;" (click)="remStldTrip(trp.tripID, '', t)">-->
                                                                <!--        <i class="fa fa-trash"></i>-->
                                                                <!--    </a>-->
                                                                <!--</span>-->
                                                                <span
                                                                    *ngIf="trp.subTripCount
                                                                    === 0">
                                                                    <a
                                                                        href="javascript:;"
                                                                        (click)="remStldTrip(trp.tripID,
                                                                        '', t,
                                                                        '')">
                                                                        <i
                                                                            class="fa
                                                                            fa-trash"></i>
                                                                    </a>
                                                                </span>

                                                                <!--<span *ngIf="settledTrips.length === 1">-->
                                                                <!--    <i class="fa fa-trash" style="color: #CCC"></i>-->
                                                                <!--</span>-->
                                                            </td>
                                                            <td>{{ trp.tripNo }}</td>
                                                            <td>{{
                                                                trp.dateCreated
                                                                |
                                                                date:"yyyy/MM/dd"
                                                                }}</td>
                                                            <td>
                                                                <span
                                                                    *ngFor="let
                                                                    ord of
                                                                    trp.orderId">
                                                                    {{
                                                                    orders[ord]
                                                                    }}
                                                                </span>
                                                            </td>
                                                            <td
                                                                [innerHTML]="trp.pickupLocation"></td>
                                                            <td
                                                                [innerHTML]="trp.dropLocation"></td>
                                                            <td>
                                                                <span
                                                                    *ngFor="let
                                                                    drv of
                                                                    trp.driverIDs;
                                                                    let
                                                                    d=index">
                                                                    {{
                                                                    driversObj[drv]
                                                                    }}
                                                                    <span
                                                                        *ngIf="d<trp.driverIDs.length-1">,</span>
                                                                </span>
                                                            </td>
                                                            <td>
                                                                <span
                                                                    *ngFor="let
                                                                    veh of
                                                                    trp.vehicleIDs;
                                                                    let
                                                                    v=index">
                                                                    {{
                                                                    vehicles[veh]
                                                                    }}
                                                                    <span
                                                                        *ngIf="v<trp.vehicleIDs.length-1">,</span>
                                                                </span>
                                                            </td>
                                                            <td>
                                                                <span
                                                                    *ngFor="let
                                                                    ast of
                                                                    trp.assetIDs;
                                                                    let
                                                                    a=index">
                                                                    {{
                                                                    assets[ast]
                                                                    }}
                                                                    <span
                                                                        *ngIf="a<trp.assetIDs.length-1">,</span>
                                                                </span>
                                                            </td>
                                                            <td>
                                                                <span
                                                                    *ngFor="let
                                                                    carr of
                                                                    trp.carrID;
                                                                    let
                                                                    c=index">
                                                                    {{
                                                                    carriers[carr]
                                                                    }}
                                                                    <span
                                                                        *ngIf="c<trp.carrID.length-1">,</span>
                                                                </span>
                                                            </td>
                                                            <td><span
                                                                    class="badge
                                                                    badge-dark
                                                                    p-1">DELIVERED</span></td>
                                                        </tr>
                                                        <ng-container
                                                            *ngFor="let splt of
                                                            trp.newSplitArr; let
                                                            sp=index">
                                                            <tr>
                                                                <td>
                                                                    <span
                                                                        *ngIf="trp.subTripCount>
                                                                        0">
                                                                        <a
                                                                            href="javascript:;"
                                                                            (click)="remStldTrip(trp.tripID,
                                                                            splt.trips.splitID,
                                                                            t,
                                                                            sp)">
                                                                            <i
                                                                                class="fa
                                                                                fa-trash"></i>
                                                                        </a>
                                                                    </span>
                                                                </td>
                                                                <td>
                                                                    {{
                                                                    trp.tripNo
                                                                    }} ({{
                                                                    splt.trips.stlName
                                                                    }})
                                                                </td>
                                                                <td
                                                                    colspan="10">
                                                                    <div
                                                                        *ngFor="let
                                                                        spltLine
                                                                        of
                                                                        splt.trips.sub">
                                                                        <table
                                                                            class="table">
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td>
                                                                                        <table
                                                                                            class="table
                                                                                            table-bordered">
                                                                                            <tbody>
                                                                                                <tr>
                                                                                                    <td>{{
                                                                                                        spltLine.date
                                                                                                        |
                                                                                                        date:"yyyy/MM/dd"
                                                                                                        }}</td>
                                                                                                    <td>
                                                                                                        <span>
                                                                                                            <b>{{
                                                                                                                spltLine.type
                                                                                                                }}
                                                                                                                Location:
                                                                                                            </b>{{
                                                                                                            spltLine.planLoc
                                                                                                            }}
                                                                                                        </span>
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        <span
                                                                                                            *ngIf="spltLine.driverID"><b>Driver:
                                                                                                            </b>
                                                                                                            {{
                                                                                                            driversObj[spltLine.driverID]
                                                                                                            }}
                                                                                                            <br></span>
                                                                                                        <span
                                                                                                            *ngIf="spltLine.coDriverID"><b>Co-driver:
                                                                                                            </b>
                                                                                                            {{
                                                                                                            driversObj[spltLine.coDriverID]
                                                                                                            }}</span>
                                                                                                        <span
                                                                                                            *ngIf="spltLine.carrierID"><b>Carrier:
                                                                                                            </b>
                                                                                                            {{
                                                                                                            carriers[spltLine.carrierID]
                                                                                                            }}</span>
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        <span
                                                                                                            *ngIf="spltLine.vehicleID"><b>Vehicle:
                                                                                                            </b>
                                                                                                            {{
                                                                                                            vehicles[spltLine.vehicleID]
                                                                                                            }}
                                                                                                            <br></span>
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        <span
                                                                                                            *ngIf="spltLine.assetID.length>
                                                                                                            0">
                                                                                                            <b>Asset(s):
                                                                                                            </b>
                                                                                                            <span
                                                                                                                *ngFor="let
                                                                                                                ast
                                                                                                                of
                                                                                                                spltLine.assetID;
                                                                                                                let
                                                                                                                a=index">
                                                                                                                {{
                                                                                                                assets[ast]
                                                                                                                }}
                                                                                                                <span
                                                                                                                    *ngIf="a<spltLine.assetID.length-1">,<br></span>
                                                                                                            </span>
                                                                                                        </span>
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </tbody>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </ng-container>
                                                    </ng-container>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group row adddriverpl pt-3"
                                    *ngIf="!settlementData.paymentLinked">
                                    <div class="col-lg-10">
                                        <label class="control-label
                                            font-weight-bold font-weight-bold
                                            text-lg-right text-5">Un-settled
                                            Trips</label>
                                    </div>
                                    <div class="col-lg-11"
                                        id="driverSettlementDiv">
                                        <!-- trip list -->
                                        <div class="row"
                                            *ngIf="!settlementData.paymentLinked">
                                            <div class="col-lg-12">
                                                <table class="table
                                                    table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th width="4%">
                                                                <!-- <input type="checkbox"> -->
                                                            </th>
                                                            <th width="6%">Trip#</th>
                                                            <th width="6%">Date</th>
                                                            <th width="6%">Order#</th>
                                                            <th width="35%">Locations</th>
                                                            <th width="6%">Miles</th>
                                                            <th width="11%">Driver</th>
                                                            <th width="7%">Vehicle</th>
                                                            <th width="7%">Assets</th>
                                                            <th width="8%">Carrier</th>
                                                            <!-- <th width="5%">Flat
                                                                Rate</th> -->
                                                            <th width="5%">Status</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="text-center"
                                                            *ngIf="trips.length
                                                            === 0">
                                                            <td colspan="11">{{
                                                                tripMsg }}</td>
                                                        </tr>
                                                        <ng-container
                                                            *ngFor="let trp of
                                                            trips; let
                                                            t=index;">
                                                            <tr>
                                                                <td>
                                                                    <!-- <input type="checkbox" (change)="selectedTrip(t, 'y'); fetchExpenses(trp.tripID, t)" [(ngModel)]="trp.selected" name="chk{{t}}" [indeterminate]="trp.indeterminate"> -->
                                                                    <input
                                                                        type="checkbox"
                                                                        *ngIf="trp.splitArr.length
                                                                        == 0"
                                                                        (change)="selectedTrip(t,
                                                                        'y');"
                                                                        [(ngModel)]="trp.selected"
                                                                        name="chk{{t}}">
                                                                </td>
                                                                <td>
                                                                    <a
                                                                        href="/#/dispatch/trips/trip-details/{{trp.tripID}}"
                                                                        target="_blank">{{
                                                                        trp.tripNo
                                                                        }}</a>
                                                                </td>
                                                                <td>{{
                                                                    trp.dateCreated
                                                                    |
                                                                    date:"yyyy/MM/dd"
                                                                    }}</td>
                                                                <td>
                                                                    <span
                                                                        *ngFor="let
                                                                        ord of
                                                                        trp.orderId;
                                                                        let
                                                                        jo=index">
                                                                        <a
                                                                            href="/#/dispatch/orders/detail/{{ord}}"
                                                                            target="_blank">
                                                                            {{
                                                                            orders[ord]
                                                                            }}
                                                                        </a>
                                                                        <span
                                                                            *ngIf="jo
                                                                        <trp.orderId.length-1">,</span>
                                                                    </span>
                                                                </td>
                                                                <td
                                                                    [innerHTML]="trp.pickupLocation">
                                                                </td>
                                                                <td>
                                                                    {{
                                                                    trp.entityMiles
                                                                    | number :
                                                                    '1.2-2'
                                                                    }}
                                                                </td>
                                                                <td>
                                                                    <span
                                                                        *ngFor="let
                                                                        drv of
                                                                        trp.entityDriver;
                                                                        let
                                                                        d=index">
                                                                        {{
                                                                        driversObj[drv]
                                                                        }}
                                                                        <span
                                                                            *ngIf="d<trp.entityDriver.length-1">,<br></span>
                                                                    </span>
                                                                </td>
                                                                <td>
                                                                    <span
                                                                        *ngFor="let
                                                                        veh of
                                                                        trp.entityVehicle;
                                                                        let
                                                                        v=index">
                                                                        {{
                                                                        vehicles[veh]
                                                                        }}
                                                                        <span
                                                                            *ngIf="v<trp.entityVehicle.length-1">,<br></span>
                                                                    </span>
                                                                </td>
                                                                <td>
                                                                    <span
                                                                        *ngFor="let
                                                                        ast of
                                                                        trp.entityAsset;
                                                                        let
                                                                        a=index">
                                                                        {{
                                                                        assets[ast]
                                                                        }}
                                                                        <span
                                                                            *ngIf="a<trp.entityAsset.length-1">,<br></span>
                                                                    </span>
                                                                </td>
                                                                <td>
                                                                    <span
                                                                        *ngFor="let
                                                                        carr of
                                                                        trp.carrID;
                                                                        let
                                                                        c=index">
                                                                        {{
                                                                        carriers[carr]
                                                                        }}
                                                                        <span
                                                                            *ngIf="c<trp.carrID.length-1">,<br></span>
                                                                    </span>
                                                                </td>
                                                                <!-- <td>
                                                                    yes
                                                                </td> -->
                                                                <td><span
                                                                        class="badge
                                                                        badge-dark
                                                                        p-1">DELIVERED</span></td>
                                                            </tr>

                                                            <ng-container
                                                                *ngFor="let splt
                                                                of trp.splitArr;
                                                                let sp=index">
                                                                <tr>
                                                                    <td
                                                                        colspan="2">
                                                                        <span
                                                                            class="mt-1"><input
                                                                                type="checkbox"
                                                                                (change)="selSubTrip(t,
                                                                                sp);"
                                                                                id="splCheck{{sp}}"
                                                                                [(ngModel)]="splt.selected"
                                                                                name="subchk{{sp}}"></span>
                                                                        {{
                                                                        trp.tripNo
                                                                        }} ({{
                                                                        (splt.splitName)
                                                                        ?
                                                                        splt.splitName
                                                                        :
                                                                        sp+1}})
                                                                    </td>
                                                                    <td
                                                                        colspan="9">
                                                                        <div
                                                                            *ngFor="let
                                                                            spltLine
                                                                            of
                                                                            splt.trips">
                                                                            <table
                                                                                class="table
                                                                                table-bordered">
                                                                                <tbody>
                                                                                    <tr>
                                                                                        <td
                                                                                            width="14%">{{
                                                                                            spltLine.date
                                                                                            |
                                                                                            date:"yyyy/MM/dd"
                                                                                            }}</td>
                                                                                        <td
                                                                                            width="42%">
                                                                                            <span>
                                                                                                <b>{{
                                                                                                    spltLine.type
                                                                                                    }}:
                                                                                                </b>{{
                                                                                                spltLine.planLoc
                                                                                                }}
                                                                                                <br>
                                                                                                <b>Miles</b>:
                                                                                                {{
                                                                                                spltLine.miles
                                                                                                |
                                                                                                number
                                                                                                :
                                                                                                '1.2-2'
                                                                                                }}
                                                                                            </span>
                                                                                        </td>
                                                                                        <td>
                                                                                            <span
                                                                                                *ngIf="spltLine.driverID"><b>Driver:
                                                                                                </b>
                                                                                                {{
                                                                                                driversObj[spltLine.driverID]
                                                                                                }}
                                                                                                <br></span>
                                                                                            <span
                                                                                                *ngIf="spltLine.coDriverID"><b>Co-driver:
                                                                                                </b>
                                                                                                {{
                                                                                                driversObj[spltLine.coDriverID]
                                                                                                }}</span>
                                                                                            <span
                                                                                                *ngIf="spltLine.carrierID"><b>Carrier:
                                                                                                </b>
                                                                                                {{
                                                                                                carriers[spltLine.carrierID]
                                                                                                }}</span>
                                                                                        </td>
                                                                                        <td>
                                                                                            <span
                                                                                                *ngIf="spltLine.vehicleID"><b>Vehicle:
                                                                                                </b>
                                                                                                {{
                                                                                                vehicles[spltLine.vehicleID]
                                                                                                }}
                                                                                                <br></span>
                                                                                        </td>
                                                                                        <td>
                                                                                            <span
                                                                                                *ngIf="spltLine.assetID.length>
                                                                                                0">
                                                                                                <b>Asset(s):
                                                                                                </b>
                                                                                                <span
                                                                                                    *ngFor="let
                                                                                                    ast
                                                                                                    of
                                                                                                    spltLine.assetID;
                                                                                                    let
                                                                                                    a=index">
                                                                                                    {{
                                                                                                    assets[ast]
                                                                                                    }}
                                                                                                    <span
                                                                                                        *ngIf="a<spltLine.assetID.length-1">,<br></span>
                                                                                                </span>
                                                                                            </span>
                                                                                        </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </ng-container>
                                                        </ng-container>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-12">
                                                <label class="control-label
                                                    font-weight-bold
                                                    font-weight-bold
                                                    text-lg-right text-5">Trips
                                                    Information</label>
                                            </div>
                                        </div>

                                        <!-- miles and hours -->
                                        <div class="row pt-2"
                                            *ngIf="settlementData.type ==
                                            'driver'">
                                            <div class="tripdiv20">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Total
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="totalMiles"
                                                            [(ngModel)]="settlementData.miles.tripsTotal"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="row pt-2">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Driver
                                                            Total
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="driverTotal"
                                                            [(ngModel)]="settlementData.miles.driverTotal"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tripdiv20">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Loaded
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="tripsLoaded"
                                                            [(ngModel)]="settlementData.miles.tripsLoaded"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="row pt-2">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Driver
                                                            Loaded
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="driverLoaded"
                                                            [(ngModel)]="settlementData.miles.driverLoaded"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tripdiv20">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Empty
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="tripsEmpty"
                                                            [(ngModel)]="settlementData.miles.tripsEmpty"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="row pt-2">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Driver
                                                            Empty Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="driverEmpty"
                                                            [(ngModel)]="settlementData.miles.driverEmpty"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tripdiv20">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Team
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="tripsTeam"
                                                            [(ngModel)]="settlementData.miles.tripsTeam"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="row pt-2">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Driver
                                                            Team Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="teamHours"
                                                            [(ngModel)]="settlementData.miles.teamHours"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tripdiv20">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Driver
                                                            Team Loaded</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="driverLoadedTeam"
                                                            [(ngModel)]="settlementData.miles.driverLoadedTeam"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="row pt-2">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Driver
                                                            Team Empty</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="driverEmptyTeam"
                                                            [(ngModel)]="settlementData.miles.driverEmptyTeam"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row pt-2"
                                            *ngIf="settlementData.type ==
                                            'carrier'">
                                            <div class="col-lg-2">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Total
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="carrTotalMiles"
                                                            [(ngModel)]="settlementData.miles.tripsTotal"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="row pt-2">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Total
                                                            Hours</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="carrTotalHours"
                                                            [(ngModel)]="settlementData.miles.totalHours"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Loaded
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="carrLoadedMiles"
                                                            [(ngModel)]="settlementData.miles.tripsLoaded"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="row pt-2">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Empty
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="carrEmptyMiles"
                                                            [(ngModel)]="settlementData.miles.tripsEmpty"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row pt-2"
                                            *ngIf="settlementData.type ==
                                            'owner_operator'">
                                            <div class="col-lg-2">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold
                                                            mt-1">Total
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="oprTotalMiles"
                                                            [(ngModel)]="settlementData.miles.tripsTotal"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold
                                                            mt-1">Loaded
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="oprLoadedMiles"
                                                            [(ngModel)]="settlementData.miles.tripsLoaded"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold
                                                            mt-1">Empty
                                                            Miles</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="oprEmptyMiles"
                                                            [(ngModel)]="settlementData.miles.tripsEmpty"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold
                                                            mt-1">Total
                                                            Hours</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            name="oprTotalHours"
                                                            [(ngModel)]="settlementData.miles.totalHours"
                                                            disabled>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- DRIVER 1  -->
                                        <div *ngIf="settlementData.type ==
                                            'owner_operator'">
                                            <div class="row pt-2" *ngFor="let
                                                data of
                                                settlementData.miles.drivers;
                                                let d=index;">
                                                <div class="col-lg-2">
                                                    <div class="row">
                                                        <div class="col-lg-6
                                                            text-right">
                                                            <label
                                                                class="control-label
                                                                font-weight-bold
                                                                mt-1">{{
                                                                driversObj[data.driverID]
                                                                }} 's
                                                                Miles</label>
                                                        </div>
                                                        <div class="col-lg-6">
                                                            <input type="text"
                                                                class="form-control"
                                                                name="drvTotal{{d}}"
                                                                [(ngModel)]="data.total"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-2">
                                                    <div class="row">
                                                        <div class="col-lg-6
                                                            text-right">
                                                            <label
                                                                class="control-label
                                                                font-weight-bold
                                                                mt-1">Loaded
                                                                Miles</label>
                                                        </div>
                                                        <div class="col-lg-6">
                                                            <input type="text"
                                                                class="form-control"
                                                                name="drvLoadedTotal{{d}}"
                                                                [(ngModel)]="data.loaded"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-2">
                                                    <div class="row">
                                                        <div class="col-lg-6
                                                            text-right">
                                                            <label
                                                                class="control-label
                                                                font-weight-bold
                                                                mt-1">Empty
                                                                Miles</label>
                                                        </div>
                                                        <div class="col-lg-6">
                                                            <input type="text"
                                                                class="form-control"
                                                                name="drvEmptyTotal{{d}}"
                                                                [(ngModel)]="data.empty"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-2">
                                                    <div class="row">
                                                        <div class="col-lg-6
                                                            text-right">
                                                            <label
                                                                class="control-label
                                                                font-weight-bold
                                                                mt-1">Total
                                                                Hours</label>
                                                        </div>
                                                        <div class="col-lg-6">
                                                            <input type="text"
                                                                class="form-control"
                                                                name="drvTotalHous{{d}}"
                                                                [(ngModel)]="data.hours"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- settled expenses -->
                                        <div class="row pt-2"
                                            *ngIf="selectedExpenses.length> 0 &&
                                            settlementID">
                                            <div class="col-lg-10">
                                                <h4 class="font-weight-bold">Settled
                                                    Trip Expenses</h4>
                                            </div>
                                            <div class="col-lg-12">
                                                <table class="table
                                                    table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th></th>
                                                            <th>Date</th>
                                                            <th>Trip#</th>
                                                            <th>Expense Name</th>
                                                            <th>Description</th>
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="text-center"
                                                            *ngIf="selectedExpenses.length
                                                            === 0">
                                                            <td colspan="6">{{
                                                                noRecordMsg }}</td>
                                                        </tr>
                                                        <tr *ngFor="let data of
                                                            selectedExpenses;
                                                            let ie=index;">
                                                            <td>
                                                                <a
                                                                    href="javascript:;"
                                                                    title="Delete
                                                                    Entry">
                                                                    <i class="fa
                                                                        fa-trash"
                                                                        (click)="delSelectedExpense(data.expenseID,
                                                                        ie)"></i>
                                                                </a>
                                                            </td>
                                                            <td>{{ data.txnDate
                                                                |
                                                                date:"yyyy/MM/dd"
                                                                }}</td>
                                                            <td>{{
                                                                tripsObject[data.tripID]
                                                                }}</td>
                                                            <td>{{
                                                                categories[data.categoryID]
                                                                }}</td>
                                                            <td>{{ (data.notes)
                                                                ? data.notes :
                                                                '-' }}</td>
                                                            <td>{{ data.amount
                                                                }} {{
                                                                data.currency }}</td>
                                                            <td>{{ data.action
                                                                }}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <!-- expenses -->
                                        <div class="row pt-2">
                                            <div class="col-lg-10">
                                                <h4 class="font-weight-bold">Trip
                                                    Expenses</h4>
                                            </div>
                                            <div class="col-lg-12">
                                                <table class="table
                                                    table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>Date</th>
                                                            <th>Trip#</th>
                                                            <th>Expense Name</th>
                                                            <th>Description</th>
                                                            <th>Amount</th>
                                                            <th>Add</th>
                                                            <th>Deduct</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="text-center"
                                                            *ngIf="finalTripExpenses.length
                                                            === 0">
                                                            <td colspan="6">{{
                                                                noRecordMsg }}</td>
                                                        </tr>
                                                        <tr *ngFor="let data of
                                                            finalTripExpenses;
                                                            let ie=index;">
                                                            <td>{{ data.txnDate
                                                                |
                                                                date:"yyyy/MM/dd"
                                                                }}</td>
                                                            <td>{{
                                                                tripsObject[data.tripID]
                                                                }}</td>
                                                            <td>{{
                                                                categories[data.categoryID]
                                                                }}</td>
                                                            <td>{{ (data.notes)
                                                                ? data.notes :
                                                                '-' }}</td>
                                                            <td>{{ data.amount
                                                                }} {{
                                                                data.currency }}</td>
                                                            <td>
                                                                <input
                                                                    type="checkbox"
                                                                    [(ngModel)]="data.add"
                                                                    name="exp_add{{ie}}"
                                                                    (change)="selectedExpense()"
                                                                    [disabled]="data.addDisabled"
                                                                    />
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="checkbox"
                                                                    [(ngModel)]="data.deduction"
                                                                    name="exp_sub{{ie}}"
                                                                    (change)="selectedExpense()"
                                                                    [disabled]="data.subDisabled"
                                                                    />
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <!-- settled fuel expense -->
                                        <div class="row pt-2"
                                            *ngIf="settlementID &&
                                            settlementData.type == 'driver' ||
                                            settlementData.type ==
                                            'owner_operator'">
                                            <div class="col-lg-10">
                                                <h4 class="font-weight-bold">Settled
                                                    Fuel Expenses</h4>
                                            </div>
                                            <div class="col-lg-12">
                                                <table class="table
                                                    table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th></th>
                                                            <th>Date</th>
                                                            <th>Vehicle</th>
                                                            <th>Location</th>
                                                            <th>Card No.</th>
                                                            <th>Type</th>
                                                            <th>Quantity</th>
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="text-center"
                                                            *ngIf="selectedFuelEnteries.length
                                                            === 0">
                                                            <td colspan="8">{{
                                                                noRecordMsg }}</td>
                                                        </tr>
                                                        <tr *ngFor="let data of
                                                            selectedFuelEnteries;
                                                            let fe=index;">
                                                            <td>
                                                                <a
                                                                    href="javascript:;"
                                                                    title="Delete
                                                                    Entry">
                                                                    <i class="fa
                                                                        fa-trash"
                                                                        (click)="delSelectedFuel(data.fuelID,
                                                                        fe)"></i>
                                                                </a>
                                                            </td>
                                                            <td>{{ data.fuelDate
                                                                |
                                                                date:"yyyy/MM/dd"
                                                                }}</td>
                                                            <td>{{
                                                                data.unitNumber
                                                                }}</td>
                                                            <td>{{ data.cityName
                                                                }}, {{
                                                                data.locationCountry
                                                                }}</td>
                                                            <td>
                                                                {{
                                                                data.fuelCardNumber
                                                                }}
                                                            </td>
                                                            <td>{{ data.type }}</td>
                                                            <td>{{ data.quantity
                                                                }} {{
                                                                data.unitOfMeasure
                                                                }}</td>
                                                            <td>
                                                                {{ data.subTotal
                                                                | number :
                                                                '1.2-2'
                                                                }}
                                                                {{ data.currency
                                                                }}
                                                                <span
                                                                    *ngIf="data.convert">
                                                                    ({{data.total
                                                                    | number :
                                                                    '1.2-2' }}
                                                                    {{data.billingCurrency}},
                                                                    1
                                                                    {{data.billingCurrency}}
                                                                    =
                                                                    {{data.convertRate
                                                                    | number :
                                                                    '1.2-2' }})
                                                                </span>
                                                            </td>
                                                            <td>{{ data.action
                                                                }}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <div class="row pt-2"
                                            *ngIf="settlementData.type ==
                                            'driver' || settlementData.type ==
                                            'owner_operator'">
                                            <div class="col-lg-10">
                                                <h4 class="font-weight-bold">Fuel
                                                    Expenses</h4>
                                            </div>
                                            <div class="col-lg-12">
                                                <table class="table
                                                    table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>Date</th>
                                                            <th>Vehicle</th>
                                                            <th>Location</th>
                                                            <th>Card No.</th>
                                                            <th>Type</th>
                                                            <th>Quantity</th>
                                                            <th>Amount</th>
                                                            <th>Add</th>
                                                            <th>Deduct</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="text-center"
                                                            *ngIf="fuelEnteries.length
                                                            === 0">
                                                            <td colspan="8">{{
                                                                noRecordMsg }}</td>
                                                        </tr>
                                                        <tr *ngFor="let data of
                                                            fuelEnteries; let
                                                            fe=index;">
                                                            <td>{{ data.fuelDate
                                                                |
                                                                date:"yyyy/MM/dd"
                                                                }}</td>
                                                            <td>{{
                                                                data.unitNumber
                                                                }}</td>
                                                            <td>{{ data.cityName
                                                                }}, {{
                                                                data.locationCountry
                                                                }}</td>
                                                            <td>{{
                                                                data.fuelCardNumber}}</td>
                                                            <td>{{ data.type }}</td>
                                                            <td>{{ data.quantity
                                                                }} {{
                                                                data.unitOfMeasure
                                                                }}</td>
                                                            <td>
                                                                {{ data.subTotal
                                                                | number :
                                                                '1.2-2'
                                                                }}
                                                                {{ data.currency
                                                                }}
                                                                <span
                                                                    *ngIf="data.convert">
                                                                    ({{data.total
                                                                    | number :
                                                                    '1.2-2' }}
                                                                    {{data.billingCurrency}},
                                                                    1
                                                                    {{data.billingCurrency}}
                                                                    =
                                                                    {{data.convertRate
                                                                    | number :
                                                                    '1.2-2' }})
                                                                </span>
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="checkbox"
                                                                    [(ngModel)]="data.add"
                                                                    name="add{{fe}}"
                                                                    (change)="selectedFuelEntry()"
                                                                    [disabled]="data.addDisabled"
                                                                    />
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="checkbox"
                                                                    [(ngModel)]="data.deduction"
                                                                    name="sub{{fe}}"
                                                                    (change)="selectedFuelEntry()"
                                                                    [disabled]="data.subDisabled"
                                                                    />
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <!-- trip addition -->
                                        <div class="row pt-2">
                                            <div class="col-lg-10">
                                                <h4 class="font-weight-bold">Addition</h4>
                                            </div>
                                            <div class="col-lg-12">
                                                <table class="table
                                                    table-bordered"
                                                    id="otherChargesTable">
                                                    <thead>
                                                        <tr>
                                                            <th>Trip#</th>
                                                            <th>Charge Name</th>
                                                            <th>Description</th>
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let data of
                                                            settlementData.addition;
                                                            let i=index;">
                                                            <td>{{
                                                                tripsObject[data.tripID]
                                                                }}</td>
                                                            <td>{{
                                                                data.chargeName
                                                                }}</td>
                                                            <td>{{ data.desc }}</td>
                                                            <td>{{ data.amount
                                                                }} {{
                                                                data.currency }}</td>
                                                            <td>
                                                                <span
                                                                    class="badge
                                                                    badge-dark
                                                                    p-2"
                                                                    (click)="delTripAddData(i,
                                                                    'additional')"><i
                                                                        class="fas
                                                                        fa-trash-alt
                                                                        text-light"></i></span>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <ng-select
                                                                    [(ngModel)]="additionRowData.tripID"
                                                                    name="addTripID"
                                                                    placeholder="Select
                                                                    Trip">
                                                                    <ng-option
                                                                        value="{{
                                                                        trip.tripID
                                                                        }}"
                                                                        *ngFor="let
                                                                        trip of
                                                                        selectedTrips">{{
                                                                        trip.tripNo
                                                                        }}</ng-option>
                                                                </ng-select>
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="text"
                                                                    id="cell2"
                                                                    class="form-control"
                                                                    [(ngModel)]="additionRowData.chargeName"
                                                                    name="addChargeName"
                                                                    placeholder="Enter
                                                                    charge
                                                                    name">
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="text"
                                                                    id="cell3"
                                                                    class="form-control"
                                                                    [(ngModel)]="additionRowData.desc"
                                                                    name="adDescription"
                                                                    placeholder="Enter
                                                                    description">
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="text"
                                                                    id="cell4"
                                                                    class="form-control"
                                                                    [(ngModel)]="additionRowData.amount"
                                                                    name="adAmount"
                                                                    placeholder="Enter
                                                                    amount">
                                                            </td>
                                                            <td>
                                                                <button
                                                                    type="button"
                                                                    class="btn
                                                                    btn-success
                                                                    btn-sm"
                                                                    (click)="addAdditionalExp()"><i
                                                                        class="fas
                                                                        fa-plus"></i>
                                                                    Add</button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <div class="row">
                                                    <div class="col-lg-3
                                                        offset-lg-8 pr-5">
                                                        <div class="row">
                                                            <div class="col-lg-6
                                                                text-right">
                                                                <label
                                                                    class="control-label
                                                                    font-weight-bold">Total
                                                                    Addition</label>
                                                            </div>
                                                            <div
                                                                class="col-lg-6">
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    disabled
                                                                    name="additionTotal"
                                                                    [(ngModel)]="settlementData.additionTotal">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-1
                                                        text-right"> </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- trip deduction -->
                                        <div class="row">
                                            <div class="col-lg-10">
                                                <h4 class="font-weight-bold">Deduction</h4>
                                            </div>
                                            <div class="col-lg-12">
                                                <table class="table
                                                    table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>Trip#</th>
                                                            <th>Charge Name</th>
                                                            <th>Description</th>
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let data of
                                                            settlementData.deduction;
                                                            let i=index;">
                                                            <td>{{
                                                                tripsObject[data.tripID]
                                                                }}</td>
                                                            <td>{{
                                                                data.chargeName
                                                                }}</td>
                                                            <td>{{ data.desc }}</td>
                                                            <td>{{ data.amount
                                                                }} {{
                                                                data.currency }}</td>
                                                            <td>
                                                                <span
                                                                    class="badge
                                                                    badge-dark
                                                                    p-2"
                                                                    (click)="delTripAddData(i,
                                                                    'deduction')"><i
                                                                        class="fas
                                                                        fa-trash-alt
                                                                        text-light"></i></span>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <ng-select
                                                                    [(ngModel)]="deductionRowData.tripID"
                                                                    name="dedTripID"
                                                                    placeholder="Select
                                                                    Trip">
                                                                    <ng-option
                                                                        value="{{
                                                                        trip.tripID
                                                                        }}"
                                                                        *ngFor="let
                                                                        trip of
                                                                        selectedTrips">{{
                                                                        trip.tripNo
                                                                        }}</ng-option>
                                                                </ng-select>
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    [(ngModel)]="deductionRowData.chargeName"
                                                                    name="dedChargeName"
                                                                    placeholder="Enter
                                                                    charge
                                                                    name">
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    [(ngModel)]="deductionRowData.desc"
                                                                    name="dedDescription"
                                                                    placeholder="Enter
                                                                    description">
                                                            </td>
                                                            <td>
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    [(ngModel)]="deductionRowData.amount"
                                                                    name="dedAmount"
                                                                    placeholder="Enter
                                                                    amount">
                                                            </td>
                                                            <td>
                                                                <button
                                                                    type="button"
                                                                    class="btn
                                                                    btn-success
                                                                    btn-sm"
                                                                    (click)="adddeductionExp()"><i
                                                                        class="fas
                                                                        fa-plus"></i>
                                                                    Add</button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <div class="row">
                                                    <div class="col-lg-3
                                                        offset-lg-8">
                                                        <div class="row">
                                                            <div class="col-lg-6
                                                                text-right">
                                                                <label
                                                                    class="control-label
                                                                    font-weight-bold">Total
                                                                    Deduction</label>
                                                            </div>
                                                            <div
                                                                class="col-lg-6">
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    disabled
                                                                    [(ngModel)]="settlementData.deductionTotal"
                                                                    name="deductionTotal">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-1
                                                        text-right"> </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- total payment -->
                                        <div class="row pt-4">
                                            <div class="col-lg-7 offset-lg-1"
                                                *ngIf="settlementData.type ==
                                                'driver' || settlementData.type
                                                == null"></div>
                                            <div class="col-lg-7 offset-lg-1"
                                                *ngIf="settlementData.type ==
                                                'carrier'">
                                                <div class="row pt-2">
                                                    <div class="col-lg-3
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Local
                                                            Tax(%)</label>
                                                    </div>
                                                    <div class="col-lg-2">
                                                        <input type="text"
                                                            class="form-control"
                                                            placeholder="Local
                                                            Tax(%)"
                                                            [(ngModel)]="settlementData.taxObj.carrLocalTax"
                                                            name="carrLocalTax"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="row pt-2">
                                                    <div class="col-lg-3
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Federal
                                                            Tax(%)</label>
                                                    </div>
                                                    <div class="col-lg-2">
                                                        <input type="text"
                                                            class="form-control"
                                                            placeholder="Federal
                                                            Tax(%)" disabled
                                                            [(ngModel)]="settlementData.taxObj.carrFedTax"
                                                            name="carrFedTax">
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- <div class="col-lg-7 offset-lg-1" *ngIf="settlementData.type == 'owner_operator'">
                                        <div class="row pt-2" *ngFor="let data of settlementData.miles.drivers; let d=index;">
                                            <div class="col-lg-3 text-right">
                                                <label class="control-label font-weight-bold">{{ drivers[data.driverID] }} 's Payment</label>
                                            </div>
                                            <div class="col-lg-2">
                                                <input type="text" class="form-control" name="ownerdrvTotal{{d}}" [(ngModel)]="data.payment" disabled>
                                            </div>
                                            <div class="col-lg-4">
                                                <label class="font-weight-bold">
                                                    <input type="checkbox" name="ownerDeduction{{d}}" (change)="deductFromOwnerOperator()" [(ngModel)]="data.ownerDeduction"> Deduct from Owner Operator</label>
                                            </div>
                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-3 text-right">
                                                <label class="control-label font-weight-bold">GST (%)</label>
                                            </div>
                                            <div class="col-lg-2">
                                                <input type="number" class="form-control" name="gstPrcnt" [(ngModel)]="settlementData.taxObj.gstPrcnt" (input)="calculateTaxes()">
                                            </div>
                                            <div class="col-lg-2">
                                                <input type="text" class="form-control" placeholder="Value" disabled name="gstAmount" [(ngModel)]="settlementData.taxObj.gstAmount">
                                            </div>
                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-3 text-right">
                                                <label class="control-label font-weight-bold">PST (%)</label>
                                            </div>
                                            <div class="col-lg-2">
                                                <input type="number" class="form-control" name="pstPrcnt" [(ngModel)]="settlementData.taxObj.pstPrcnt" (input)="calculateTaxes()">
                                            </div>
                                            <div class="col-lg-2">
                                                <input type="text" class="form-control" placeholder="Value" disabled name="pstAmount" [(ngModel)]="settlementData.taxObj.pstAmount">
                                            </div>
                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-3 text-right">
                                                <label class="control-label font-weight-bold">HST (%)</label>
                                            </div>
                                            <div class="col-lg-2">
                                                <input type="number" class="form-control" name="hstPrcnt" [(ngModel)]="settlementData.taxObj.hstPrcnt" (input)="calculateTaxes()">
                                            </div>
                                            <div class="col-lg-2">
                                                <input type="text" class="form-control" placeholder="HST Amount" disabled name="hstAmount" [(ngModel)]="settlementData.taxObj.hstAmount">
                                            </div>
                                        </div>
                                    </div> -->
                                            <div class="col-lg-7 offset-lg-1"
                                                *ngIf="settlementData.type ==
                                                'owner_operator'"></div>
                                            <div class="col-lg-3">
                                                <div class="row">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Total
                                                            Payment</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.paymentTotal"
                                                            name="paymentTotal">
                                                    </div>
                                                </div>

                                                <div class="row pt-1">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Payment
                                                            Currency</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.currency"
                                                            name="paymentInfoCurrency">
                                                    </div>
                                                </div>

                                                <div class="row pt-1">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Other
                                                            Charges</label>
                                                    </div>
                                                </div>
                                                <div class="row pt-1">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Add</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.additionTotal"
                                                            name="additionTotal">
                                                    </div>
                                                </div>
                                                <div class="row pt-1">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Deduct</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.deductionTotal"
                                                            name="deductionTotal">
                                                    </div>
                                                </div>
                                                <div class="row pt-1"
                                                    *ngIf="settlementData.type
                                                    == 'driver' ||
                                                    settlementData.type ==
                                                    'owner_operator'">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Fuel
                                                            Addition</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.fuelAdd"
                                                            name="fuelAdd">
                                                    </div>
                                                </div>

                                                <div class="row pt-1"
                                                    *ngIf="settlementData.type
                                                    == 'driver' ||
                                                    settlementData.type ==
                                                    'owner_operator'">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Fuel
                                                            Deduction</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.fuelDed"
                                                            name="fuelDed">
                                                    </div>
                                                </div>

                                                <div class="row pt-1">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Expense
                                                            Addition</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.expAdd"
                                                            name="expAdd">
                                                    </div>
                                                </div>

                                                <div class="row pt-1">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Expense
                                                            Deduction</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.expDed"
                                                            name="expDed">
                                                    </div>
                                                </div>

                                                <div class="row pt-1"
                                                    *ngIf="settlementData.type
                                                    == 'carrier' ||
                                                    settlementData.type ==
                                                    'owner_operator'">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Taxes</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.taxes"
                                                            name="taxes">
                                                    </div>
                                                </div>
                                                <div class="row pt-1">
                                                    <div class="col-lg-6
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold">Grand
                                                            Total</label>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <input type="text"
                                                            class="form-control"
                                                            disabled
                                                            [(ngModel)]="settlementData.finalTotal"
                                                            name="finalTotal"
                                                            #finalttl="ngModel"
                                                            required>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="form-group row mt-4">
                                    <div class="col-lg-11 text-right">
                                        <button type="button" class="btn
                                            btn-default mr-2"
                                            (click)="cancel()">Cancel</button>
                                        <button class="btn btn-success"
                                            *ngIf="!settlementID"
                                            [disabled]="!settlementForm.form.valid
                                            || submitDisabled"
                                            (click)="addRecord()">Save</button>
                                        <button class="btn btn-success"
                                            *ngIf="settlementID &&
                                            !settlementData.paymentLinked"
                                            [disabled]="!settlementForm.form.valid
                                            || submitDisabled"
                                            (click)="updateRecord()">Update</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                </form>
            </section>

        </section>
    </div>
</section>
