<section class="body">
  <div class="inner-wrapper">
    <section role="main" class="content-body pl-0 pr-0 pt-0">
      <header class="page-header pr19 pl7">
        <div class="row" style="padding-top: 10px">
          <div class="col-md-4 col-lg-4">
            <h4 class="text-4 mt-0 mb-0 font-weight-bold text-dark">
              Sales Invoice# - {{sInvNo}}
              <span class="badge badge-danger p-1" *ngIf="isInvDue">{{status}}</span>
              <span class="badge badge-dark p-1 text-uppercase" *ngIf="!isInvDue">
                <span *ngIf="status === 'open'">Open</span>
                <span *ngIf="status === 'partially_deducted'">Partially Received</span>

              </span>
            </h4>
          </div>
          <div class="col-md-8 col-lg-8 text-right pr-1">
            <button type="button" *ngIf="isPDF" class="btn btn-success btn-sm mr-2" (click)="openModal()">
              PDF
            </button>
            <a routerLink="/accounts/sales/invoices/list" class="btn btn-sm btn-default"><i class="fas fa-list"></i> All
              Sales Invoices</a>
          </div>
        </div>
      </header>

      <section class="m-2">
        <div class="row mb-3">
          <div class="col-lg-12">
            <div class="bg-white p-3 text-dark">
              <div class="form-group row">
                <div class="col-lg-12">
                  <div class="row">
                    <div class="col-md-4 col-lg-4">
                      <div class="text-center p-4 cmaindiv">
                        <i class="far fa-calendar-alt text-7"></i>
                        <br />
                        <p class="mb-0 text-5 font-weight-bold text-dark">
                          {{ txnDate | date: "yyyy/MM/dd" }}
                        </p>
                        <p class="mb-0">DATE</p>
                      </div>
                    </div>
                    <div class="col-md-4 col-lg-4">
                      <div class="text-center p-4 cmaindiv">
                        <i class="fa fa-user text-7"></i>
                        <br />
                        <p class="mb-0 text-5 font-weight-bold text-dark text-capitalize">
                          {{ cName ? cName : '-' }}
                        </p>
                        <p class="mb-0">CUSTOMER</p>
                      </div>
                    </div>

                    <div class="col-md-4 col-lg-4">
                      <div class="text-center p-4 cmaindiv">
                        <i class="fas fa-money-bill-wave text-7"></i>
                        <br />
                        <p class="mb-0 text-5 font-weight-bold text-dark">
                          {{ currency }} {{ finalTotal }}
                        </p>
                        <p class="mb-0">AMOUNT</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-lg-12">
            <div class="bg-white p-3 text-dark">
              <div class="form-group row">
                <div class="col-lg-6">
                  <div class="row">
                    <div class="col-lg-12">
                      <table class="table table-bordered table-responsive-lg">
                        <tbody>
                          <tr>
                            <td width="40%" class="back-color-gray font-weight-bold">
                              Due Date
                            </td>
                            <td width="60%">{{ dueDate | date: "yyyy/MM/dd" }}</td>
                          </tr>
                          <tr>
                            <td class="back-color-gray font-weight-bold">
                              Reference#
                            </td>
                            <td>{{ sRef ? sRef : '-' }}</td>
                          </tr>
                          <tr>
                            <td class="back-color-gray font-weight-bold">
                              Sales Person
                            </td>
                            <td>{{ salePerson ? salePerson : '-' }}</td>
                          </tr>
                          <tr>
                            <td class="back-color-gray font-weight-bold">
                              Total Amount
                            </td>
                            <td>{{ finalTotal }} {{currency}} </td>
                          </tr>
                          <tr>
                            <td class="back-color-gray font-weight-bold">
                              Received Amount
                            </td>
                            <td>{{ received }} {{currency}} </td>
                          </tr>
                          <tr>
                            <td class="back-color-gray font-weight-bold">
                              Balance Amount
                            </td>
                            <td>{{ balance }} {{currency}} </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="row">
                    <div class="col-lg-12">
                      <table class="table table-bordered table-responsive-lg">
                        <tbody>
                          <tr>
                            <td class="back-color-gray font-weight-bold">
                              Payment Terms
                            </td>
                            <td>
                              <span *ngIf="paymentTerm === '15'">15 Days</span>
                              <span *ngIf="paymentTerm === '30'">30 Days</span>
                              <span *ngIf="paymentTerm === '45'">45 Days</span>
                              <span *ngIf="paymentTerm === 'dueReceipt'">Due on receipt</span>
                              <span *ngIf="paymentTerm === 'dueEnd'">Due end of the month</span>
                              <span *ngIf="paymentTerm === 'custom'">Custom</span>
                            </td>
                          </tr>
                          <!-- <tr>
                                    <td width="40%" class="back-color-gray font-weight-bold">Discount</td>
                                    <td width="60%">50 CAD</td>
                                 </tr> -->
                          <tr>
                            <td width="40%" class="back-color-gray font-weight-bold">
                              Taxes
                            </td>
                            <td width="60%">
                              <span *ngFor="
                                  let data of taxes;
                                  let j = index;
                                  last as isLast
                                ">
                                {{ data.name ? data.name : '' }} {{ data.tax }}%
                                <span *ngIf="!isLast">,</span>
                              </span>
                            </td>
                          </tr>
                          <tr>
                            <td width="40%" class="back-color-gray font-weight-bold">
                              Charges
                            </td>
                            <td width="60%">
                              {{chargeName}},
                              {{chargeType === 'add' ? '+' : '-'}} {{chargeAmount}} {{ currency }}
                            </td>
                          </tr>

                          <tr>
                            <td class="back-color-gray font-weight-bold">
                              Remarks
                            </td>
                            <td>{{remarks ? remarks : '-'}}</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="row">
                    <div class="col-lg-12">
                      <table class="table table-bordered table-hover">
                        <thead>
                          <tr>
                            <th>Commodity</th>
                            <th>Quantity</th>
                            <th>Rate</th>
                            <th>Amount</th>
                            <th>Description</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let item of sOrderDetails">
                            <td>{{ item.commodity ? item.commodity : "-" }}</td>
                            <td>
                              {{ item.qty ? item.qty : "-" }} {{ item.qtyUnit }}
                            </td>
                            <td>
                              {{ item.rate ? item.rate : "-" }} per
                              {{ item.rateUnit }}
                            </td>
                            <td>
                              {{ item.amount ? item.amount : "-" }}
                              {{ currency }}
                            </td>
                            <td>{{ item.desc ? item.desc : "-" }}</td>
                          </tr>
                          <tr *ngIf="sOrderDetails?.length === 0">
                            <td>No Data Found</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="row">
                    <div class="col-lg-12">
                      <table class="table table-bordered table-hover">
                        <thead>
                          <tr>
                            <th>Account Name</th>
                            <th>Debit</th>
                            <th>Credit</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>Inventory Acoount</td>
                            <td>0.00</td>
                            <td>1000 CAD</td>
                          </tr>
                          <tr>
                            <td>Accounts Receivable</td>
                            <td>1000 CAD</td>
                            <td>0.00</td>
                          </tr>
                          <tr>
                            <td>Total</td>
                            <td>1000 CAD</td>
                            <td>1000 CAD</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </section>
  </div>
</section>


<ng-template #previewSaleInvoice let-modal>
  <div class="modal-content">

    <div class="modal-body text-dark" id="print_invoice">
      <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
        <tbody>
          <tr>
            <td>
              <h1 class="modal-title mt-0" id="modal-basic-title"><strong>Sales Invoice</strong></h1>
            </td>
          </tr>
          <tr>
            <td valign="center">
              <p class="text-dark" style="font-size:13px; margin-bottom:5px; margin-top:5px;"><strong>Sales
                  Invoice #:</strong> {{ sInvNo }}</p>
              <p class="text-dark" style="font-size:13px; margin-bottom:5px; margin-top:5px;">
                <strong>Sales Invoice Date:</strong> {{ txnDate ? (txnDate | date: "yyyy/MM/dd") : "-" }}
              </p>
            </td>
            <td valign="center" align="right">
              <img crossorigin="anonymous" *ngIf="logo" [src]="logo" class="mb-2" alt="logo" style="max-width: 100px;">
              <p *ngIf="tagline && tagline != ''" class="mb-2 font-weight-bold text-dark">{{ tagline }}</p>

            </td>
          </tr>
          <tr>
            <td colspan="2" height="1" bgcolor="#bbbbbb"></td>
          </tr>
          <tr>
            <td width="50%" valign="top">
              <h2 class="text-dark" style="font-size:20px;">Customer</h2>
              <p class="text-dark text-capitalize mb-2" style="font-size:13px;"> <strong>{{cName ? cName :
                  'NA'}}</strong><br>
                <strong>Address:</strong> {{cusAddress ? cusAddress : 'NA'}}<br>
              </p>
            </td>
            <td valign="top" align="right">
              <h2 style="font-size:20px;">&nbsp;</h2>
              <p class=" text-dark mb-2" style="font-size:13px;"> <strong>Phone:</strong> {{cusPhone ? cusPhone :
                'NA'}}<br>
                <strong>Email:</strong> {{cusEmail ? cusEmail : 'NA'}}<br>
              </p>
            </td>
          </tr>
          <tr>
            <td colspan="2" height="1" bgcolor="#bbbbbb"></td>
          </tr>
          <tr>
            <td colspan="2">&nbsp;</td>
          </tr>
          <tr>
            <td colspan="2">
              <h2 style="font-size:16px; margin-bottom:10px; margin-top:0px;">Invoice</h2>
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <table width="100%" border="0" style="border:1px solid #adadad; font-size:13px;" cellspacing="0"
                cellpadding="0">
                <tbody>
                  <tr bgcolor="#f3f3f3">
                    <td width="15%"
                      style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Due Date#</p>
                    </td>
                    <td width="15%"
                      style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Reference#</p>
                    </td>
                    <td width="15%"
                      style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Sales Person</p>
                    </td>
                    <td width="15%"
                      style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Status</p>
                    </td>
                    <td style="border-bottom:1px solid #adadad; text-align: right; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Remarks</p>
                    </td>
                  </tr>
                  <tr>
                    <td height="25" style="border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark">{{ dueDate ? (dueDate | date: "yyyy/MM/dd") : '-' }}</p>
                    </td>
                    <td height="25" style="border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark"> {{ sRef ? sRef : '-' }}</p>
                    </td>
                    <td style="border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark">{{ salePerson ? salePerson : '-' }} </p>
                    </td>
                    <td style="border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark">{{
                        status ? status : '-'
                        }}</p>
                    </td>
                    <td style="text-align: right; padding:10px;">
                      <p class="m-0 text-dark">{{ remarks ? remarks : "-" }}</p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
          <tr>
            <td colspan="2">&nbsp;</td>
          </tr>
          <tr>
            <td colspan="2">
              <h2 style="font-size:16px; margin-bottom:10px; margin-top:0px;">Extras</h2>
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <table width="100%" border="0"
                style="border:1px solid #adadad; border-bottom:0px solid #adadad; border-right:0px solid #adadad; font-size:13px;"
                cellspacing="0" cellpadding="0">
                <tbody>
                  <tr bgcolor="#f3f3f3">
                    <td style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Taxes</p>
                    </td>
                    <td style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Charges</p>
                    </td>
                  </tr>
                  <tr>
                    <td width="50%"
                      style="border-right:1px solid #adadad; border-bottom:1px solid #adadad; padding:10px;">
                      <table width="100%">
                        <tbody>
                          <tr>
                            <td>
                              <span *ngFor="
                                  let data of taxes;
                                  let j = index;
                                  last as isLast
                                ">
                                {{ data.name }}: {{ data.tax }}%
                                <span *ngIf="!isLast">,</span>
                              </span>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </td>

                    <td width="50%"
                      style="border-right:1px solid #adadad; border-bottom:1px solid #adadad; padding:10px;">

                      <table width="100%">
                        <tbody>
                          <tr>
                            <td width="60%">
                              {{chargeName}},
                              {{chargeType === 'add' ? '+' : '-'}} {{chargeAmount}} {{ currency }}
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </td>

                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
          <tr>
            <td colspan="2">&nbsp;</td>
          </tr>
          <tr>
            <td colspan="2">
              <table width="100%" border="0"
                style="border:1px solid #adadad; border-bottom:0px solid #adadad; font-size:13px;" cellspacing="0"
                cellpadding="0">
                <thead>
                  <tr bgcolor="#f3f3f3">
                    <td width="15%"
                      style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Commodity</p>
                    </td>
                    <td width="15%"
                      style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Quantity</p>
                    </td>
                    <td width="15%"
                      style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Rate</p>
                    </td>
                    <td width="27%"
                      style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Description</p>
                    </td>
                    <td style="border-bottom:1px solid #adadad; text-align: left; padding:10px;">
                      <p class="m-0 text-dark" style="font-weight:600;">Amount</p>
                    </td>
                  </tr>
                </thead>
                <tbody>

                  <tr *ngFor="let item of sOrderDetails">
                    <td style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">{{
                      item.commodity ? item.commodity : "-" }}</td>
                    <td style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      {{ item.qty ? item.qty : "-" }} {{ item.qtyUnit }}
                    </td>
                    <td style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      {{ item.rate ? item.rate : "-" }} /
                      {{ item.rateUnit }}
                    </td>
                    <td style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">
                      {{ item.amount ? item.amount : "-" }}
                      {{ currency }}
                    </td>
                    <td style="border-bottom:1px solid #adadad; border-right:1px solid #adadad; padding:10px;">{{
                      item.desc ? item.desc : "-" }}</td>
                  </tr>
                  <tr *ngIf="sOrderDetails?.length === 0">
                    <td>No Data Found</td>
                  </tr>
                </tbody>
              </table>
              <table class="border-0 w-100 mt-4">
                <tbody>

                  <tr>
                    <td class="border-0 text-right" colspan="5">Total Amount: <span
                        style="font-size: 30px;font-weight: 600;">{{ currency
                        }} {{
                        finalTotal ? (finalTotal | number: "1.2-2") : "0"
                        }}</span></td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
          <tr>
            <td colspan="2">&nbsp;</td>
          </tr>
          <tr>
            <td colspan="2">
              <table border="0" align="center" cellpadding="0" cellspacing="0">
                <tbody>
                  <tr>
                    <td align="center">
                      <h2 style="font-size:13px;">Powered By</h2>
                      <img src="../../../../../../assets/img/logo.png" width="207" height="28">
                    </td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
          <tr>
            <td colspan="2">&nbsp;</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="modal-footer">

      <button type="button" (click)="modal.dismiss('Cross click')" class="btn
        btn-default">
        Cancel
      </button>
      <button (click)="generatePDF()" class="btn
        btn-success ml-2 ">Download</button>

    </div>
  </div>
</ng-template>