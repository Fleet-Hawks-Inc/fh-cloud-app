<section class="body">
    <div class="inner-wrapper">
        <section role="main" class="content-body pl-0 pr-0 pt-0">
            <header class="page-header">
                <div class="row" style="padding-top: 10px">
                    <div class="col-md-4 col-lg-4 font-weight-bold text-4
                        text-dark">
                        Add Bill
                    </div>
                    <div class="col-md-8 col-lg-8 text-right pr-3">
                        <a
                            routerLink="/accounts/purchases/bills/list"
                            class="btn btn-default btn-sm"><i class="fas
                                fa-list"></i> All
                            Bills</a>
                    </div>
                </div>
            </header>

            <section class="m-2">
                <form class="form-horizontal form-bordered" method="get"
                    #purchaseForm="ngForm">
                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <div class="bg-white p-3 text-dark">
                                <div class="form-group row adddriverpl pt-3">
                                    <div class="col-lg-5 mb-3">
                                        <div class="row">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right
                                                    pt-2">Bill Date
                                                    <span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span>
                                                </label>
                                                <input
                                                    [(ngModel)]="orderData.txnDate"
                                                    name="txnDate"
                                                    type="text"
                                                    placeholder="yyyy/mm/dd"
                                                    (click)="custexp.toggle()"
                                                    ngbDatepicker
                                                    #custexp="ngbDatepicker"
                                                    class="form-control"
                                                    autocomplete="off"
                                                    [minDate]="dateMinLimit"
                                                    [maxDate]="futureDatesLimit"
                                                    #jDate="ngModel"
                                                    required readonly
                                                    />

                                                <div *ngIf="jDate.invalid &&
                                                    (jDate.dirty ||
                                                    jDate.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="jDate.errors.required">
                                                        Bill date is required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right
                                                    pt-2">Vendor
                                                    <span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span>
                                                </label>
                                                <ng-select
                                                    [(ngModel)]="orderData.vendorID"
                                                    name="vendorID"
                                                    placeholder="Select Vendor"
                                                    #vendorID="ngModel"
                                                    required
                                                    (change)="changeVendor()"
                                                    [disabled]="editDisabled">
                                                    <ng-option value="{{
                                                        data.contactID }}"
                                                        *ngFor="let
                                                        data of vendors">{{
                                                        data.companyName }}</ng-option>
                                                </ng-select>

                                                <div *ngIf="vendorID.invalid &&
                                                    (vendorID.dirty ||
                                                    vendorID.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="vendorID.errors.required">
                                                        Vendor is required.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2 mar-top-37">
                                                <a
                                                    (click)="openModal('form')"
                                                    href="javascript:;"
                                                    class="btn btn-sm
                                                    btn-success
                                                    modal-with-form">
                                                    <i class="fas fa-plus"></i>
                                                </a>
                                            </div>

                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right
                                                    pt-2">Bill Type
                                                    <span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span>
                                                </label>
                                                <ng-select
                                                    [(ngModel)]="orderData.billType"
                                                    name="billType"
                                                    placeholder="Select Bill
                                                    Type"
                                                    #billType="ngModel"
                                                    required
                                                    [disabled]="editDisabled"
                                                    (change)="typeChange($event)">
                                                    <ng-option value="product">Product</ng-option>
                                                    <ng-option value="service">Service</ng-option>
                                                </ng-select>

                                                <div *ngIf="billType.invalid &&
                                                    (billType.dirty ||
                                                    billType.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="billType.errors.required">
                                                        Bill type is required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row pt-2"
                                            *ngIf="orderData.billType ===
                                            'product'">
                                            <div class="col-lg-10">
                                                <label class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Purchase
                                                    Order</label>
                                                <ng-select
                                                    [(ngModel)]="orderData.purchaseID"
                                                    name="purchaseID"
                                                    placeholder="Select Purchase
                                                    Order"
                                                    #purchaseID="ngModel"
                                                    required
                                                    (change)="fetchPurchaseDetails()"
                                                    [disabled]="editDisabled">
                                                    <ng-option value="{{
                                                        data.purchaseID }}"
                                                        *ngFor="let data of
                                                        purchaseOrders;">{{
                                                        data.orderNo }}</ng-option>
                                                </ng-select>

                                                <div *ngIf="purchaseID.invalid
                                                    &&
                                                    (purchaseID.dirty ||
                                                    purchaseID.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="purchaseID.errors.required">
                                                        Purchase order is
                                                        required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-10">
                                                <label class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Upload
                                                    Document</label>
                                                <input type="file"
                                                    multiple
                                                    name="uplImg"
                                                    class="form-control p-0"
                                                    (change)="selectDocuments($event)">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-5 offset-lg-1 mb-3">
                                        <div class="row">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right
                                                    pt-2">
                                                    Reference#
                                                </label>
                                                <input
                                                    type="text"
                                                    name="refNo"
                                                    [(ngModel)]="orderData.refNo"
                                                    class="form-control"
                                                    placeholder="Enter
                                                    Reference#"
                                                    />
                                            </div>
                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-10">
                                                <label
                                                    class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right
                                                    pt-2">Payment Currency
                                                    <span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span>
                                                </label>
                                                <ng-select
                                                    [(ngModel)]="orderData.currency"
                                                    name="currency"
                                                    placeholder="Select
                                                    currency"
                                                    #curr="ngModel"
                                                    required
                                                    [clearable]="false"
                                                    [disabled]="editDisabled"
                                                    (change)="changeVendor()">
                                                    <ng-option value="CAD">CAD</ng-option>
                                                    <ng-option value="USD">USD</ng-option>
                                                </ng-select>

                                                <div *ngIf="curr.invalid
                                                    &&
                                                    (curr.dirty ||
                                                    curr.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="curr.errors.required">
                                                        Currency order is
                                                        required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row pt-2">
                                            <div class="col-lg-5">
                                                <label class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Due Date
                                                    <span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span>
                                                </label>
                                                <input
                                                    [(ngModel)]="orderData.dueDate"
                                                    name="dueDate"
                                                    type="text"
                                                    placeholder="yyyy/mm/dd"
                                                    (click)="dueDate.toggle()"
                                                    ngbDatepicker
                                                    #dueDate="ngbDatepicker"
                                                    class="form-control"
                                                    autocomplete="off"
                                                    [minDate]="dateMinLimit"
                                                    [maxDate]="futureDatesLimit"
                                                    #dueDatem="ngModel"
                                                    required readonly
                                                    />
                                                <div *ngIf="dueDatem.invalid
                                                    &&
                                                    (dueDatem.dirty ||
                                                    dueDatem.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="dueDatem.errors.required">
                                                        Due date is
                                                        required.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-5">
                                                <label class="control-label
                                                    font-weight-bold font-bold
                                                    text-lg-right pt-2">Payment
                                                    Terms
                                                    <span class="mandfield
                                                        text-2 ml-1"><sup>*</sup></span>
                                                </label>
                                                <ng-select
                                                    [(ngModel)]="orderData.paymentTerm"
                                                    name="paymentTerm"
                                                    placeholder="Select Payment
                                                    Terms"
                                                    #paymentTerm="ngModel"
                                                    required>
                                                    <ng-option value="{{
                                                        data.value }}"
                                                        *ngFor="let data of
                                                        paymentTerms">{{
                                                        data.name }}</ng-option>
                                                </ng-select>

                                                <div *ngIf="paymentTerm.invalid
                                                    &&
                                                    (paymentTerm.dirty ||
                                                    paymentTerm.touched)"
                                                    class="text-danger">
                                                    <div
                                                        *ngIf="paymentTerm.errors.required">
                                                        Payment terms is
                                                        required.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3" *ngIf="!editDisabled">
                        <div class="col-lg-12">
                            <div class="bg-white p-3 text-dark">
                                <div class="form-group row
                                    adddriverpl pt-3">
                                    <div class="col-lg-10">
                                        <label
                                            class="control-label
                                            font-weight-bold
                                            font-weight-bold
                                            text-lg-right
                                            text-5">Vendor Credits</label>
                                    </div>
                                    <div class="col-lg-11">
                                        <table
                                            class="table
                                            table-bordered
                                            table-responsive-lg
                                            table-striped
                                            simple-table">
                                            <thead>
                                                <tr
                                                    class="bgcol2">
                                                    <th></th>
                                                    <th
                                                        class="text-2">Credit#</th>
                                                    <th
                                                        class="text-2">Payment
                                                        Date</th>
                                                    <th
                                                        class="text-2">Reference#</th>
                                                    <th
                                                        class="text-2">Amount</th>
                                                    <th
                                                        class="text-2">Pending
                                                        Amount</th>
                                                    <th
                                                        class="text-2">Paid
                                                        Amount</th>
                                                    <th
                                                        class="text-2">Status</th>
                                                    <th
                                                        class="text-2">Full
                                                        Payment</th>
                                                    <th
                                                        class="text-2">Payment</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr
                                                    *ngIf="vendorCredits.length
                                                    === 0"
                                                    class="text-center">
                                                    <td
                                                        colspan="10">{{
                                                        dataMessage
                                                        }} </td>
                                                </tr>
                                                <tr *ngFor="let
                                                    data of
                                                    vendorCredits;
                                                    let
                                                    i=index">
                                                    <td>
                                                        <input
                                                            type="checkbox"
                                                            name="stl{{i}}"
                                                            [(ngModel)]="data.selected"
                                                            (change)="selectedCredits()">
                                                    </td>
                                                    <td>{{
                                                        data.vCrNo
                                                        }}</td>
                                                    <td>{{
                                                        data.txnDate
                                                        |
                                                        date:"yyyy/MM/dd"
                                                        }}</td>
                                                    <td>{{
                                                        data.crRef
                                                        }}</td>
                                                    <td>{{
                                                        data.totalAmt | number :
                                                        '1.2-2'
                                                        }} {{
                                                        data.currency
                                                        }}</td>
                                                    <td>{{
                                                        data.balance | number :
                                                        '1.2-2'
                                                        }} {{
                                                        data.currency
                                                        }}</td>
                                                    <td>{{
                                                        data.prevPaidAmount |
                                                        number : '1.2-2'
                                                        }}</td>
                                                    <td><span
                                                            class="badge
                                                            badge-dark
                                                            p-1
                                                            text-uppercase">{{
                                                            data.newStatus
                                                            }}</span>
                                                    </td>
                                                    <td
                                                        class="text-center">
                                                        <input
                                                            type="checkbox"
                                                            [(ngModel)]="data.fullPayment"
                                                            name="advfinal{{i}}"
                                                            (change)="assignFullPayment(i,
                                                            data)">
                                                    </td>
                                                    <td>
                                                        <input
                                                            type="text"
                                                            class="form-control"
                                                            [(ngModel)]="data.paidAmount"
                                                            (input)="calculateFinalTotal();"
                                                            name="advPaidAmount{{i}}"
                                                            [disabled]="data.paidStatus">
                                                        <label
                                                            id="stlErr{{i}}"
                                                            class="error">{{
                                                            data.errText
                                                            }}</label>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <div class="bg-white p-3 text-dark">
                                <div class="form-group row adddriverpl pt-3">
                                    <div class="col-lg-10">
                                        <label
                                            class="control-label
                                            font-weight-bold font-weight-bold
                                            text-lg-right text-5">Bill
                                            Details</label>
                                    </div>
                                    <div class="col-lg-11">
                                        <div class="row pt-2">
                                            <table class="table table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Commodity<span
                                                                class="mandfield
                                                                text-2 ml-1"><sup>*</sup></span></th>
                                                        <th>Quantity<span
                                                                class="mandfield
                                                                text-2 ml-1"><sup>*</sup></span></th>
                                                        <th>Rate<span
                                                                class="mandfield
                                                                text-2 ml-1"><sup>*</sup></span></th>
                                                        <th>Amount<span
                                                                class="mandfield
                                                                text-2 ml-1"><sup>*</sup></span></th>
                                                        <th>Account<span
                                                                class="mandfield
                                                                text-2 ml-1"><sup>*</sup></span></th>
                                                        <th>Description</th>
                                                        <th
                                                            *ngIf="!productDisabled">Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr
                                                        *ngFor="let detail of
                                                        orderData.detail;
                                                        let idt= index">
                                                        <td>
                                                            <input
                                                                type="text"
                                                                name="comm{{idt}}"
                                                                [(ngModel)]="detail.comm"
                                                                class="form-control"
                                                                placeholder="Enter
                                                                commodity"
                                                                [readonly]="productDisabled"
                                                                />
                                                        </td>

                                                        <td>
                                                            <div class="row">
                                                                <div
                                                                    class="col-lg-6
                                                                    pr-0 mr-2">
                                                                    <input
                                                                        type="text"
                                                                        name="qty{{idt}}"
                                                                        [(ngModel)]="detail.qty"
                                                                        class="form-control"
                                                                        placeholder="Enter
                                                                        quantity"
                                                                        (input)="calcDetailAmount(idt)"
                                                                        pattern="^[1-9]\d*(\.\d+)?$"
                                                                        #qtyy="ngModel"
                                                                        [readonly]="productDisabled"
                                                                        />
                                                                    <div
                                                                        *ngIf="qtyy.invalid
                                                                        &&
                                                                        (qtyy.dirty
                                                                        ||
                                                                        qtyy.touched)"
                                                                        class="text-danger">
                                                                        <div
                                                                            *ngIf="qtyy.errors.required">
                                                                            Quantity
                                                                            is
                                                                            required.
                                                                        </div>
                                                                        <div
                                                                            *ngIf="qtyy.errors.pattern">
                                                                            Please
                                                                            enter
                                                                            valid
                                                                            number
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div
                                                                    class="col-lg-5
                                                                    pl-0">
                                                                    <ng-select
                                                                        [(ngModel)]="detail.qtyTyp"
                                                                        name="quanType{{idt}}"
                                                                        placeholder="Select
                                                                        type"
                                                                        #quanType="ngModel"
                                                                        (change)="setQuanType($event,idt)"
                                                                        [readonly]="productDisabled">
                                                                        <ng-option
                                                                            *ngFor="let
                                                                            qtype
                                                                            of
                                                                            quantityTypes"
                                                                            value="{{
                                                                            qtype.value
                                                                            }}">{{
                                                                            qtype.name
                                                                            }}</ng-option>
                                                                    </ng-select>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="row">
                                                                <div
                                                                    class="col-lg-5
                                                                    pr-0 mr-2">
                                                                    <input
                                                                        type="text"
                                                                        name="rate{{idt}}"
                                                                        [(ngModel)]="detail.rate"
                                                                        class="form-control"
                                                                        placeholder="Enter
                                                                        rate"
                                                                        (input)="calcDetailAmount(idt)"
                                                                        pattern="^[1-9]\d*(\.\d+)?$"
                                                                        #rateQ="ngModel"
                                                                        [readonly]="productDisabled"
                                                                        />

                                                                    <div
                                                                        *ngIf="rateQ.invalid
                                                                        &&
                                                                        (rateQ.dirty
                                                                        ||
                                                                        rateQ.touched)"
                                                                        class="text-danger">
                                                                        <div
                                                                            *ngIf="rateQ.errors.required">
                                                                            Rate
                                                                            is
                                                                            required.
                                                                        </div>
                                                                        <div
                                                                            *ngIf="rateQ.errors.pattern">
                                                                            Please
                                                                            enter
                                                                            valid
                                                                            amount
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div
                                                                    class="col-lg-1
                                                                    pr-0 pl-0">
                                                                    <label>per</label>
                                                                </div>

                                                                <div
                                                                    class="col-lg-5
                                                                    pl-0">
                                                                    <ng-select
                                                                        [(ngModel)]="detail.rateTyp"
                                                                        name="rateTyp{{idt}}"
                                                                        placeholder="Select
                                                                        type"
                                                                        #rateTyp="ngModel"
                                                                        (change)="setQuanType($event,idt)"
                                                                        [readonly]="productDisabled">
                                                                        <ng-option
                                                                            *ngFor="let
                                                                            qtype
                                                                            of
                                                                            quantityTypes"
                                                                            value="{{
                                                                            qtype.value
                                                                            }}">{{
                                                                            qtype.name
                                                                            }}</ng-option>
                                                                    </ng-select>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <input
                                                                type="text"
                                                                name="amount{{
                                                                idt }}"
                                                                [(ngModel)]="detail.amount"
                                                                class="form-control"
                                                                placeholder="Enter
                                                                amount"
                                                                readonly
                                                                />
                                                        </td>
                                                        <td>
                                                            <ng-select
                                                                [(ngModel)]="detail.accountID"
                                                                name="accountID{{idt}}"
                                                                placeholder="Select
                                                                account">
                                                                <ng-option
                                                                    *ngFor="let
                                                                    act of
                                                                    accounts"
                                                                    value="{{
                                                                    act.actID
                                                                    }}">{{
                                                                    act.actNo }}
                                                                    -
                                                                    {{
                                                                    act.actName
                                                                    | titlecase
                                                                    }}
                                                                </ng-option>
                                                            </ng-select>
                                                        </td>
                                                        <td>
                                                            <input
                                                                type="text"
                                                                name="description{{
                                                                idt }}"
                                                                [(ngModel)]="detail.description"
                                                                class="form-control"
                                                                placeholder="Enter
                                                                description"
                                                                />
                                                        </td>
                                                        <td
                                                            *ngIf="!productDisabled">
                                                            <a
                                                                href="javascript:;"
                                                                (click)="delDetail(idt)">
                                                                <i class="fa
                                                                    fa-trash"></i>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <button *ngIf="!productDisabled"
                                            type="button" class="btn
                                            btn-success btn-sm"
                                            (click)="addDetail();"><i class="fas
                                                fa-plus"></i> Add Another Line</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <div class="bg-white p-3 text-dark">
                                <div class="form-group row adddriverpl pt-3">
                                    <div class="col-lg-10">
                                        <div class="row mt-3">
                                            <div class="col-lg-5">
                                                <div class="col-lg-12 pl-0">
                                                    <label
                                                        class="control-label
                                                        font-weight-bold
                                                        text-4 text-dark">Remarks</label>
                                                    <textarea
                                                        class="form-control
                                                        h-auto"
                                                        name="remarks"
                                                        [(ngModel)]="orderData.charges.remarks"
                                                        rows="14"></textarea>
                                                </div>
                                            </div>

                                            <div class="col-lg-5 offset-lg-2">
                                                <h4 class="mt-0 text-dark
                                                    font-weight-bold text-4">
                                                    Charges
                                                </h4>
                                                <div class="row mt-3">
                                                    <div class="col-lg-6">
                                                        <label
                                                            class="control-label
                                                            font-weight-semibold
                                                            text-3 text-dark">Accessorial
                                                            Fee</label>
                                                    </div>
                                                    <div class="col-lg-2"></div>
                                                    <div class="col-lg-4
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-semibold
                                                            text-3 text-dark">Fee
                                                            Total: </label> {{
                                                        orderData.total.feeTotal
                                                        }}
                                                    </div>
                                                </div>

                                                <div
                                                    class="row mt-3"
                                                    *ngFor="let accAdd of
                                                    orderData.charges.accFee;
                                                    let aId= index">
                                                    <div class="col-lg-6">
                                                        <div class="row">
                                                            <div
                                                                class="col-lg-10
                                                                pr-0">
                                                                <input
                                                                    type="text"
                                                                    name="addCH{{
                                                                    aId }}"
                                                                    [(ngModel)]="accAdd.name"
                                                                    class="form-control"
                                                                    placeholder="Enter
                                                                    name"
                                                                    />
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-3">
                                                        <div class="row">
                                                            <div
                                                                class="col-lg-12
                                                                pr-0">
                                                                <input
                                                                    type="text"
                                                                    name="addamount{{
                                                                    aId }}"
                                                                    [(ngModel)]="accAdd.amount"
                                                                    class="form-control"
                                                                    placeholder="Enter
                                                                    amount"
                                                                    (input)="accessorialFeeTotal()"
                                                                    pattern="^[0-9]\d*(\.\d+)?$"
                                                                    #accFeeam="ngModel"
                                                                    />

                                                                <div
                                                                    *ngIf="accFeeam.errors?.pattern">
                                                                    Please enter
                                                                    valid amount
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-3
                                                        text-right">
                                                        <button *ngIf="aId ===
                                                            0" type="button"
                                                            (click)="addAccessorialArr('fee')"
                                                            class="btn
                                                            btn-success
                                                            btn-sm">
                                                            <i class="fas
                                                                fa-plus"></i>
                                                        </button>
                                                        <button *ngIf="aId> 0"
                                                            type="button"
                                                            (click)="dedAccessorialArr('fee',
                                                            aId)" class="btn
                                                            btn-danger
                                                            btn-sm">
                                                            <i class="fas
                                                                fa-minus"></i>
                                                        </button>
                                                    </div>
                                                </div>

                                                <div
                                                    class="row mt-3">
                                                    <div class="col-lg-6">
                                                        <label
                                                            class="control-label
                                                            font-weight-semibold
                                                            text-3 text-dark">Accessorial
                                                            Deduction</label>
                                                    </div>
                                                    <div class="col-lg-2"></div>
                                                    <div class="col-lg-4
                                                        text-right">
                                                        <label
                                                            class="control-label
                                                            font-weight-semibold
                                                            text-3 text-dark">Deduction
                                                            Total: </label> {{
                                                        orderData.total.dedTotal
                                                        }}
                                                    </div>
                                                </div>

                                                <div
                                                    class="row mt-3"
                                                    *ngFor="let accDed of
                                                    orderData.charges.accDed;
                                                    let bId= index">
                                                    <div class="col-lg-6">
                                                        <div class="row">
                                                            <div
                                                                class="col-lg-10
                                                                pr-0">
                                                                <input
                                                                    type="text"
                                                                    name="dedCH{{
                                                                    bId }}"
                                                                    [(ngModel)]="accDed.name"
                                                                    class="form-control"
                                                                    placeholder="Enter
                                                                    name"
                                                                    />
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-3">
                                                        <div class="row">
                                                            <div
                                                                class="col-lg-12
                                                                pr-0">
                                                                <input
                                                                    type="text"
                                                                    name="dedamount{{
                                                                    bId }}"
                                                                    [(ngModel)]="accDed.amount"
                                                                    class="form-control"
                                                                    placeholder="Enter
                                                                    amount"
                                                                    (input)="accessorialDedTotal()"
                                                                    #dedam="ngModel"
                                                                    pattern="^[0-9]\d*(\.\d+)?$"
                                                                    />

                                                                <div
                                                                    *ngIf="dedam.errors?.pattern">
                                                                    Please enter
                                                                    valid amount
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-3
                                                        text-right"
                                                        *ngIf="!productDisabled">
                                                        <button *ngIf="bId ===
                                                            0" type="button"
                                                            (click)="addAccessorialArr('ded')"
                                                            class="btn
                                                            btn-success
                                                            btn-sm">
                                                            <i class="fas
                                                                fa-plus"></i>
                                                        </button>
                                                        <button *ngIf="bId> 0"
                                                            type="button"
                                                            (click)="dedAccessorialArr('ded',
                                                            bId)" class="btn
                                                            btn-danger
                                                            btn-sm">
                                                            <i class="fas
                                                                fa-minus"></i>
                                                        </button>
                                                    </div>
                                                </div>

                                                <div class="row mt-3">
                                                    <div class="col-lg-12 pl-3
                                                        mb-2">
                                                        <div
                                                            class="checkbox-custom
                                                            checkbox-default">
                                                            <input
                                                                type="checkbox"
                                                                id="ZeroRated"
                                                                name="exempt"
                                                                [(ngModel)]="orderData.exempt"
                                                                (change)="taxExempt()"
                                                                />
                                                            <label
                                                                class="control-label
                                                                font-weight-semibold
                                                                labelmt
                                                                text-3
                                                                text-dark"
                                                                for="ZeroRated">Tax
                                                                Exempt</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-12">
                                                        <label
                                                            class="control-label
                                                            font-weight-bold
                                                            text-3 text-dark"
                                                            for="inputDefault">Province/State</label>
                                                    </div>
                                                    <div class="col-lg-9"
                                                        *ngIf="!orderData.exempt">
                                                        <ng-select
                                                            class="form-control
                                                            populate"
                                                            name="stateID"
                                                            [(ngModel)]="orderData.stateID"
                                                            placeholder="Select
                                                            state"
                                                            (change)="selecteProvince($event)">
                                                            <ng-option
                                                                *ngFor="let data
                                                                of stateTaxes"
                                                                value="{{
                                                                data.stateTaxID
                                                                }}">{{
                                                                data.stateName
                                                                }}</ng-option>
                                                        </ng-select>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-lg-8"
                                                        *ngIf="orderData.exempt">
                                                    </div>
                                                    <div class="col-lg-8"
                                                        *ngIf="!orderData.exempt">
                                                        <!-- GST -->
                                                        <div class="row mt-3"
                                                            *ngFor="let taxD of
                                                            orderData.charges.taxes;
                                                            let td= index;">
                                                            <div class="col-lg-5
                                                                pr-0">
                                                                <input
                                                                    type="text"
                                                                    disabled
                                                                    class="form-control"
                                                                    [(ngModel)]="taxD.name"
                                                                    name="taxName{{td}}"
                                                                    />
                                                            </div>

                                                            <div class="col-lg-5
                                                                pr-0
                                                                input-group">
                                                                <input
                                                                    type="text"
                                                                    [(ngModel)]="taxD.tax"
                                                                    name="taxper{{td}}"
                                                                    class="form-control"
                                                                    (input)="taxcalculation(td)"
                                                                    /><span
                                                                    class="input-group-append"><span
                                                                        class="input-group-text
                                                                        pt-0
                                                                        pb-0">%</span></span>
                                                            </div>
                                                        </div>

                                                    </div>

                                                    <div class="col-lg-4">
                                                        <div
                                                            *ngIf="!orderData.exempt">
                                                            <div class="row
                                                                mt-3"
                                                                *ngFor="let taxD
                                                                of
                                                                orderData.charges.taxes;
                                                                let td= index;">
                                                                <div
                                                                    class="col-lg-12
                                                                    bordtop
                                                                    pt-1">
                                                                    <p
                                                                        class="text-right">{{
                                                                        taxD.amount
                                                                        | number
                                                                        :
                                                                        '1.2-2'}}</p>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="row mt-3">
                                                            <div
                                                                class="col-lg-9
                                                                bordtop
                                                                pt-1">
                                                                <h5
                                                                    class="text-right
                                                                    font-weight-semibold
                                                                    text-4
                                                                    text-dark">
                                                                    Sub Total
                                                                </h5>
                                                            </div>
                                                            <div
                                                                class="col-lg-3
                                                                bordtop
                                                                pt-1">
                                                                <p
                                                                    class="text-right">{{
                                                                    orderData.total.subTotal
                                                                    | number :
                                                                    '1.2-2' }}</p>
                                                            </div>
                                                        </div>
                                                        <div class="row mt-3">
                                                            <div
                                                                class="col-lg-9
                                                                bordtop
                                                                pt-1">
                                                                <h5
                                                                    class="text-right
                                                                    font-weight-semibold
                                                                    text-4
                                                                    text-dark">
                                                                    Vendor
                                                                    Credit
                                                                </h5>
                                                            </div>
                                                            <div
                                                                class="col-lg-3
                                                                bordtop
                                                                pt-1">
                                                                <p
                                                                    class="text-right">{{
                                                                    orderData.total.vendorCredit
                                                                    | number :
                                                                    '1.2-2' }}</p>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-lg-9
                                                                bordtop pt-1">
                                                                <h5
                                                                    class="text-right
                                                                    font-weight-semibold
                                                                    text-4
                                                                    text-dark">
                                                                    Total Amount
                                                                </h5>
                                                            </div>
                                                            <div class="col-lg-3
                                                                bordtop pt-1">
                                                                <p
                                                                    class="text-right">{{
                                                                    orderData.total.finalTotal
                                                                    | number :
                                                                    '1.2-2'}}</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group row mt-4">
                                    <div class="col-lg-11 pr-5 text-right">
                                        <button type="button" class="btn
                                            btn-default mr-2">
                                            Cancel
                                        </button>
                                        <button type="submit" *ngIf="!billID"
                                            (click)="addRecord();"
                                            [disabled]="!purchaseForm.form.valid
                                            || submitDisabled"
                                            class="btn
                                            btn-success mr-2">Save</button>
                                        <button type="submit" *ngIf="billID"
                                            (click)="updateRecord();"
                                            [disabled]="!purchaseForm.form.valid
                                            || submitDisabled"
                                            class="btn
                                            btn-success mr-2">Update</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </section>
        </section>
    </div>
</section>