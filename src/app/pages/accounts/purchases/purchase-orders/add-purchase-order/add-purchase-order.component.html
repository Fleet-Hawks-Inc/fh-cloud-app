<section class="body">
  <div class="inner-wrapper">
    <section role="main" class="content-body pl-0 pr-0 pt-0">
      <header class="page-header">
        <div class="row" style="padding-top: 10px">
          <div class="col-md-4 col-lg-4 font-weight-bold text-4 text-dark">
            Add Purchase Order
          </div>
          <div class="col-md-8 col-lg-8 text-right pr-3">
            <a
              routerLink="/accounts/purchases/orders/list"
              class="btn btn-default btn-sm"><i class="fas fa-list"></i> All
              Purchase Orders</a>
          </div>
        </div>
      </header>

      <section class="m-2">
        <form class="form-horizontal form-bordered" method="get">
          <div class="row mb-3">
            <div class="col-lg-12">
              <div class="bg-white p-3 text-dark">
                <div class="form-group row adddriverpl pt-3">
                  <div class="col-lg-5 mb-3">
                    <div class="row">
                      <div class="col-lg-10">
                        <label
                          class="control-label
                          font-weight-bold font-bold
                          text-lg-right
                          pt-2">Purchase Order Date</label>
                        <input
                          [(ngModel)]="orderData.txnDate"
                          name="txnDate"
                          type="text"
                          placeholder="yyyy/mm/dd"
                          (click)="custexp.toggle()"
                          ngbDatepicker
                          #custexp="ngbDatepicker"
                          class="form-control"
                          autocomplete="off"
                          [minDate]="dateMinLimit"
                          [maxDate]="futureDatesLimit"
                          #jDate="ngModel"
                          required
                          />
                      </div>
                    </div>
                    <div class="row pt-2">
                      <div class="col-lg-10">
                        <label
                          class="control-label
                          font-weight-bold font-bold
                          text-lg-right
                          pt-2">Vendor</label>
                        <ng-select
                          [(ngModel)]="orderData.vendorID"
                          name="vendorID"
                          placeholder="Select Vendor">
                          <ng-option value="{{ data.contactID }}" *ngFor="let
                            data of vendors">{{ data.companyName }}</ng-option>
                        </ng-select>
                      </div>
                      <div class="col-lg-2 mar-top-37">
                        <a
                          href="#addVendorModal"
                          class="btn btn-sm btn-success modal-with-form"><i
                            class="fas fa-plus"></i></a>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-5 offset-lg-1 mb-3">
                    <div class="row">
                      <div class="col-lg-10">
                        <label
                          class="control-label
                          font-weight-bold font-bold
                          text-lg-right
                          pt-2">
                          Reference#</label>
                        <input
                          type="text"
                          name="orderNo"
                          [(ngModel)]="orderData.orderNo"
                          class="form-control"
                          placeholder="Enter Reference#"
                          />
                      </div>
                    </div>
                    <div class="row pt-2">
                      <div class="col-lg-10">
                        <label
                          class="control-label
                          font-weight-bold font-bold
                          text-lg-right
                          pt-2">Payment Currency</label>
                        <ng-select
                          [(ngModel)]="orderData.currency"
                          name="currency"
                          placeholder="Select currency"
                          #curr="ngModel"
                          required>
                          <ng-option value="CAD">CAD</ng-option>
                          <ng-option value="USD">USD</ng-option>
                        </ng-select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-lg-12">
              <div class="bg-white p-3 text-dark">
                <div class="form-group row adddriverpl pt-3">
                  <div class="col-lg-10">
                    <label
                      class="control-label
                      font-weight-bold font-weight-bold
                      text-lg-right text-5">Purchase Order Details</label>
                  </div>
                  <div class="col-lg-10">
                    <div class="row pt-2">
                      <table class="table table-bordered">
                        <thead>
                          <tr>
                            <th>Commodity</th>
                            <th>Quantity</th>
                            <th>Rate</th>
                            <th>Amount</th>
                            <th>Action</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr
                            *ngFor="let detail of orderData.dtail;
                            let idt= index">
                            <td>
                              <input
                                type="text"
                                name="comm{{ idt }}"
                                [(ngModel)]="detail.comm"
                                class="form-control"
                                placeholder="Enter commodity"
                                />
                            </td>

                            <td>
                              <div class="row">
                                <div class="col-lg-6 pr-0 mr-2">
                                  <input
                                    type="text"
                                    name="qty{{ idt }}"
                                    [(ngModel)]="detail.qty"
                                    class="form-control"
                                    placeholder="Enter quantity"
                                    />
                                </div>
                                <div class="col-lg-5 pl-0">
                                  <ng-select
                                    [(ngModel)]="detail.qtyTyp"
                                    name="quanType"
                                    placeholder="Select type"
                                    #quanType="ngModel">
                                    <ng-option
                                      *ngFor="let qtype of quantityTypes"
                                      value="{{ qtype.value }}">{{ qtype.name }}</ng-option>
                                  </ng-select>
                                </div>
                              </div>
                            </td>
                            <td>
                              <div class="row">
                                <div class="col-lg-6 pr-0 mr-2">
                                  <input
                                    type="text"
                                    name="rate{{ idt }}"
                                    [(ngModel)]="detail.rate"
                                    class="form-control"
                                    placeholder="Enter rate"
                                    />
                                </div>
                                <div class="col-lg-5 pl-0">
                                  <ng-select
                                    [(ngModel)]="detail.rateTyp"
                                    name="rateTyp"
                                    placeholder="Select type"
                                    #rateTyp="ngModel">
                                    <ng-option
                                      *ngFor="let qtype of quantityTypes"
                                      value="{{ qtype.value }}">{{ qtype.name }}</ng-option>
                                  </ng-select>
                                </div>
                              </div>
                            </td>
                            <td>
                              <input
                                type="text"
                                name="amount{{ idt }}"
                                [(ngModel)]="detail.amount"
                                class="form-control"
                                placeholder="Enter amount"
                                />
                            </td>
                            <td>
                              <a href="javascript:;" (click)="delDetail(idt)">
                                <i class="fa fa-trash"></i>
                              </a>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <button type="button" class="btn btn-success btn-sm"
                      (click)="addDetail();"><i class="fas
                        fa-plus"></i> Add Another Line</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-lg-12">
              <div class="bg-white p-3 text-dark">
                <div class="form-group row adddriverpl pt-3">
                  <div class="col-lg-10">
                    <div class="row mt-3">
                      <div class="col-lg-5">
                        <div class="col-lg-12 pl-0">
                          <label
                            class="control-label
                            font-weight-bold
                            text-4 text-dark">Remarks</label>
                          <textarea
                            class="form-control h-auto"
                            name="remarks"
                            [(ngModel)]="orderData.charges.remarks"
                            rows="14"></textarea>
                        </div>
                      </div>

                      <div class="col-lg-5 offset-lg-2">
                        <h4 class="mt-0 text-dark font-weight-bold text-4">
                          Charges
                        </h4>
                        <div class="row mt-3">
                          <div class="col-lg-6">
                            <label
                              class="control-label
                              font-weight-semibold
                              text-3 text-dark">Accessorial Fee</label>
                          </div>
                          <div class="col-lg-2"></div>
                          <div class="col-lg-4 text-right">
                            <label
                              class="control-label
                              font-weight-semibold
                              text-3 text-dark">Fee Total: </label> {{
                            orderData.total.feeTotal }}
                          </div>
                        </div>

                        <div
                          class="row mt-3"
                          *ngFor="let accAdd of orderData.charges.accFee;
                          let aId= index">
                          <div class="col-lg-6">
                            <div class="row">
                              <div class="col-lg-10 pr-0">
                                <input
                                  type="text"
                                  name="addCH{{ aId }}"
                                  [(ngModel)]="accAdd.name"
                                  class="form-control"
                                  placeholder="Enter name"
                                  />
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-3">
                            <div class="row">
                              <div class="col-lg-12 pr-0">
                                <input
                                  type="text"
                                  name="addamount{{ aId }}"
                                  [(ngModel)]="accAdd.amount"
                                  class="form-control"
                                  placeholder="Enter amount"
                                  />
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-3 text-right">
                            <button *ngIf="aId === 0" type="button"
                              (click)="addAccessorialArr('fee')" class="btn
                              btn-success
                              btn-sm">
                              <i class="fas fa-plus"></i>
                            </button>
                            <button *ngIf="aId> 0" type="button"
                              (click)="dedAccessorialArr('fee', aId)" class="btn
                              btn-danger
                              btn-sm">
                              <i class="fas fa-minus"></i>
                            </button>
                          </div>
                        </div>

                        <div
                          class="row mt-3">
                          <div class="col-lg-6">
                            <label
                              class="control-label
                              font-weight-semibold
                              text-3 text-dark">Accessorial Deduction</label>
                          </div>
                          <div class="col-lg-2"></div>
                          <div class="col-lg-4 text-right">
                            <label
                              class="control-label
                              font-weight-semibold
                              text-3 text-dark">Deduction Total: </label> {{
                            orderData.total.dedTotal }}
                          </div>
                        </div>

                        <div
                          class="row mt-3"
                          *ngFor="let accDed of orderData.charges.accDed;
                          let bId= index">
                          <div class="col-lg-6">
                            <div class="row">
                              <div class="col-lg-10 pr-0">
                                <input
                                  type="text"
                                  name="dedCH{{ bId }}"
                                  [(ngModel)]="accDed.name"
                                  class="form-control"
                                  placeholder="Enter name"
                                  />
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-3">
                            <div class="row">
                              <div class="col-lg-12 pr-0">
                                <input
                                  type="text"
                                  name="dedamount{{ bId }}"
                                  [(ngModel)]="accDed.amount"
                                  class="form-control"
                                  placeholder="Enter amount"
                                  />
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-3 text-right">
                            <button *ngIf="bId === 0" type="button"
                              (click)="addAccessorialArr('ded')" class="btn
                              btn-success
                              btn-sm">
                              <i class="fas fa-plus"></i>
                            </button>
                            <button *ngIf="bId> 0" type="button"
                              (click)="dedAccessorialArr('ded', bId)" class="btn
                              btn-danger
                              btn-sm">
                              <i class="fas fa-minus"></i>
                            </button>
                          </div>
                        </div>

                        <div class="row mt-3">
                          <div class="col-lg-12 pl-3 mb-2">
                            <div class="checkbox-custom checkbox-default">
                              <input type="checkbox" id="ZeroRated" />
                              <label
                                class="control-label
                                font-weight-semibold
                                labelmt
                                text-3 text-dark" for="ZeroRated">Tax Exempt</label>
                            </div>
                          </div>
                          <div class="col-lg-12">
                            <label
                              class="control-label
                              font-weight-bold
                              text-3 text-dark" for="inputDefault">Province/State</label>
                          </div>
                          <div class="col-lg-9">
                            <ng-select class="form-control populate">
                              <ng-option selected value="">state tax</ng-option>
                            </ng-select>
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-lg-8">
                            <!-- GST -->
                            <div class="row mt-3" *ngFor="let taxD of
                              orderData.charges.taxes; let td= index;">
                              <div class="col-lg-5 pr-0">
                                <input
                                  type="text"
                                  disabled
                                  class="form-control"
                                  [(ngModel)]="taxD.name"
                                  name="taxName{{td}}"
                                  />
                              </div>

                              <div class="col-lg-5 pr-0 input-group">
                                <input
                                  type="text"
                                  [(ngModel)]="taxD.tax"
                                  name="taxper{{td}}"
                                  class="form-control"
                                  /><span class="input-group-append"><span
                                    class="input-group-text pt-0 pb-0">%</span></span>
                              </div>
                            </div>

                          </div>
                          <div class="col-lg-4">
                            <div class="row mt-3" *ngFor="let taxD of
                              orderData.charges.taxes; let td= index;">
                              <div class="col-lg-12 bordtop pt-1">
                                <p class="text-right">{{ taxD.amount }}</p>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-lg-9 bordtop pt-1">
                                <h5
                                  class="text-right
                                  font-weight-semibold
                                  text-4 text-dark">
                                  Total Amount
                                </h5>
                              </div>
                              <div class="col-lg-3 bordtop pt-1">
                                <p class="text-right">0.00</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="form-group row mt-4">
                  <div class="col-lg-11 pr-5 text-right">
                    <button type="button" class="btn btn-default mr-2">
                      Cancel
                    </button>
                    <a href="javascript:;" (click)="addRecord();" class="btn
                      btn-success">Save</a>
                    <a
                      href="javascript:;"
                      class="modal-with-form btn btn-success ml-2">Save & Send</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </form>
      </section>
    </section>
  </div>
</section>