<section class="body">
   <div class="inner-wrapper">
      <section role="main" class="content-body pl-1 pr-0 pt-0">
         <header class="page-header pr19 pl11">
            <div class="row" style="padding-top:10px;">
               <div class="col-md-4 col-lg-4 font-weight-bold text-4 text-dark">
                  Service Log Details
               </div>
               <div class="col-md-8 col-lg-8 text-right pr-1">
                  <button class="btn btn-sm btn-success mr-3" (click)="openModal()">
                     Log PDF
                  </button>
                  <!-- <a (click)="openModal()" class="btn btn-sm btn-default"><i class="fas fa-list"></i> Log PDF</a> -->
                  <a routerLink="/fleet/maintenance/service-log/list" class="btn btn-sm btn-default"><i
                        class="fas fa-list"></i> Service Logs List</a>
               </div>
            </div>
         </header>

         <section class="m-2">
            <div class="row mb-3">
               <div class="col-lg-12">
                  <div class="bg-white pr-3 pl-3 text-dark">
                     <div class="form-group row">
                        <div class="col-lg-12">
                           <div class="row cmaindiv">
                              <div class="col-md-2 col-lg-2">
                                 <div class="text-center p-4 cerbor">
                                    <p class="mb-0">UNIT TYPE</p>
                                    <p class="mb-0 text-5 font-weight-bold text-dark text-capitalize">{{
                                       logsData.unitType }}</p>
                                 </div>
                              </div>

                              <div class="col-md-2 col-lg-2">
                                 <div class="text-center p-4 cerbor" *ngIf="logsData.unitType != 'asset'">
                                    <p class="mb-0">VEHICLE</p>
                                    <p class="mb-0 text-5 font-weight-bold text-dark">{{vehiclesObject[vehicle]}}</p>
                                 </div>

                                 <div class="text-center p-4 cerbor" *ngIf="logsData.unitType == 'asset'">
                                    <p class="mb-0">ASSET</p>
                                    <p class="mb-0 text-5 font-weight-bold text-dark">{{assetsObject[assetID]}}</p>
                                 </div>
                              </div>

                              <div class="col-md-2 col-lg-2" *ngIf="logsData.unitType != 'asset'">
                                 <div class="text-center p-4 cerbor">
                                    <p class="mb-0">ODOMETER IN MILES</p>
                                    <p class="mb-0 text-5 font-weight-bold text-dark">{{odometer ? odometer : '-'}}</p>
                                 </div>
                              </div>


                              <div class="col-md-2 col-lg-2">
                                 <div class="text-center p-4 cerbor">
                                    <p class="mb-0">COMPLETION DATE</p>
                                    <p class="mb-0 text-5 font-weight-bold text-dark">{{completionDate ? (completionDate
                                       |
                                       date:'yyyy/MM/dd') : '-'}}</p>
                                 </div>
                              </div>

                              <div class="col-md-2 col-lg-2">
                                 <div class="text-center p-4 cerbor">
                                    <p class="mb-0">BILL#</p>
                                    <p class="mb-0 text-5 font-weight-bold text-dark">{{reference ? reference : '-'}}
                                    </p>
                                 </div>
                              </div>

                              <div class="col-md-2 col-lg-2">
                                 <div class="text-center p-4">
                                    <p class="mb-0">VENDOR</p>
                                    <p class="mb-0 text-5 font-weight-bold text-dark">{{vendorID ?
                                       vendorsObject[vendorID] :
                                       '-'}}</p>
                                 </div>
                              </div>

                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <div class="row mb-3">
               <div class="col-lg-12">
                  <div class="bg-white p-3 text-dark">
                     <div class="form-group row pt-1">
                        <div class="col-lg-12">
                           <label
                              class="control-label font-weight-bold font-bold text-lg-right text-dark text-4 font-weight-bold pt-2">Issue
                              Details</label>
                        </div>
                        <div class="col-lg-12">

                           <div class="row mt-2">
                              <div class="col-lg-12">
                                 <table class="table table-bordered table-striped table-responsive-lg">
                                    <thead>
                                       <tr>
                                          <th width="80%">Issue</th>
                                          <th width="20%">Assigned To</th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                       <tr *ngIf="issuesObject.length == 0">
                                          <td colspan="2">{{noRecordMessage}}</td>
                                       </tr>
                                       <tr *ngFor="let data of issuesObject">
                                          <td>{{ data.issueName }}</td>
                                          <td>{{ users[data.assignedTo] }}</td>
                                       </tr>
                                    </tbody>
                                 </table>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <div class="row mb-3">
               <div class="col-lg-12">
                  <div class="bg-white p-3 text-dark">
                     <div class="form-group row pt-1">
                        <div class="col-lg-12">
                           <label
                              class="control-label font-weight-bold font-bold text-lg-right text-dark text-4 font-weight-bold pt-2">Service
                              Tasks</label>
                        </div>
                        <div class="col-lg-12">

                           <div class="row mt-2">
                              <div class="col-lg-12">
                                 <table class="table table-bordered table-striped table-responsive-lg">
                                    <thead>
                                       <tr>
                                          <th width="80%">Task</th>
                                          <th width="20%">Labor</th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                       <tr *ngIf="allServiceTasks?.length == 0">
                                          <td colspan="2">{{noRecordMessage}}</td>
                                       </tr>
                                       <tr *ngFor="let item of allServiceTasks;">
                                          <td>{{item.taskName}}</td>
                                          <td> {{item.laborCost}} {{currency}}</td>
                                       </tr>
                                    </tbody>
                                 </table>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <div class="row mb-3">
               <div class="col-lg-12">
                  <div class="bg-white p-3 text-dark">
                     <div class="form-group row pt-1">
                        <div class="col-lg-12">
                           <label
                              class="control-label font-weight-bold font-bold text-lg-right text-dark text-4 font-weight-bold pt-2">Service
                              Parts</label>
                        </div>
                        <div class="col-lg-12">

                           <div class="row mt-2">
                              <div class="col-lg-12">
                                 <table class="table table-bordered table-striped table-responsive-lg">
                                    <thead>
                                       <tr>
                                          <th width="20%">Items</th>
                                          <th width="50%">Description</th>
                                          <th width="10%">Quantity</th>
                                          <th width="10%">Rate</th>
                                          <th width="10%">Amount</th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                       <tr *ngIf="allServiceParts?.length == 0">
                                          <td colspan="5">{{noRecordMessage}}</td>
                                       </tr>
                                       <tr *ngFor="let item of allServiceParts;">
                                          <td>{{item.partNumber}}</td>
                                          <td>{{item.description}}</td>
                                          <td>{{item.quantity}}</td>
                                          <td> {{item.rate}} {{currency}}</td>
                                          <td>{{item.partCost}} {{currency}}</td>
                                       </tr>
                                    </tbody>
                                 </table>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <div class="row mb-3">
               <div class="col-lg-12">
                  <div class="bg-white p-3 text-dark">
                     <div class="form-group row pt-1">
                        <div class="col-lg-12">
                           <label
                              class="control-label font-weight-bold font-bold text-lg-right text-dark text-4 font-weight-bold pt-2">Description</label>
                           <p>
                              {{description ? description : '-'}}
                           </p>
                        </div>
                        <div class="col-lg-4" *ngIf="logImages?.length > 0">
                           <label
                              class="control-label font-weight-bold font-bold text-lg-right text-dark text-4 font-weight-bold pt-2">Photos</label>
                           <div class="row">
                              <div class="col-lg-6 mb-2" *ngFor="let item of logImages; let i=index;">
                                 <div class="vehicle-photo-box">
                                    <img [src]="item.path" width="100%" class="img-fluid"
                                       style="height: 180px; object-fit: cover;">
                                    <!-- <iframe [src]="item" width="100px" height="100px" frameborder="0"></iframe> -->
                                    <hr class="m-3">
                                    <div class="row">
                                       <div class="col-lg-8"> Image {{i+1}}</div>
                                       <div class="col-lg-4 text-right">
                                          <a href="javascript:;" (click)="delete('image',item.name, i)"
                                             class="modal-with-form">
                                             <i class="fas fa-times text-danger"
                                                (click)="delete('image',item.name, i)"></i>
                                          </a>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="col-lg-4" *ngIf="logDocs?.length > 0">
                           <label
                              class="control-label font-weight-bold font-bold text-lg-right text-dark text-4 font-weight-bold pt-2">Documents</label>
                           <div class="row" *ngFor="let doc of logDocs;let d= index">
                              <div class="col-lg-9"><a href="javascript:;" href="{{ doc.path }}" data-toggle="modal"
                                    data-target="#viewDocModal" (click)="setPDFSrc(doc.path)">Document {{d+1}}</a>
                              </div>
                              <div class="col-lg-3 text-right">
                                 <em class="far fa-file text-dak mr-1" (click)="setPDFSrc(doc.path)" data-toggle="modal"
                                    data-target="#viewDocModal"></em>
                                 <a href="javascript:;" (click)="delete('doc',doc.name, d)" class="modal-with-form">
                                    <em class="fas fa-times text-danger"></em></a>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>


         </section>


      </section>
   </div>
</section>

<!-- VIEW DOCUMENT MODAL -->
<div class="modal fade" id="viewDocModal" tabindex="-1" role="dialog" aria-labelledby="viewDocModalLabel"
   aria-hidden="true">
   <div class="modal-dialog" role="document">
      <div class="modal-content">
         <div class="modal-header">
            <h5 class="modal-title" id="viewDocModalLabel">View Document</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
               <span aria-hidden="true">&times;</span>
            </button>
         </div>
         <div class="modal-body">
            <div class="form-row">
               <div class="form-group col-md-12">
                  <div>
                     <iframe [src]="pdfSrc" title="" width="100%" height="400px"> </iframe>

                  </div>
               </div>
            </div>

         </div>
         <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
         </div>
      </div>
   </div>
</div>

<ng-template #logModal let-modal>
   <div class="modal-body" id="log_wrap">

      <section class="cheque-wrapper" id="log_wrap">
         <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
            <tbody>
               <tr>
                  <td width="50%">
                     <h2 class="text-dark" id="modal-basic-title " style="font-size:26px; margin-bottom: 5px;">
                        Service Log Details
                     </h2>

                  </td>
                  <td width="50%" align="right" style="padding-bottom: 1em; "> <img crossorigin="anonymous" *ngIf="companyLogo" [src]="companyLogo"
                        alt="logo" style="max-width: 100px;">
                  </td>
               </tr>
            </tbody>
         </table>

         <table width="100%" class="table-bordered" style="color: #000000; font-size: 13px; margin-bottom: 10px;
         " cellpadding="0" cellspacing="0">
            <tbody>
               <tr>

                  <td style=" width: 65%;
                        padding-left: 10px; padding-right: 150px;">
                     <p style="font-weight: 600; margin-bottom: 4px; padding: 4px; ">
                        <span style="font-weight: 500; color: #000000; ">Unit Type:- </span> {{
                        logsData.unitType
                        }}
                     </p>
                     <p style="font-weight: 600; margin-bottom: 4px;  padding: 4px;">
                        <span *ngIf="logsData.unitType != 'asset'" style=" font-weight: 500; color: #000000; ">Vehicle:-
                        </span> {{vehiclesObject[vehicle]}}
                     </p>
                     <p *ngIf="logsData.unitType != 'asset'"
                        style=" font-weight: 600; margin-bottom: 4px; padding: 4px;">
                        <span style="font-weight: 500; color: #000000; ">Odometer Miles:- </span> {{odometer ?
                        odometer
                        :
                        '-'}}
                     </p>
                     <p style=" font-weight: 600; margin-bottom: 4px; padding: 4px;">
                        <span *ngIf="logsData.unitType == 'asset'" style=" font-weight: 500; color: #000000; ">Asset:-
                        </span> {{assetsObject[assetID]}}
                     </p>
                  </td>

                  <td style="width: 45%;
                     padding-left: 10px; padding-right: 15px;">
                     <p style="font-weight: 600; margin-bottom: 4px; padding: 4px; ">
                        <span style="font-weight: 500; color: #000000; ">Completion Date:- </span> {{completionDate ?
                        (completionDate
                        |
                        date:'yyyy/MM/dd') : '-'}}
                     </p>
                     <p style="font-weight: 600; margin-bottom: 4px;  padding: 4px;">
                        <span style="font-weight: 500; color: #000000; ">BIll#:- </span> {{reference ?
                        reference : '-'}}
                     </p>
                     <p style="font-weight: 600; margin-bottom: 4px; padding: 4px;">
                        <span style="font-weight: 500; color: #000000; ">Vendor:- </span> {{vendorID ?
                        vendorsObject[vendorID] :
                        '-'}}
                     </p>
                  </td>

               </tr>
            </tbody>
         </table>


         <h5 style="color:#231F20;"><b>Issue Details</b></h5>
         <table width="100%" style="color: #000000;
                  font-size: 13px; margin-bottom: 10px;border: 1px solid #999999;
                  ">
            <thead>
               <tr>
                  <td width="75%" style="font-size: 13px;
                            background-color: 	#E8E8E8;
                            border: 1px solid #999999;
                            padding-left: 10px;  padding-right: 10px; 
                            padding-top: 10p; padding-bottom: 10px">
                     Issue:
                  </td>
                  <td width="25%" style="font-size: 13px;
                            background-color: 	#E8E8E8;
                            border: 1px solid #999999;
                           padding-left: 10px;  padding-right: 10px;
                           padding-bottom: 10px;  padding-top: 10px
                           ">
                     Assigned To
                  </td>
               </tr>
            </thead>
            <tbody>
               <tr *ngIf="issuesObject?.length == 0">
                  <td colspan="" style="padding-top: 10px; padding-bottom: 10px;  text-align: center">
                     {{noRecordMessage}}</td>
               </tr>

               <tr *ngFor='let data of issuesObject'>

                  <td width="75%" style="font-size: 13px;
                  border-right: 1px solid #999999;
                           padding-right: 10px; padding-left: 10px;
                           padding-top: 10px; padding-bottom: 10px;
                        ">

                     {{data.issueName}}
                  </td>
                  <td width="25%" style="font-size: 13px;
                              padding-left: 10px;
                           padding-top: 10px; padding-bottom: 10px;
                           border-right: 1px solid #999999;
                        ">
                     {{users[data.assignedTo]}}</td>
               </tr>
         </table>


         <h5 style="color:#231F20;"><b>Service Tasks</b></h5>
         <table width="100%" style="color: #000000;border: 1px solid #999999; font-size: 13px; margin-bottom: 10px;">
            <thead>
               <tr>
                  <td width="75%" style="font-size: 13px;
                         background-color: 	#E8E8E8;
                         border: 1px solid #999999;
                         padding-left: 10px;  padding-right: 10px;
                           padding-bottom: 10px;  padding-top: 10px">
                     Task
                  </td>
                  <td width="25%" style="font-size: 13px;
                        background-color:#E8E8E8;
                        border: 1px solid #999999;
                        padding-left: 10px;  padding-right: 10px;
                        padding-bottom: 10px;  padding-top: 10px
                        ">
                     Labor
                  </td>
               </tr>
            </thead>
            <tbody>


               <tr *ngIf="allServiceTasks?.length == 0">
                  <td colspan="" style="padding-top: 10px; padding-bottom: 10px; " align="center">
                     {{noRecordMessage}}</td>
               </tr>
               <tr *ngFor='let data of allServiceTasks'>
                  <td height="25" style="font-size: 13px;border-right: 1px solid #999999;
                           padding-left: 10px;
                        ">
                     {{data.taskName}}
                  </td>
                  <td style="font-size: 13px;
                           
                           padding-left: 10px; padding-right: 10px;
                        "> {{data.laborCost}} {{currency}}</td>
               </tr>
         </table>

         <h5 style="color:#231F20;"><b>Service Part</b></h5>

         <table width="100%" style="color: #000000;border: 1px solid #999999; font-size: 13px; margin-bottom: 10px;">
            <thead>
               <tr>
                  <td width="75%" style="font-size: 13px;
                         background-color: 	#E8E8E8;
                         border: 1px solid #999999;
                        padding-left: 10px;  padding-right: 10px;">
                     Task
                  </td>
                  <td width="25%" style="font-size: 13px;
                        background-color:#E8E8E8;
                        border: 1px solid #999999;
                        padding-left: 10px;  padding-right: 10px;
                        padding-bottom: 10px;  padding-top: 10px
                        ">
                     Labor
                  </td>
               </tr>
            </thead>
            <tbody>


               <tr *ngIf="allServiceTasks?.length == 0">
                  <td colspan="" style="padding-top: 10px; padding-bottom: 10px;" align="center">
                     {{noRecordMessage}}</td>
               </tr>
               <tr *ngFor='let data of allServiceTasks'>
                  <td height="25" style="font-size: 13px;border-right: 1px solid #999999;padding-left: 10px;">
                     {{data.taskName}}
                  </td>
                  <td style="font-size: 13px;border-right: 1px solid #999999; padding-left: 10px; padding-right: 10px;">
                     {{data.laborCost}} {{currency}}</td>
               </tr>
         </table>

         <h5 style="color:#231F20;"><b> Description</b></h5>
         <table width="100%" style="color: #000000;border: 1px solid #999999; font-size: 13px; margin-bottom: 10px;">


            <tbody>
               <tr>
                  <td width="50%" style=" border: 1px solid #999999;
                     padding-left: 10px;  padding-right: 10px; height: 80px; text-align: top">
                     {{description ? description : '-'}}
                  </td>

               </tr>
            </tbody>

         </table>

         <table width="100%" style="color: #000000; font-size: 13px; margin-bottom: 10px;">
            <tr>
               <td colspan="2">&nbsp;</td>
             </tr>
             <tr>
               <td colspan="2">
                 <table border="0" align="center" cellpadding="0" cellspacing="0">
                   <tbody>
                     <tr>
                       <td align="center">
                         <h2 style="font-size: 13px">Powered By</h2>
                         <img
                           src="../../../../../../assets/img/logo.png"
                           width="207"
                           height="28"
                         />
                       </td>
                     </tr>
                   </tbody>
                 </table>
               </td>
             </tr>
             <tr>
               <td colspan="2">&nbsp;</td>
             </tr>
         </table>
      </section>
   </div>

   <div class="modal-footer">

      <button type="button" class="btn btn-default" (click)="modal.dismiss()">
         Close
      </button>
      <button type="button" class="btn btn-success" (click)="downloadPdf()">Download</button>
   </div>
</ng-template>