<section class="body">
    <div class="inner-wrapper">
        <section role="main" class="content-body pl-0 pt-0 pr-0">
            <header class="page-header pr19 pl7">
                <form class="form-horizontal" method="get">
                    <div class="row" style="padding-top: 10px">
                        <div class="col-md-12 col-lg-12 text-right pr-1">
                            <div class="btn-group flex-wrap"></div>
                            <a href="javascript:;" (click)="refreshData()" data-toggle="tooltip" title="Refresh data" class="btn btn-success btn-sm modal-with-form mr-2">
                                <i class="fas fa-sync"></i></a>

                            <a routerLink="/manage/devices/add" class="btn btn-success btn-sm"><i class="fas fa-plus"></i> Add Device</a
              >
            </div>
          </div>
        </form>
      </header>

      <section class="m-2">
        <div class="row mb-3">
          <div class="col-lg-12">
            <div
            infiniteScroll
            [infiniteScrollDistance]="1"
            [infiniteScrollUpDistance]="2"
           
            (scrolled)="onScroll()"
          >
            <div class="bg-white p-3 text-dark">
              <div
                id="simple-table_wrapper"
                class="dataTables_wrapper dt-bootstrap4 no-footer"
              >
                <div class="row">
                  <div class="col-lg-6">
                    <div class="dataTables_length" id="simple-table_length">
                      <label
                        >Show
                        <select
                          name="simple-table_length"
                          aria-controls="simple-table"
                          class="
                            custom-select custom-select-sm
                            form-control form-control-sm
                          "
                        >
                          <option value="10">10</option>
                          <option value="25">25</option>
                          <option value="50">50</option>
                          <option value="100">100</option>
                        </select>
                        entries</label
                      >
                    </div>
                  </div>
                  <div class="col-lg-6"></div>
                </div>
                <div class="table-responsive">
                  <table
                    class="
                      row-border
                      hover
                      table table-bordered table-striped
                      mb-0
                    "
                    id="simple-table"
                    role="grid"
                  >
                    <thead>
                      <tr>
                        <th width="10%" class="col3" style="width: 135px">
                          Serial/IMEI
                        </th>
                        <th width="25%" class="col2" style="width: 371px">
                          Device Name
                        </th>
                        <th width="15%" class="col4" style="width: 213px">
                          Vehicle/Asset
                        </th>
                        <th width="10%" class="col1" style="width: 136px">
                          Status
                        </th>
                        <th id="" class="minWidth50" style="width: 20px">
                          Actions
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngIf="devices.length == 0" class="text-center">
                        <td colspan="15">{{ dataMessage }}</td>
                      </tr>

                      <tr role="row" class="odd" *ngFor="let device of devices">
                        <td
                          routerLink="/manage/devices/detail/{{
                            device.deviceSerialNo.replace('#', '/')
                          }}"
                        >
                          {{ device.deviceSerialNo.split("#")[1] }}
                        </td>
                        <td
                          routerLink="/manage/devices/detail/{{
                            device.deviceSerialNo.replace('#', '/')
                          }}"
                        >
                          {{ device.deviceName }}
                        </td>
                        <td
                          *ngIf="
                            device.vehicle.vehicleIdentification;
                            else elseBlock
                          "
                        >
                       <a  style="color: blue; text-decoration: none;" target="_blank" routerLink="/fleet/tracking/vehicle-dash-cam-tracker/{{device.deviceSerialNo.split('#')[1]}}" [queryParams]="{ vehicleId: device.vehicle.vehicleID}">  {{ device.vehicle.vehicleIdentification }}</a>
                            </td>
                            <ng-template #elseBlock>
                                <td>

                                    <a style="color: blue; text-decoration: none;" target="_blank" routerLink="/fleet/tracking/asset-tracker/{{device.asset.assetIdentification}}" [queryParams]="{ assetId: device.asset.assetID}" queryParamsHandling="merge">  {{  device.asset.assetIdentification }}</a>

                                </td>
                            </ng-template>
                            <td>
                                <span class="badge badge-success text-3">{{
                            device.deviceStatus === true ? 'Active' : 'Inactive'
                          }}</span>
                            </td>
                            <td class="border-0">
                                <div class="dropdown dropright">
                                    <button class="bg-transparent border-0" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              <i class="fas fa-ellipsis-v"></i>
                            </button>
                                    <div class="dropdown-menu">
                                        <a class="dropdown-item" routerLink="/manage/devices/edit/{{
                                  device.deviceSerialNo.replace('#', '/')
                                }}">Edit</a
                              >
                              <a
                                href="javascript:;"
                                class="dropdown-item"
                                (click)="
                                  deactivateDevice(
                                    device.deviceType,
                                    device.deviceID,
                                    !device.deviceStatus
                                  )
                                "
                                >{{ device.deviceStatus === true ? 'Deactivate' : 'Activate'}}</a
                              >
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div
                class="col-lg-12 mt-3 text-center"
                *ngIf="devices.length !== 0 && next != 'end'"
              >
                <button
                  type="button"
                  class="btn btn-success btn-sm text-light"
                  (click)="onScroll()"
                >
                  Load More..
                </button>
              </div>
              </div>
            </div>
            </div>
          </div>
        </div>
      </section>
    </section>
  </div>
</section>