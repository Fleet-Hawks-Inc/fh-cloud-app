<p-toast></p-toast>
<section class="body">
    <div class="inner-wrapper" *ngIf="carriers.carrierID">


        <section role="main" class="content-body">
            <header class="page-header">
                <div class="row">
                    <div class="col header-title">
                        <label class="mt-0 mb-0"> Company Profile</label>
                    </div>
                    <div class="col header-buttons">
                        <button type="button" pButton class="mr-1" (click)="showMFA=true;generateTOTPCode()"
                            icon="pi pi-shield" pTooltip="Manage MFA" tooltipPosition="left"></button>
                        <button type="button" pButton *ngIf="showSubCompany && subCompanies.length < 5" class="mr-1"
                            (click)="display=true;" icon="pi pi-building" tooltipPosition="left"
                            pTooltip="Add Subcompany"></button>
                        <button type="button" pButton class="mr-1" (click)="display1=true;" icon="pi pi-lock" tooltipPosition="left"
                         pTooltip="Change your password"></button>
                        <button id="btn" type="button" pButton class="mr-1"
                            routerLink="/manage/company/edit/{{carriers.carrierID}}" tooltipPosition="left"
                            icon="pi pi-user-edit" pTooltip="Edit Company details"></button>
                    </div>
                </div>
            </header>
            <div class="routing-overview__wrapper m-3">
                <div class="row">
                    <div class="col-lg-12 pr-1 pl-2">
                        <div class="bg-white">
                            <div class="row p-3">
                                <div class="col-2">
                                    <img *ngIf="logoSrc" [src]="logoSrc" class="img-fluid" alt="logo">
                                </div>
                                <div class="col-10 text-dark">
                                    <h1 class="font-weight-semibold text-7 text-capitalize mt-0">
                                        {{carriers.carrierName}}</h1>
                                </div>
                                <div class="col-10 text-dark">
                                    <h1 class="font-weight-normal text-dark text-5 mt-1 mb-1">{{carriers.tagLine}}</h1>
                                </div>

                                <div class="col-lg-12 mt-3">
                                    <h2 class="font-weight-normal text-dark text-5 mt-2 mb-1">Basic Detail</h2>
                                    <table class="table table-bordered table-responsive-lg">
                                        <tbody>
                                            <tr>
                                                <td width="20%" class="back-color-gray">Name</td>
                                                <td width="30%">{{carriers.firstName | titlecase}} &nbsp;
                                                    {{carriers.lastName | titlecase}}</td>
                                                <td width="20%" class="back-color-gray">Phone</td>
                                                <td width="30%">{{carriers.phone}} <span class="badge badge-success"
                                                        *ngIf="userAttributes && userAttributes.phoneVerified">VERIFIED</span>
                                                    <span class="badge badge-danger"
                                                        (click)="showVerifyPhone=true;verifyPhone()"
                                                        *ngIf="userAttributes && !userAttributes.phoneVerified">NOT
                                                        VERIFIED</span>
                                                </td>
                                            </tr>

                                            <tr>
                                                <td class="back-color-gray">Username</td>
                                                <td>{{carriers.userName}}</td>
                                                <td class="back-color-gray">Email </td>
                                                <td>{{carriers.email}} <span class="badge badge-success"
                                                        *ngIf="userAttributes && userAttributes.emailVerified">VERIFIED</span>
                                                    <span class="badge badge-danger"
                                                        (click)="showVerifyEmail=true;verifyEmail()"
                                                        *ngIf="userAttributes && !userAttributes.emailVerified">NOT
                                                        VERIFIED</span>
                                                </td>
                                            </tr>
                                            <tr>

                                                <td class="back-color-gray">How did you find us?</td>
                                                <td>{{carriers.findingWay ? carriers.findingWay : '-'}}</td>
                                                <td class="back-color-gray">Fax</td>
                                                <td>{{carriers.fax ? carriers.fax : '-'}}</td>
                                            </tr>

                                            <td class="back-color-gray">Notification Email </td>
                                            <td>{{carriers.notificationEmail ? carriers.notificationEmail: '-'}}
                                            </td>

                                            <tr *ngIf="carriers.findingWay=='Referral'">

                                                <td class="back-color-gray">Referral Name</td>
                                                <td>{{carriers.referral.name ? carriers.referral.name : '-'}}</td>
                                                <td class="back-color-gray">Referral Company</td>
                                                <td>{{carriers.referral.company ? carriers.referral.company : '-'}}</td>
                                            </tr>
                                            <tr *ngIf="carriers.findingWay=='Referral'">

                                                <td class="back-color-gray">Referral Email</td>
                                                <td>{{carriers.referral.email ? carriers.referral.email : '-'}}</td>
                                                <td class="back-color-gray">Referral Phone</td>
                                                <td>{{carriers.referral.phone ? carriers.referral.phone : '-'}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <div class="col-lg-12">
                                    <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Business Detail</h2>
                                    <table class="table table-bordered table-responsive-lg">
                                        <tbody>
                                            <tr class="text-capitalize">
                                                <td width="20%" class="back-color-gray">Registered Company Name</td>
                                                <td width="30%">{{carriers.carrierName}}</td>
                                                <td width="20%" class="back-color-gray">DBA Name</td>
                                                <td width="30%">{{carriers.DBAName ? carriers.DBAName : '-' }}</td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray">Number of Fleets</td>
                                                <td><span
                                                        *ngIf="carriers.fleets != undefined">{{carriers.fleets.totalFleets
                                                        ? carriers.fleets.totalFleets : '-'}}</span>
                                                </td>
                                                <td class="back-color-gray">EIN</td>
                                                <td>{{carriers.EIN ? carriers.EIN : '-'}}</td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray">Vehicle(s)</td>
                                                <td><span *ngIf="carriers.fleets != undefined">{{carriers.fleets.trucks
                                                        ? carriers.fleets.trucks : '-'}}</span>
                                                </td>
                                                <td class="back-color-gray">Liability Insurance#</td>
                                                <td>{{carriers.liabilityInsurance ? carriers.liabilityInsurance : '-'}}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray">Asset(s)</td>
                                                <td><span
                                                        *ngIf="carriers.fleets != undefined">{{carriers.fleets.trailers
                                                        ? carriers.fleets.trailers : '-'}}</span>
                                                </td>
                                                <td class="back-color-gray">Cargo Insurance#</td>
                                                <td>{{carriers.cargoInsurance ? carriers.cargoInsurance : '-'}}</td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray">Reefer(s)</td>
                                                <td><span *ngIf="carriers.fleets != undefined">{{carriers.fleets.reefers
                                                        ? carriers.fleets.reefers : '-'}}</span>
                                                </td>
                                                <td class="back-color-gray">CCC</td>
                                                <td>{{carriers.CCC ? carriers.CCC : '-'}}</td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray">Dry Van(s)</td>
                                                <td><span *ngIf="carriers.fleets != undefined">{{carriers.fleets.dryVans
                                                        ? carriers.fleets.dryVans : '-'}}</span>
                                                </td>
                                                <td class="back-color-gray">SCAC</td>
                                                <td>{{carriers.SCAC ? carriers.SCAC : '-'}}</td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray">Flatbed(s)</td>
                                                <td><span *ngIf="carriers.fleets != undefined">{{carriers.fleets.flatbed
                                                        ? carriers.fleets.flatbed : '-'}}</span>
                                                </td>
                                                <td class="back-color-gray">Business Country</td>
                                                <td><span *ngIf="carriers.bizCountry == 'CA'">Canada</span>
                                                    <span *ngIf="carriers.bizCountry == 'US'">United States of
                                                        America</span>
                                                    <span
                                                        *ngIf="carriers.bizCountry != 'US' && carriers.bizCountry != 'CA'">-</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray">Curtainside(s)</td>
                                                <td><span
                                                        *ngIf="carriers.fleets != undefined">{{carriers.fleets.curtainSide
                                                        ?
                                                        carriers.fleets.curtainSide : '-'}}</span>
                                                </td>
                                                <td class="back-color-gray">CSA</td>
                                                <td><span *ngIf="carriers.CSA == false">NO</span><span
                                                        *ngIf="carriers.CSA == true">YES</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray">PIP</td>
                                                <td><span *ngIf="carriers.PIP == false">NO</span><span
                                                        *ngIf="carriers.PIP == true">YES</span>
                                                </td>
                                                <td class="back-color-gray">CTPAT</td>
                                                <td><span *ngIf="carriers.CTPAT == false">NO</span><span
                                                        *ngIf="carriers.CTPAT == true">YES</span></td>
                                            </tr>
                                            <tr>
                                                <td class="back-color-gray" *ngIf="carriers.bizCountry == 'US'">DOT#
                                                </td>
                                                <td *ngIf="carriers.bizCountry == 'US'">{{carriers.DOT}}</td>
                                                <td class="back-color-gray" *ngIf="carriers.bizCountry == 'US'">MC#</td>
                                                <td *ngIf="carriers.bizCountry == 'US'">{{carriers.MC}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-lg-6" *ngIf="accountSettings.length > 0">
                                    <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Account Settings</h2>
                                    <table class="table table-bordered table-responsive-lg">
                                        <tbody>
                                            <tr class="text-capitalize" *ngFor="let account of accountSettings">
                                                <td width="20%" class="back-color-gray">{{account.type}} (Prefix +
                                                    Sequence) </td>
                                                <td width="30%">{{account.prefix}}{{account.sequence}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-lg-12"
                                    *ngIf="carriers.addressDetails && carriers.addressDetails.length > 0">
                                    <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Address</h2>
                                    <table class="table table-bordered table-responsive-lg"
                                        *ngFor="let address of carriers.addressDetails">
                                        <tbody>
                                            <tr class="text-capitalize">
                                                <td width="20%" class="back-color-gray">Address Type</td>
                                                <td width="30%">{{address.addressType ? address.addressType : '-'}}
                                                    <span *ngIf="address.defaultYard"
                                                        class="font-weight-semibold">(Default)</span>
                                                </td>
                                                <td width="20%" class="back-color-gray">Address</td>
                                                <td width="30%">{{address.address ? address.address : '-'}}</td>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td class="back-color-gray">Country</td>
                                                <td>{{address.countryName ? address.countryName : '-'}}</td>
                                                <td class="back-color-gray">Province/State</td>
                                                <td>{{address.stateName ? address.stateName : '-'}}</td>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td class="back-color-gray">City</td>
                                                <td>{{address.cityName ? address.cityName : '-'}}</td>
                                                <td class="back-color-gray">Zip Code</td>
                                                <td>{{address.zipCode ? address.zipCode : '-'}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- Subscription Details start -->
                                <div class="col-lg-12" *ngIf="subscriptions.length == 0">
                                    <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Subscription Info not
                                        found.
                                    </h2>
                                </div>

                                <div class="col-lg-12" *ngIf="subscriptions.length > 0">
                                    <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Subscription Details</h2>
                                    <table class="table table-bordered table-responsive-lg">
                                        <thead>
                                            <tr>
                                                <th width="30%">Name</th>
                                                <th>Plan Code</th>
                                                <th>Activation Date</th>
                                                <th>Last Billing Date</th>
                                                <th>Next Billing Date</th>
                                                <th>Last Paid Amount</th>

                                            </tr>
                                        </thead>
                                        <tr class="text-capitalize" *ngFor="let sub of subscriptions">

                                            <td>{{sub.name}}</td>
                                            <td>{{sub.plan_code}}</td>
                                            <td>{{sub.activated_at}}</td>
                                            <td>{{sub.last_billing_at}}</td>
                                            <td>{{sub.next_billing_at}}</td>
                                            <td>{{sub.amount}}</td>
                                        </tr>


                                    </table>
                                </div>

                                <!-- Subscription Details end -->


                                <div class="col-lg-12" *ngIf="carriers.banks && carriers.banks.length > 0">
                                    <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Bank Details</h2>
                                    <table class="table table-bordered table-responsive-lg"
                                        *ngFor="let bank of carriers.banks">
                                        <tbody>
                                            <tr class="text-capitalize">
                                                <td width="20%" class="back-color-gray">Bank Name</td>
                                                <td width="30%"><span
                                                        *ngIf="carriers.banks != undefined">{{bank.branchName ?
                                                        bank.branchName :
                                                        '-'}}</span></td>
                                                <td width="20%" class="back-color-gray">Routing#</td>
                                                <td width="30%"><span
                                                        *ngIf="carriers.banks != undefined">{{bank.routingNumber ?
                                                        bank.routingNumber : '-'}}</span>
                                                </td>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td class="back-color-gray">Account#</td>
                                                <td><span *ngIf="carriers.banks != undefined">{{bank.accountNumber ?
                                                        bank.accountNumber :
                                                        '-'}}</span>
                                                </td>
                                                <td class="back-color-gray">Transit#</td>
                                                <td><span *ngIf="carriers.banks != undefined">{{bank.transitNumber ?
                                                        bank.transitNumber :
                                                        '-'}}</span>
                                                </td>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td class="back-color-gray">Institution#</td>
                                                <td><span *ngIf="carriers.banks != undefined">{{bank.institutionNumber ?
                                                        bank.institutionNumber
                                                        : '-'}}</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                        <tbody *ngFor="let address of bank.addressDetails">
                                            <tr>
                                                <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Bank Address
                                                </h2>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td width="20%" class="back-color-gray">Address Type</td>
                                                <td width="30%">{{address.addressType ? address.addressType : '-'}}</td>
                                                <td width="20%" class="back-color-gray">Address</td>
                                                <td width="30%">{{address.address ? address.address :'-'}}</td>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td class="back-color-gray">Country</td>
                                                <td>{{address.countryName ? address.countryName : '-'}}</td>
                                                <td class="back-color-gray">Province/State</td>
                                                <td>{{address.stateName ? address.stateName : '-'}}</td>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td class="back-color-gray">City</td>
                                                <td>{{address.cityName ? address.cityName : '-'}} {{carriers.Driver}}
                                                </td>
                                                <td class="back-color-gray">Zip Code</td>
                                                <td>{{address.zipCode ? address.zipCode : '-'}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-lg-12">
                                    <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Terms and
                                        Conditions
                                    </h2>
                                    <table class="table table-bordered table-responsive-lg">
                                        <tbody>
                                            <tr class="text-capitalize">
                                                <td width="20%" class="back-color-gray">Terms For Customer on Invoice
                                                </td>
                                                <td width="30%"> {{carriers.termsCustom ? carriers.termsCustom : '-'}}
                                                </td>

                                                <td width="20%" class="back-color-gray">Terms and Conditions For Carrier
                                                </td>
                                                <td width="30%">{{carriers.termsCarrier ? carriers.termsCarrier : '-'}}
                                                </td>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td class="back-color-gray">Terms and Conditions For Truck Dispatch</td>
                                                <td>{{carriers.termsTruck ? carriers.termsTruck : '-'}}</td>

                                                <td class="back-color-gray">Notes For B.O.L</td>
                                                <td>{{carriers.notesBol ? carriers.notesBol : '-'}}</td>
                                            </tr>
                                            <tr class="text-capitalize">
                                                <td class="back-color-gray">Dispatch Notes For Driver</td>
                                                <td>{{carriers.notesDriver ? carriers.notesDriver : '-'}}
                                                </td>
                                                <td class="back-color-gray">Notes For Factor Invoice</td>
                                                <td>{{carriers.notesFactor ? carriers.notesFactor : '-' }}</td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </div>

                                <div class="col-lg-12" *ngIf="subCompanies.length > 0">
                                    <h2 class="font-weight-normal text-dark text-5 mt-0 mb-1">Sub Companies</h2>
                                    <table class="table table-bordered table-responsive-lg">
                                        <tbody>
                                            <tr class="text-capitalize" *ngFor="let data of subCompanies">
                                                <td width="20%" class="back-color-gray">Username</td>
                                                <td width="30%"><span
                                                        *ngIf="carriers.banks != undefined">{{data.username}}</span>
                                                </td>
                                                <td width="20%" class="back-color-gray">Status</td>
                                                <td width="30%"><span
                                                        *ngIf="carriers.banks != undefined">{{data.status}}</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</section>

<p-dialog header="Change Password" [(visible)]="display1" [style]="{width: '30vw', height:'23vw'}">
    <div class="modal-body text-dark" style="max-height: 500px;">
        <form id="changePasswordForm" class="form-horizontal form-bordered text-capitalize" name="changePasswordForm"
            [mustMatch]="['password', 'confirmPassword']" (ngSubmit)="changePasswordF.form.valid && onChangePassword()"
            novalidate #changePasswordF="ngForm">
            <div class="row">
                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> Old Password <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label>
                    <div class="input-group">
                        <input id="pd" [(ngModel)]="pwdData.oldPassword" placeholder="eg.  $John@01" name="oldPassword"
                            #oldPwd="ngModel" required
                            [ngClass]="{ 'error' : changePasswordF.submitted && oldPwd.invalid }"
                            [type]="oldFieldTextType ? 'text' : 'password'" class="form-control" />
                        <div class="input-group-append">
                            <span class="input-group-text eye">
                                <i class="fa" [ngClass]="{'fa-eye-slash': !oldFieldTextType,
                                    'fa-eye': oldFieldTextType}" (click)="toggleOldFieldTextType()"></i>
                            </span>
                        </div>
                    </div>
                    <div *ngIf="oldPwd.invalid && changePasswordF.submitted" class="text-danger">
                        <div *ngIf="oldPwd.errors.required">
                            Old Password is required.
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> New Password <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label>
                    <div class="input-group">
                        <input id="pd" [(ngModel)]="pwdData.newPassword" placeholder="eg.  $John@01"
                            (change)="onChangeHideErrors('password')" name="password" #pwd="ngModel" required
                            [ngClass]="{ 'error' : changePasswordF.submitted && pwd.invalid }"
                            pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*\.\-]).{8,20}$"
                            [type]="fieldTextType ? 'text' : 'password'" (input)="validatePassword($event.target.value)"
                            class="form-control" />
                        <div class="input-group-append">
                            <span class="input-group-text eye">
                                <i class="fa" [ngClass]="{'fa-eye-slash': !fieldTextType,
                              'fa-eye': fieldTextType}" (click)="toggleFieldTextType()"></i>
                            </span>
                        </div>
                    </div>
                    <div *ngIf="pwd.invalid && changePasswordF.submitted" class="text-danger">
                        <div *ngIf="pwd.errors.required">
                            Password is required.
                        </div>
                        <div *ngIf="pwd.errors.pattern">
                            <div class="row">
                                <div class="col-lg-12">
                                    <p class="text-dark pt-2 mb-0"> <span class="pr-1"
                                            [ngClass]="[passwordValidation.length ? 'green1': 'red1']">
                                            <i
                                                [ngClass]="[passwordValidation.length ? 'fas fa-check' : 'fas fa-times']">
                                            </i></span> 8 characters minimum</p>
                                    <p class="text-dark pt-2 mb-0"> <span class="pr-1"
                                            [ngClass]="[passwordValidation.number ? 'green1': 'red1']">
                                            <i
                                                [ngClass]="[passwordValidation.number ? 'fas fa-check' : 'fas fa-times']">
                                            </i></span> atleast 1 number
                                    </p>
                                </div>
                                <div class="col-lg-12">
                                    <p class="text-dark pt-2 mb-0"> <span class="pr-1"
                                            [ngClass]="[passwordValidation.upperCase? 'green1': 'red1']">
                                            <i
                                                [ngClass]="[passwordValidation.upperCase? 'fas fa-check': 'fas fa-times']">
                                            </i></span> atleast 1 uppercase</p>

                                    <p class="text-dark pt-2 mb-0"> <span class="pr-1"
                                            [ngClass]="[passwordValidation.lowerCase ? 'green1': 'red1']"> <i
                                                [ngClass]="[passwordValidation.lowerCase ? 'fas fa-check': 'fas fa-times']">
                                            </i></span> atleast 1 lowercase</p>

                                </div>
                                <div class="col-lg-12">
                                    <p class="text-dark pt-2 mb-0"><span class="pr-1"
                                            [ngClass]="[passwordValidation.specialCharacters ? 'green1': 'red1']">
                                            <i
                                                [ngClass]="[passwordValidation.specialCharacters ? 'fas fa-check': 'fas fa-times']"></i></span>
                                        atleast 1 special character(!@#$%^&*.-)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2">Confirm Password <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label>
                    <div class="input-group">
                        <input id="cnf" [(ngModel)]="pwdData.confirmPassword" name="confirmPassword"
                            (change)="onChangeHideErrors('confirmPassword')" #cpwd="ngModel" required
                            [ngClass]="{ 'error' : changePasswordF.submitted && cpwd.invalid }"
                            [type]="cpwdfieldTextType ? 'text' : 'password'" placeholder="Confirm password"
                            class="form-control" />
                        <div class="input-group-append">
                            <span class="input-group-text eye">
                                <i class="fa" [ngClass]="{'fa-eye-slash': !cpwdfieldTextType,
                                    'fa-eye': cpwdfieldTextType}" (click)="togglecpwdfieldTextType()"></i>
                            </span>
                        </div>
                    </div>
                    <div *ngIf="cpwd.invalid && changePasswordF.submitted" class="text-danger">
                        <div *ngIf="cpwd.errors.required">
                            Confirm password is required.
                        </div>
                        <div *ngIf="cpwd.errors.mustMatch">Passwords must match</div>
                    </div>
                </div>
            </div><br>

            <div class="row mt-3">
                <div class="col-lg-12 text-right">
                    <div *ngIf="oldPassError" class="text-danger">{{oldPassError}}</div>
                    <button pButton type="button" label="Cancel" class="mb-2" style="margin-right: 20px;"
                        (click)="pwdModalClose(); display1= false;"></button>
                    <button pButton type="submit" label="Save" class="mb-2" style="margin-right: 0px;"
                        [disabled]="submitDisabled" (click)="onChangePassword()"></button>
                </div>
            </div>
        </form>
    </div>
</p-dialog>

<p-dialog header="Add Sub Company" [(visible)]="display" [style]="{width: '40vw', height:'86%'}" tabindex="-1"
    role="dialog" aria-labelledby="addCompanyModal" aria-hidden="true">
    <div class="modal-body text-dark" style="max-height: 500px;">
        <form id="addCompanyForm" class="form-horizontal form-bordered text-capitalize" name="addCompF"
            [mustMatch]="['password', 'confirmPassword']" (ngSubmit)="addCompF.form.valid" novalidate #addCompF="ngForm"
            [formGroup]="userInfoFormGroup">
            <div class="row">
                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> First Name <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label><br>
                    <input type="text" style="width: 700px;" placeholder="eg. John" required class="mb-2" pInputText
                        formControlName="firstName">
                </div>

                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> Last Name <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label><br>
                    <input type="text" style="width: 700px;" placeholder="eg. Smith" required pInputText class="mb-2"
                        formControlName="lastName">
                </div>


                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> Registered Company Name <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label><br>
                    <input name="cName" type="text" style="width: 700px;" placeholder="eg. Fleet Inc." required
                        class="mb-2" pInputText formControlName="carrierName" (focusout)="validateCompanyName()">
                </div>
                <div class="text-danger" *ngIf="carrierNameExists">{{carrierNameErr}}</div>


                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> Email <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label><br>
                    <input name="emailId" type="text" style="width: 700px;" placeholder="eg. johnsmith@gmail.com"
                        requiredclass="mb-2" pInputText formControlName="email" (focusout)="validateEmail()">
                </div>
                <div class="text-danger" *ngIf="emailExistsExists">{{emailExistsErr}}</div>



                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> Username <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label><br>
                    <input name="username" type="text" style="width: 700px;" placeholder="eg. johnsmith12" required
                        class="mb-2" pInputText formControlName="username" (focusout)="validateUsername()">
                </div>
                <div class="text-danger" *ngIf="userNameExists">{{userNameExistsErr}}</div>



                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> Password <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label><br>
                    <input name="pwd" type="password" style="width: 700px;" placeholder="eg. $John@01" required
                        class="mb-2" pInputText formControlName="compPassword">
                </div>



                <div class="col-lg-12">
                    <label class="control-label font-weight-bold text-lg-right pt-2"> Confirm Password <span
                            class="mandfield text-2 ml-1"><sup>*</sup></span>
                    </label><br>
                    <input name="confirmPwd" type="password" style="width: 700px;" placeholder="eg. $John@01"
                        requiredclass="mb-2" pInputText formControlName="compPassword">
                </div>
            </div>
            <div class="modal-footer">
                <div class="row mt-3">
                    <div class="col-lg-12 text-right">
                        <button pButton type="button" (click)="clearForm(); display= false;" label="Cancel" class="mb-2"
                            style="margin-right: 20px"></button>
                        <button pButton type="button" (click)="addSubCompany()" label="Save" class="mb-2"
                            style="margin-right: -30px;"></button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</p-dialog>

<p-dialog header="Verify Email" [(visible)]="showVerifyEmail" [modal]="true" [style]="{width: '30vw'}"
    [draggable]="false" [resizable]="false">
    <div>
        <label> We have sent you verification code on your email <strong>{{carriers.email}}</strong>. Please check your
            email(SPAM or JUNK) and enter the code below.
        </label>
    </div>
    <div style="text-align:center">
        <ng-otp-input (onInputChange)="onOtpChange($event)" [config]="{length:6,allowNumbersOnly:true}"></ng-otp-input>
    </div><br />
    <div style="text-align:center">
        <label style="color:red">{{verficationError}}</label>
        <p-tag styleClass="mr-2" icon="pi pi-exclamation-triangle" severity="warning" value="Warning"></p-tag> You have
        to sign-in again once email is verified.
    </div>


    <ng-template pTemplate="footer">
        <p-button icon="pi pi-check" [disabled]="!verifyButton" class="p-button-warning"
            (click)="verifyAttribute('email')" label="Verify Email"></p-button>
    </ng-template>
</p-dialog>

<p-dialog header="Verify Phone Number" [(visible)]="showVerifyPhone" [modal]="true" [style]="{width: '30vw'}"
    [draggable]="false" [resizable]="false">
    <div>
        <label> We have sent you verification code on your phone number <strong>{{carriers.phone}}</strong>.
        </label>
    </div>
    <div style="text-align:center">
        <ng-otp-input (onInputChange)="onOtpChange($event)" [config]="{length:6,allowNumbersOnly:true}"></ng-otp-input>

    </div><br />
    <div style="text-align:center">
        <label style="color:red">{{verficationError}}</label>
        <p-tag styleClass="mr-2" icon="pi pi-exclamation-triangle" severity="warning" value="Warning"></p-tag> You have
        to sign-in again once phone is verified.

    </div>

    <ng-template pTemplate="footer">
        <p-button icon="pi pi-check" class="p-button-warning" [disabled]="!verifyButton"
            (click)="verifyAttribute('phone_number')" label="Verify Phone"></p-button>
    </ng-template>
</p-dialog>


<!-- Multifactor Authentication Dialog -->

<p-dialog header="Enable Multi-factor Authentication(MFA)" [(visible)]="showMFA" [modal]="true"
    [style]="{width: '50vw'}" [draggable]="false" [resizable]="false">
    <div class="alert alert-danger" role="alert" *ngIf="mfaError!==''">
        {{mfaError}}
    </div>

    <strong><label> {{currentStatus}}</label><br></strong>
    <label><strong>TOTP (Time based One Time Password)</strong> </label>
    <div class="row">
        <div class="col-md-5">
            <!-- TOTP Configuration -->
            <!-- <div class="field-checkbox">
                    <p-checkbox [binary]="true" inputId="binary" (onChange)="generateTOTPCode($event)"></p-checkbox>
                    <label style="margin:0px; margin-left:5px" for="binary"> </label>
                </div> -->
            <!-- show Totp configuration -->
            <ol>
                <li>
                    Download one of the apps on your phone/desktop Google authenticator, Microsoft authenticator or
                    Authy.
                </li>
                <li>
                    Scan the QR code displayed here.
                </li>
                <li>
                    Once scanned, the app should give you 6 digit TOTP.
                </li>
                <li>
                    <label>Enter <strong>6 digit </strong> code from app below:</label><br />

                </li>
                <input type="text" pInputText [(ngModel)]="userTotpCode" />
            </ol>




        </div>
        <div class="col-md-7">
            <div style="text-align: right;" *ngIf="totpMFA ">
                <img [src]="qrcodeImage" />
                <label>Optionally, you can enter following code in your authenticator app: <strong>
                        {{totpCode}}</strong></label>




            </div>
        </div>
    </div>
    <div class="alert alert-success" role="alert">
        <label>Note: Once the MFA is enabled, You would be prompted to enter TOTP from app every time you sign
            In.</label>
    </div>


    <!-- TOTP Configuration ENDS -->
    <!-- SMS MFA CURRENTLY DISABLED -->
    <!-- <div class="field-checkbox">
            <p-checkbox [binary]="true" [(ngModel)]="smsMFA" inputId="binary" (onChange)="generateTOTPCode($event)"></p-checkbox>
            <label style="margin:0px; margin-left:5px" for="binary">  SMS OTP(Phone Number One Time Passwords)</label>
        </div>
        
        <div style="text-align: center;" *ngIf="isSMS">
            <label>Please scan this QR code with Google authenticator, Microsoft authenticator or Authy</label>
            <img [src]="qrcodeImage" />
            <label>Optionally, you can enter following code in your authenticator app: <strong> {{totpCode}}</strong></label>
        </div> -->
    <!-- SMS MFA  ENDS -->






    <ng-template pTemplate="footer">

        <p-confirmPopup></p-confirmPopup>
        <p-button icon="pi pi-warning" class="p-button-danger" (click)="disableMFA($event);" label="Disable MFA">
        </p-button>
        <p-button icon="pi pi-check" class="p-button-warning" (click)="setupVerifyTOTPCode()" label="Setup TOTP">
        </p-button>

    </ng-template>
</p-dialog>