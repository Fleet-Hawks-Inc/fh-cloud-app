<section class="body">
  <div class="inner-wrapper">
    <section role="main" class="content-body pr-0 pt-0">
      <header class="page-header pr27 pl18">
        <form class="form-horizontal" method="get">
          <div class="row" style="padding-top: 10px">
            <div class="col-md-2 col-lg-2 pr-0">
              <div class="input-group input-group-md">
                <input type="text" autocomplete="off" name="driverName" [(ngModel)]="driverName" placeholder="Search driver by name" class="form-control" (input)="getSuggestions($event.target.value)" />
              </div>
              <div *ngIf="suggestedDrivers?.length > 0" class="result-suggestions">
                <ul>
                  <li *ngFor="
                                    let suggestedDriver of suggestedDrivers
                                  " class="cursorpoint" (click)="
                                    setDriver(
                                      suggestedDriver.driverID,
                                      suggestedDriver.firstName,
                                      suggestedDriver.lastName,
                                      suggestedDriver.middleName
                                    )
                                  " class="text-capitalize">
                    {{ suggestedDriver.firstName }}
                    {{ suggestedDriver.middleName }}
                    {{ suggestedDriver.lastName }}
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-md-2 col-lg-2 pr-0">
              <ng-select [(ngModel)]="driverType" name="driverType" placeholder="Driver type" class="form-control form-control-sm populate">
                <ng-option value="contractor">Contractor</ng-option>
                <ng-option value="employee">Employee</ng-option>
              </ng-select>
            </div>
            <div class="col-md-2 col-lg-2">
              <button type="submit" (click)="searchFilter()" class="btn btn-sm btn-success mr-3">
                Search
              </button>
              <button type="button" (click)="resetFilter()" class="btn btn-sm btn-success">
                Reset
              </button>
            </div>

            <div class="col-md-2 col-lg-6 text-right">
              <a routerLink="/manage/settings/driver-overview" class="btn btn-success btn-sm"><i class="fas fa-arrow-left"></i> Go Back</a>
            </div>
          </div>
        </form>
      </header>

      <div class="routing-overview__wrapper m-2">
        <div class="row">
          <div class="col-lg-12 col-xl-12 mb-4">
            <div class=" ">
              <ul class="nav nav-tabs top-tabs">
                <li class="nav-item active">
                  <a class="nav-link active" href="#deletedDrivers" data-toggle="tab"> Restore deleted drivers</a>
                </li>
              </ul>

              <div class="tab-content mt-2" style="box-shadow: none; border: none">
                <!-- driver listing -->
                <div id="drlistset" class="tab-pane">
                  <div class="row pt-2 text-dark">
                    <div class="col-12">
                      <p class="text-4 font-weight-bold back-color-gray p-2 text-dark">
                        Set the visibility of driver listing to
                      </p>
                    </div>

                    <div class="col-5 offset-lg-1">
                      <div class="radio">
                        <label>
                          <input type="radio" name="ds" id="ds" class="driver-type" checked="checked" />
                          Active Drivers
                        </label>
                      </div>
                      <span class="text-2">Show only active drivers in the listing</span>
                    </div>

                    <div class="col-5">
                      <div class="radio">
                        <label>
                          <input type="radio" name="ad" id="ad" class="driver-type" />
                          Active/Inactive Drivers
                        </label>
                      </div>
                      <span class="text-2">Show all drivers in the listing</span>
                    </div>
                  </div>
                </div>

                <!-- driver status -->

                <div id="dstatusset" class="tab-pane">
                  <div class="row">
                    <div class="col-10">
                      <p class="text-4 font-weight-bold text-dark">
                        Activate or deactivate your drivers
                      </p>
                    </div>
                    <div class="col-2 text-right">
                      <a routerLink="/manage/settings/driver" class="btn btn-success btn-sm modal-with-form"><i class="fas fa-plus"></i> Assign New Status</a>
                    </div>

                    <!--
								 <div id="changedsts" class="modal-block modal-block-primary mfp-hide">
									<section class="card">
										<header class="card-header">
											<h2 class="card-title">Activate or Deactivate Your Drivers</h2> </header>
										<div class="card-body text-dark">
											<form>
												<div class="form-row">
													<div class="col-lg-12">
														<label class="control-label font-weight-semibold labelmt text-3 text-dark">Driver*</label>
														<input type="text" placeholder="Search any driver here" class="form-control">
													</div>
												</div>


												<div class="form-row">
													<div class="col-lg-12">
														<label class="control-label font-weight-semibold labelmt text-3 text-dark">Status</label>
														<select data-plugin-selectTwo class="form-control populate" id="groupType" onChange="groupTypeFn()">
															<optgroup label="">
																<option value="1">Active</option>
																<option value="2">Inactive</option>
															</optgroup>
														</select>
													</div>
												</div>



											</form>
										</div>
										<footer class="card-footer">
											<div class="row">
												<div class="col-md-12 text-right">
													<button class="btn btn-default modal-dismiss">Cancel</button>
													<button class="btn btn-success modal-confirm">Save</button>
												</div>
											</div>
										</footer>
									</section>
								</div>
                            -->

                    <div class="col-12">
                      <table class="table table-striped table-bordered simple-table">
                        <thead>
                          <tr style="background-color: #ccc">
                            <th>Driver</th>
                            <th>Status</th>
                            <th>Date/Time</th>
                            <th>Active/Deactive</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>Gaurav Sharma</td>
                            <td>Active</td>
                            <td>10/03/2020, 07:20 PM</td>
                            <td>
                              <label class="switch">
                                <input type="checkbox" checked />
                                <span class="sliderbtn round"></span>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td>Micky</td>
                            <td>Inactive</td>
                            <td>10/05/2020, 10:25 AM</td>
                            <td>
                              <label class="switch">
                                <input type="checkbox" checked />
                                <span class="sliderbtn round"></span>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td>Harry</td>
                            <td>Active</td>
                            <td>14/02/2020, 11:45 AM</td>
                            <td>
                              <label class="switch">
                                <input type="checkbox" checked />
                                <span class="sliderbtn round"></span>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td>Methew Wade</td>
                            <td>Inactive</td>
                            <td>30/07/2020, 05:10 PM</td>
                            <td>
                              <label class="switch">
                                <input type="checkbox" checked />
                                <span class="sliderbtn round"></span>
                              </label>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>


                <section class="m-2">
                  <div class="row mb-3">
                    <div class="col-lg-12">
                      <div class="form-group row pt-3">
                        <div class="col-lg-12" style="height: calc(90vh - 149px); overflow-y: scroll">
                          <p-table #dt [value]="drivers" [resizableColumns]="true" columnResizeMode="expand" scrollDirection="both" [columns]="selectedColumns" [loading]="!loaded" styleClass="p-datatable-sm p-datatable-gridlines p-datatable-striped" [scrollable]="true" [loading]="!loaded" scrollHeight="100%">
                            <!-- Caption template of data table -->
                            <ng-template pTemplate="caption">
                              <div class="p-d-flex d-flex justify-content-between align-items-center">
                                <div>
                                  <h3 class="m-0"> Deleted Drivers</h3>
                                </div>
                                <div class="text-right">
                                  <span>Showing {{ drivers.length }} entries </span>
                                  &nbsp;
                                  <button type="button" pButton (click)="refreshData()" pTooltip="Refresh" class="p-button-outlined mr-2" icon="fas fa-sync"></button>
                                  <button pButton pRipple pTooltip="Clear Filter" class="p-button-outlined mr-2" icon="pi pi-filter-slash" (click)="clear(dt)"></button>

                                  <p-multiSelect [options]="dataColumns" [(ngModel)]="selectedColumns" optionLabel="header" selectedItemsLabel="{0} columns selected" [style]="{ minWidth: '200px' }" placeholder="Choose Columns">
                                  </p-multiSelect>
                                </div>
                              </div>
                            </ng-template>
                            <ng-template pTemplate="header" let-columns>
                              <tr>
                                <th *ngFor="let dataColumns of columns" [pSortableColumn]="dataColumns.field" pResizableColumn [ngStyle]="{ width: dataColumns.width }">
                                  <div [ngSwitch]="dataColumns.field" [ngStyle]="{ width: dataColumns.width }">
                                    <!-- Driver Status Filter Customization -->
                                    <span *ngSwitchCase="'driverStatus'">
                                      <div class="flex justify-content-center align-items-center" alignFrozen="left" pFrozenColumn [frozen]="true">
                                        {{ dataColumns.header }}
                                        <p-sortIcon [field]="dataColumns.field"></p-sortIcon>
                                        <p-columnFilter [type]="dataColumns.type" [field]="dataColumns.field" [showOperator]="false" matchMode="contains" [showMatchModes]="false" [showAddButton]="false" display="menu">
                                          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                            <p-multiSelect [options]="[
                                        { name: 'Active', value: 'active' },
                                        { name: 'InActive', value: 'inActive' }
                                      ]" placeholder="Any" (onChange)="filter($event.value)" optionLabel="name" optionValue="value">
                                              <ng-template let-option pTemplate="item">
                                                <div>
                                                  <span class="ml-1">{{
                                            option.name
                                          }}</span>
                                                </div>
                                              </ng-template>
                                            </p-multiSelect>
                                          </ng-template>
                                        </p-columnFilter>
                                      </div>
                                    </span>

                                    <span *ngSwitchDefault>
                                      <div class="flex justify-content-center align-items-center" alignFrozen="right" pFrozenColumn [frozen]="true">
                                        {{ dataColumns.header }}
                                        <p-sortIcon [field]="dataColumns.field"></p-sortIcon>
                                        <p-columnFilter [type]="dataColumns.type" [field]="dataColumns.field" matchMode="contains" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false" display="menu">
                                        </p-columnFilter>
                                      </div>
                                    </span>
                                  </div>
                                </th>
                                <th style="width: 105px" alignFrozen="right" pFrozenColumn [frozen]="true">
                                  Actions
                                </th>
                              </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-driver let-columns="columns" let-rowIndex="rowIndex">
                              <tr>
                                <td *ngFor="let dataColumns of columns" [ngStyle]="{ width: dataColumns.width }" style="height: 40px; cursor: pointer">
                                  <div [ngSwitch]="dataColumns.field">
                                    <span *ngSwitchCase="'firstName'">
                                      {{ driver.firstName }}
                                      {{ driver.middleName }}
                                      {{ driver.lastName }}
                                    </span>
                                    <span *ngSwitchCase="'driverType'">
                                      {{ driver[dataColumns.field] | titlecase }}
                                    </span>
                                    <span *ngSwitchCase="'startDate'">
                                      {{
                                driver[dataColumns.field]
                                  ? driver[dataColumns.field]
                                  : "-"
                              }}
                                    </span>
                                    <span *ngSwitchCase="'licenceExpiry'">
                                      {{
                                driver[dataColumns.field]
                                  ? driver[dataColumns.field]
                                  : "-"
                              }}
                                    </span>
                                    <span *ngSwitchCase="'licStateName'">
                                      {{
                                driver[dataColumns.field]
                                  ? driver[dataColumns.field]
                                  : "-"
                              }}
                                    </span>
                                    <span *ngSwitchCase="'driverStatus'" class="badge badge-dark p-1 text-uppercase">
                                      {{ driver[dataColumns.field] | titlecase }}
                                    </span>

                                    <span *ngSwitchDefault>
                                      {{ get(driver, dataColumns.field) }}</span>
                                  </div>
                                </td>
                                <td style="width: 6%; overflow: inherit !important" pFrozenColumn alignFrozen="right" [frozen]="true">
                                  <div class="dropdown dropright">
                                    <button (click)="rm.toggle($event)" class="bg-transparent border-0" type="button" id="dropdownMenuButton-{{ rowIndex }}">
                                      <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <p-overlayPanel #rm [showCloseIcon]="true">
                                      <ng-template pTemplate>
                                        <a (click)="rm.hide(); restoreDriver(driver)" style="text-align:left" class="dropdown-item text-4">Restore</a>
                                      </ng-template>
                                    </p-overlayPanel>
                                  </div>
                                </td>
                              </tr>
                            </ng-template>
                            <!-- Empty Template -->

                            <ng-template pTemplate="emptymessage" let-columns>
                              <div class="col-lg-12 mt-3 text-center">
                                {{ dataMessage }}
                                <br /><br />
                              </div>
                            </ng-template>

                            <ng-template pTemplate="summary" let-columns>
                              <div class="col-lg-12 mt-3 text-center" *ngIf="lastEvaluatedKey !== 'end' && drivers.length !== 0">
                                <button type="button " (click)="onScroll($event)" class="btn btn-success btn-sm text-light">
                                  Load More..
                                </button>
                                <br /><br />
                              </div>
                              <div class="col-lg-12 mt-3 text-center" *ngIf="lastEvaluatedKey !== 'end'">
                                Total Records: {{ drivers.length }}
                              </div>
                              <div class="col-lg-12 mt-3 text-center" *ngIf="lastEvaluatedKey === 'end'">
                                Total Records: {{ drivers.length }}
                              </div>
                            </ng-template>
                          </p-table>
                        </div>
                      </div>

                    </div>
                  </div>
                </section>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</section>