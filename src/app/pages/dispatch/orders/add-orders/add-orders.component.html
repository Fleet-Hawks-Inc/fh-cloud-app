<style>
  @media (min-width: 576px) {
 .modal-dialog { max-width: none; }
}

  .modal-dialog {
     width: 100%;
     height: 100%;
     margin: 0;
     padding: 0;
  }


  .modal-content {
     height: auto;
     min-height: 100%;
     border-radius: 0;
  }
  .modal-body {
     position: 'fixed';
       top : '0px';

  }
</style>

<section class="body" (click)="resetSearch()">
  <div class="inner-wrapper">
     <section role="main" class="content-body p-0">
        <header class="page-header">
           <div class="row" style="padding-top:10px;">
              <div class="col-md-4 col-lg-4">
                 <h4 class="text-4 font-weight-bold mt-0 mb-0 text-dark">{{pageTitle}} {{getOrderNumber}}</h4>
              </div>
              <div class="col-md-8 col-lg-8 text-right">
                 <!--- <a class="btn btn-success btn-sm modal-with-form" href="#bolTemplateModal">Create BOL</a>  -->
                 <a routerLink="/dispatch/orders" class="btn btn-default btn-sm"><i class="fas fa-list"></i> All Orders</a>
              </div>
           </div>
        </header>
        <div class="m-2">
         <div class="card">
            <div class="card-body bg-transparent p-0">
               <form class="form-horizontal form-bordered" novalidate #aOrder1="ngForm">
                     <!--<div class="form-group row">

                     <div class="col-lg-5 offset-lg-1">

                     </div>
                     <div class="col-lg-6">

                        <div class="row">
                           <div class="col-lg-3 col-sm-12 col-xs-12 col-12 labelalign">
                              <label class="control-label font-weight-bold mb-0 text-3 text-dark">Trip Type</label>
                           </div>
                           <div class="col-lg-6">
                              <div class="btn-group-toggle" data-toggle="buttons">
                                 <label class="btn btn-outline btn-fleet mr-2"
                                    [class.active]="orderData.tripType === 'Regular'" style="width:110px;"
                                    (click)="onChangeUnitType('trip', 'Regular')">
                                    <input type="radio" [(ngModel)]="orderData.tripType" name="tripType" checked hidden
                                       value="Regular"> Regular </label>
                                 <label class="btn btn-outline btn-fleet mr-2 " style="width:110px;"
                                    [class.active]="orderData.tripType === 'Outsourced'"
                                    (click)="onChangeUnitType('trip', 'Outsourced')">
                                    <input type="radio" [(ngModel)]="orderData.tripType" name="tripType" hidden
                                       value="Outsourced"> Outsourced </label>
                              </div>
                               <label class="d-inline mr-3">
                                 <input [(ngModel)]="orderData.tripType" type="radio" name="tripType"
                                    value="Regular">Regular
                              </label>
                              <label>
                                 <input [(ngModel)]="orderData.tripType" type="radio" name="tripType"
                                    value="Outsourced">Outsourced
                              </label>
                           </div>
                        </div>
                     -->

                     <!-- <div class="row justify-content-center">
                        <div class="col-lg-8">
                           <button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
                              Launch demo modal
                           </button>
                        </div>
                     </div>




                              <div class="modal fade" id="myModal" tabindex="-1" role="dialog"
                                 aria-labelledby="myModalLabel" aria-hidden="true">
                                 <div class="modal-dialog">
                                    <div class="modal-content">
                                       <div class="modal-header">
                                          <button type="button" class="close" data-dismiss="modal"
                                             aria-hidden="true">&times;</button>
                                          <h4 class="modal-title" id="myModalLabel">Modal title</h4>
                                       </div>
                                       <div class="modal-body">
                                         <app-pdfautomation></app-pdfautomation>

                                       </div>
                                       <div class="modal-footer">
                                          <button type="button" class="btn btn-default"
                                             data-dismiss="modal">Close</button>
                                          <button type="button" class="btn btn-primary">Save changes</button>
                                       </div>
                                    </div>
                                 </div>
                              </div>

                     </div>
                  </div>-->

                  <div class="bg-white p-3 text-dark mb-3">
                     <div class="row pt-2">
                        <div class="col-lg-1 offset-lg-1 col-sm-12 col-xs-12 col-12">
                           <label class="control-label font-weight-bold mb-0 text-3 text-dark">Load Type</label>
                        </div>
                        <div class="col-lg-6">
                           <div class="btn-group-toggle" data-toggle="buttons">
                              <label class="btn btn-outline btn-yesno mr-2 mb-2"
                                 [class.active]="orderData.orderMode === 'FTL'"
                                 (click)="onChangeUnitType('order', 'FTL')">
                                 <input type="radio" [(ngModel)]="orderData.orderMode" name="orderMode" checked
                                    hidden value="FTL"> FTL </label>
                              <label class="btn btn-outline btn-yesno mr-2 mb-2"
                                 [class.active]="orderData.orderMode === 'LTL'"
                                 (click)="onChangeUnitType('order', 'LTL')">
                                 <input type="radio" [(ngModel)]="orderData.orderMode" name="orderMode" hidden
                                    value="LTL"> LTL </label>
                           </div>
                        </div>
                     </div>
                     <div class="form-group row mt-3">
                        <div class="col-lg-10 offset-lg-1">
                           <h4 class="mt-0 text-dark font-weight-bold text-5">Customer</h4>
                        </div>
                        <div class="col-lg-4 offset-lg-1 pr-0">

                           <div class="row">
                              <div class="col-lg-11">
                                 <label
                                    class="control-label font-weight-bold labelmt text-3 text-dark">Customer
                                    <span class="mandfield text-2 ml-1"><sup>*</sup></span>
                                 </label>
                                 <ng-select (change)="selectedCustomer($event)" [(ngModel)]="orderData.customerID"

                                    name="orderData.customerID" #customerID="ngModel" required customerID placeholder="Select Customer" class="form-control" #customer="ngModel" required>
                                    <ng-option *ngFor="let customer of customers | async" value="{{customer.contactID}}">
                                       {{customer.companyName}}

                                    </ng-option>
                                 </ng-select>

                                 <div *ngIf="customer.invalid && (customer.dirty || customer.touched)" class="text-danger">
                                    <div>

                                      <div *ngIf="customer.errors.required">
                                       Customer is required.
                                       </div>
                                    </div>

                                  </div>

                              </div>
                              <div class="col-lg-1 mar-top-37 pl-0">
                                 <a class="btn btn-success btn-sm text-light" data-dismiss="modal" data-toggle="modal" data-target="#addOrderCustomerModal"><i
                                       class="fas fa-plus"></i>
                                 </a>
                              </div>
                              <div class="col-11"  *ngIf="notOfficeAddress">
                                 <div class="rounded p-2 mt-2" style="background-color:#e1e2e3;">
                                    There is no office address of this customer
                                 </div>
                              </div>

                              <div class="col-lg-11 mt-4" *ngIf="customerSelected.officeAddr">
                                 <div class="" style="border: 0.4px solid #e1e2e3; border-radius: 0px 0px 15px 15px;">
                                    <div class="row pl-3 pr-3">
                                       <div class="col-lg-6" style="background-color:#e1e2e3;">
                                          <h5 class=" font-weight-bold">Details</h5>
                                       </div>
                                       <div class="col-lg-6 text-right" style="background-color:#e1e2e3;">
                                          <!-- <button type="button" class="btn btn-default btn-xs mt-2" data-toggle="modal" data-target="#addressModal"><i class="fas fa-pencil-alt"></i>Edit</button> -->
                                       </div>
                                    </div>
                                    <div class="row pl-3 pr-3">
                                       <div class="col-lg-12">

                                          <div class="" *ngFor="let address of customerSelected.address">
                                             <div class="row" *ngIf="address.addressType =='Office'">
                                                <div class="col-lg-6">
                                                   <label class="control-label" *ngIf="address.manual"><span class=" font-weight-bold">Address:</span>
                                                      {{address.address1}}
                                                      {{address.address2}}</label>

                                                   <label class="control-label" *ngIf="!address.manual"><span class=" font-weight-bold">Address:</span>
                                                      {{address.userLocation}}</label>
                                                </div>
                                                <div class="col-lg-6">
                                                   <label class="control-label"><span class=" font-weight-bold">Phone:</span> {{customerSelected.phone}}</label>
                                                </div>
                                                <div class="col-lg-6">
                                                   <label class="control-label"><span class=" font-weight-bold">City:</span>
                                                      {{address.cityName}}</label>
                                                </div>
                                                <div class="col-lg-6">
                                                   <label class="control-label"><span class=" font-weight-bold">Province:</span>
                                                      {{address.stateName}}</label>
                                                </div>
                                                <div class="col-lg-6">
                                                   <label class="control-label"><span class=" font-weight-bold">Country:</span>
                                                      {{address.countryName}}</label>
                                                </div>
                                                <div class="col-lg-6">
                                                   <label class="control-label"><span class=" font-weight-bold">Email:</span>
                                                      {{customerSelected.email}}</label>
                                                </div>
                                             </div>

                                          </div>


                                       </div>

                                    </div>
                                 </div>
                              </div>
                           </div>

                        </div>
                        <div class="col-lg-4 pr-0 offset-lg-2">
                           <div class="row">

                              <div class="col-12">
                                 <label class="control-label font-weight-bold labelmt text-3 text-dark">Customer
                                    PO#
                                 </label>
                                 <input  placeholder="eg. 0006,123" [(ngModel)]="orderData.customerPO" name="customerPO" #customerPO="ngModel" required customerPO type="text"
                                    class="form-control" #orderNum="ngModel" required pattern="^[0-9]+$">

                              </div>
                           </div>

                           <div class="row mt-2">
                              <div class="col-lg-6">
                                 <label class="control-label font-weight-bold labelmt text-3 text-dark">Additonal Contact</label>

                                 <ng-select [(ngModel)]="orderData.additionalContact" name="orderData.additionalContact" class="form-control populate"
                                    placeholder="Select Additonal Contact" (change)="setAdditionalContact($event)">
                                    <ng-option value="{{ data.fullName }}" *ngFor="let data of customerSelected.additionalContact">{{ data.fullName }}</ng-option>
                                 </ng-select>

                              </div>
                              <div class="col-lg-6">
                                 <label class="control-label font-weight-bold labelmt text-3 text-dark">Phone</label>
                                 <input placeholder="eg. 2234567891" [(ngModel)]="orderData.phone" name="order_phone" type="text" class="form-control"  >

                              </div>
                           </div>
                           <div class="row mt-2">

                              <div class="col-lg-6">
                                 <label class="control-label font-weight-bold labelmt text-3 text-dark">Email</label>
                                 <input placeholder="eg. johnsmith@gmail.com"[(ngModel)]="orderData.email" name="email" type="text" class="form-control" >

                              </div>
                              <div class="col-lg-6">
                                 <label
                                    class="control-label font-weight-bold labelmt text-3 text-dark">Reference</label>
                                 <input placeholder="eg. 024933435" [(ngModel)]="orderData.reference" name="order_reference" type="text"
                                    class="form-control" >
                              </div>

                           </div>

                        </div>
                     </div>
                  </div>
                  <div class="row mb-3">
                     <div class="col-12">
                        <div class="bg-white p-3 text-dark">
                           <div class="form-group row border-bottom-0 mb-0">
                              <div class="col-lg-12 mb-4 mb-lg-0">
                                 <div *ngFor="let item of shippersReceivers; let i = index;">
                                    <div class="row">
                                       <div class="col-lg-5 offset-lg-1">
                                          <h4 class="mt-0 text-dark font-weight-bold text-5">Shipment-{{i + 1}}</h4>
                                       </div>
                                    </div>

                                    <div class="row">
                                       <div class="col-lg-4 pr-0 offset-lg-1">
                                          <div class="shipper__listing" *ngIf="finalShippersReceivers[i].shippers?.length > 0">
                                             <h4 class="mt-0 text-dark font-weight-bold text-4 px-2 mb-0" style="background-color: #999896;">Shipper</h4>
                                             <table class="table table-bordered">
                                                <tbody>

                                                   <tr *ngFor="let list of finalShippersReceivers; let j = index;">
                                                      <td class="p-0 border-0">
                                                         <table class="border-0 w-100">
                                                            <tbody>
                                                               <tr *ngFor="let ship of list.shippers; let k = index;">
                                                                  <td class="" style="min-width: 100px;">
                                                                     {{shippersObjects[ship.shipperID]}}
                                                                  </td>
                                                                  <td class="p-0" style=" min-width: 300px;">
                                                                     <table class="border-0 w-100">
                                                                        <tr *ngFor="let point of ship.pickupPoint;">
                                                                           <td class="border-left-0 border-top-0 border-bottom" style=" min-width: 250px;max-width: 250px;">
                                                                              <span *ngIf="!point.address.manual">{{point.address.pickupLocation}}</span>
                                                                              <span *ngIf="point.address.manual">{{point.address.address}}, {{point.address.city}}, {{point.address.state}}, {{point.address.country}} {{point.address.zipCode}}</span>
                                                                           </td>
                                                                           <td class="border-top-0 border-bottom border-left-0 border-right-0">
                                                                              {{point.dateAndTime | date:'yyyy/MM/dd hh:mm a'}}
                                                                           </td>
                                                                           
                                                                        </tr>
                                                                     </table>
                                                                  </td>
                                                                  <td style="min-width: 70px;">
                                                                     <i (click)="editList('shipper', i, k)" class="fa fa-edit fa-fw"></i>
                                                                     <i (click)="removeList('shipper', i, k)" class="fa fa-trash fa-fw"></i>
                                                                  </td>
                                                               </tr>
                                                            </tbody>
                                                         </table>
                                                      </td>
                                                      
                                                      
                                                      
                                                   </tr>

                                                </tbody>
                                             </table>
                                          </div>
                                       </div>
                                       <div class="col-lg-4 pr-0 offset-lg-2">
                                          <div class="shipper__listing" *ngIf="finalShippersReceivers[i].receivers?.length > 0">
                                             <h4 class="mt-0 text-dark font-weight-bold text-4 px-2 mb-0" style="background-color: #999896;">Receiver </h4>
                                             <table class="table table-bordered">
                                                <tbody>
                                                   <tr *ngFor="let list of finalShippersReceivers; let j = index;">
                                                      <td class="p-0 border-0">
                                                         <table class="border-0 w-100">
                                                            <tbody>
                                                               <tr *ngFor="let receive of list.receivers; let k = index;">
                                                                  <td class=""  style="min-width: 100px;">
                                                                     {{receiversObjects[receive.receiverID]}}
                                                                  </td>
                                                                  <td class="p-0"  style="min-width: 300px;">
                                                                     <table class="border-0 w-100">
                                                                        <tr *ngFor="let point of receive.dropPoint;">
                                                                           <td class="border-left-0 border-top-0 border-bottom"  style="min-width: 250px; max-width: 250px;">
                                                                              <span *ngIf="!point.address.manual">{{point.address.dropOffLocation}}</span>
                                                                              <span *ngIf="point.address.manual">{{point.address.address}}, {{point.address.city}}, {{point.address.state}}, {{point.address.country}} {{point.address.zipCode}}</span>
                                                                           </td>
                                                                           <td class="border-top-0 border-bottom border-left-0 border-right-0">
                                                                              {{point.dateAndTime | date:'yyyy/MM/dd hh:mm a'}}
                                                                           </td>
                                                                           
                                                                        </tr>
                                                                     </table>
                                                                  </td>
                                                                  <td style="min-width: 70px;">
                                                                     <i (click)="editList('receiver', i, k)" class="fa fa-edit fa-fw"></i>
                                                                     <i (click)="removeList('receiver', i, k)" class="fa fa-trash fa-fw"></i>
                                                                  </td>
                                                               </tr>
                                                            </tbody>
                                                         </table>
                                                      </td>
                                                   </tr>
                                                  

                                                </tbody>
                                             </table>
                                          </div>
                                       </div>
                                    </div>
                                    <div class="form-group row divderrel">
                                       <!-- <p class="mb-1 mt-3 mr-1 midleicon btn btn-default"><i
                                             class="fas fa-arrow-circle-right"></i></p> -->

                                             <div class="col-lg-5 offset-lg-1">
                                                <h4 class="mt-0 text-dark font-weight-bold text-4">Add Shipper</h4>
                                             </div>

                                             <div class="col-lg-5 offset-lg-1">
                                                <h4 class="mt-0 text-dark font-weight-bold text-4">Add Receiver</h4>
                                             </div>


                                       <div class="col-lg-4 pr-0 offset-lg-1">

                                          <div class="">
                                             <div class="">
                                                <section>
                                                   <div id="collapseShipperArea-{{i}}" class="collapse show">
                                                      <div class="row mr-4">

                                                         <div class="col-lg-11 col-md-12">
                                                            <label
                                                               class="control-label font-weight-bold labelmt text-3 text-dark"
                                                               for="inputDefault">Shipper <span class="mandfield text-2 ml-1"><sup>*</sup></span>
                                                            </label>

                                                            <ng-select [(ngModel)]="item.shippers.shipperID"
                                                               name="shipperID_{{i}}"  placeholder="Select Shipper" class="form-control" #conSlt1="ngModel" required>

                                                                  <ng-option *ngFor="let item of shippers | async" value="{{item.contactID}}">{{item.companyName}}</ng-option>

                                                            </ng-select>
                                                            <div *ngIf="conSlt1.touched && (shippersReceivers[0].shippers.shipperID == null || shippersReceivers[0].shippers.shipperID == '') && finalShippersReceivers[0].shippers.length == 0" class="text-danger">
                                                               Shipper is required.
                                                           </div>

                                                         </div>
                                                         <div class="col-lg-1 mar-top-37  pl-0">
                                                            <a data-toggle="modal" data-target="#addShipperModal" href="javascript:;"
                                                               class="modal-with-form btn btn-sm btn-success">
                                                               <em class="fas fa-plus"></em>
                                                           </a>
                                                         </div>
                                                      </div>
                                                      <div class="addsr-scrollbar addsr-scroll-y pickup-location__main">
                                                         <div *ngFor="let pick of item.shippers.pickupPoint; let w = index;" [ngClass]="{'p-3 bg-grey mt-2': w != 0}">
                                                            <div class="row mt-3 mr-4">

                                                               <div class="col-lg-11 col-md-11">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Pickup Location <span class="mandfield text-2 ml-1"><sup>*</sup></span>
                                                                  </label>
      
                                                                  <input placeholder="eg. Calgary,Alberta" [disabled]="pick.address.manual" [(ngModel)]="pick.address.pickupLocation"
                                                                     name="pickupLocation_{{w}}" (keyup)="searchTerm.next($event);"
                                                                     class="form-control " #pickupLocation="ngModel" required
                                                                     pickupLocation tabindex="-1" aria-hidden="true" autocomplete="off"
                                                                     #location="ngModel" required>
      
                                                                     <!-- <div *ngIf="pickupLocation.touched && shippersReceivers[0].shippers.pickupLocation == '' && finalShippersReceivers[0].shippers.length == 0" class="text-danger">
      
                                                                         Pickup location is required.
      
                                                                     </div> -->
                                                                     
                                                                  <div class="map-search__results bg-white row mt-3 mar-top-30 ml-0" style="width: 93%" *ngIf=searchResults>
                                                                     <ul class="p-0 m-0 text-left">
                                                                        <li *ngFor="let item of searchResults;">
                                                                           <a href="javascript:;" (click)="assignLocation(i, w, 'shipper', item.address.label)"
                                                                              title="{{item.address.label}}">{{item.address.label}}</a>
                                                                        </li>
                                                                     </ul>
                                                                  </div>
                                                               </div>
                                                               <div class="col-lg-1 mar-top-37  pl-0">
                                                                  <a (click)="addPickUpPoint(i, 'shipper')" *ngIf="w == 0" href="javascript:;" class="modal-with-form btn btn-sm btn-success">
                                                                     <em class="fas fa-plus"></em>
                                                                  </a>
                                                                  <a (click)="removePickUpPoint(i, w, 'shipper')" *ngIf="w != 0" href="javascript:;" class="modal-with-form btn btn-sm btn-danger">
                                                                     <em class="fas fa-minus"></em>
                                                                  </a>
                                                               </div>
                                                               <div class="col-lg-4 text-center">
                                                                  <div class="checkbox-custom checkbox-default pl-0">
                                                                     <input type="checkbox" [(ngModel)]="pick.address.manual"
                                                                     name="manual_{{w}}" (change)="manualAddress($event.target.checked, i, w, 'shipper')"  id="locationaddBtn">
                                                                     <label class="control-label mt-2 font-weight-bold pl-3" for="locationaddBtn"> Type Manually</label>
                                                                  </div>
                                                               </div>
                                                               <div class="col-lg-6 text-center">
                                                                  <div class="checkbox-custom checkbox-default pl-0">
                                                                     <input [(ngModel)]="pick.unit"
                                                                     name="unit_{w}}" type="checkbox" id="locationaddBtn3">
                                                                     <label class="control-label mt-2 font-weight-bold pl-3" for="locationaddBtn3"> Type Unit Number Manually</label>
                                                                  </div>
                                                               </div>
                                                            </div>
                                                            <div class="row mt-3 mr-4" *ngIf="pick.unit">
                                                               <div class="col-lg-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">Unit Number</label>
                                                                  <input [(ngModel)]="pick.unitNumber"
                                                                  name="unitNumber_{{w}}" type="text" class="form-control" placeholder="Unit Number">
                                                               </div>
                                                            
                                                               <div class="col-12 pl-4 pr-4">
                                                                  <div class="row">
                                                                     <div class="col-12 bordbtm">
                                                                        &nbsp;
                                                                     </div>
                                                                  </div>
                                                               </div>
                                                            
                                                            </div>
                                                            <div class="row mt-3 mr-4" *ngIf="pick.address.manual">
                                                               <div class="col-lg-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">Address</label>
                                                                  <input [(ngModel)]="pick.address.address"
                                                                  name="address_{{w}}" type="text"  class="form-control" placeholder="type address">
                                                               </div>
                                                            
                                                               <div class="col-lg-6 pull-left">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">City</label>
                                                                  <input [(ngModel)]="pick.address.city"
                                                                  name="city_{{w}}" type="text" class="form-control" placeholder="toronto">
                                                               </div>
                                                               <div class="col-lg-6 pull-left">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">State</label>
                                                                  <input [(ngModel)]="pick.address.state"
                                                                  name="state_{{w}}" type="text" class="form-control" placeholder="ON">
                                                               </div>
                                                               <div class="col-lg-6 pull-left">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">Country</label>
                                                                  <input [(ngModel)]="pick.address.country"
                                                                  name="country_{{w}}" type="text" class="form-control" placeholder="canada">
                                                               </div>
                                                               <div class="col-lg-6 pull-left">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">Zip Code</label>
                                                                  <input [(ngModel)]="pick.address.zipCode"
                                                                  name="zipCode_{{w}}" type="text" class="form-control" placeholder="V6C 1Z6">
                                                               </div>
                                                               <div class="col-12 pl-4 pr-4 pull-left">
                                                                  <div class="row">
                                                                     <div class="col-12 bordbtm">
                                                                        &nbsp;
                                                                     </div>
                                                                  </div>
                                                               </div>
                                                            
                                                            </div>
                                                            <div class="row mt-3 mr-4">
                                                               <div class="col-lg-12 col-md-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Pick Date and Time <span class="mandfield text-2 ml-1"><sup>*</sup></span>
                                                                  </label>
                                                               </div>
                                                               <div class="col-lg-6">
      
      
                                                                  <div class="input-group">
      
                                                                        <input [(ngModel)]="pick.pickupDate" name="pickupDate_{{w}}" type="text"
                                                                        placeholder="yyyy/mm/dd" (click)="pickupDate.toggle()" ngbDatepicker #pickupDate="ngbDatepicker"
                                                                        class="form-control" autocomplete="off" #orderDate1="ngModel" required [minDate]="dateMinLimit" [maxDate]="futureDatesLimit">
      
      
                                                                  </div>
                                                                  <!-- <div *ngIf="orderDate1.touched && (shippersReceivers[0].shippers.pickupDate == null || shippersReceivers[0].shippers.pickupDate == '') && finalShippersReceivers[0].shippers.length == 0" class="text-danger">
      
                                                                      Pickup date required.
      
                                                                 </div> -->
      
                                                               </div>
                                                               <div class="col-lg-6">
                                                                  <div class="input-group">
                                                                     <input [(ngModel)]="pick.pickupTime"
                                                                        name="pickupTime_{{w}}" type="time" class="timepicker form-control" placeholder=""
                                                                        #pickupTime="ngModel" required pickupTime
                                                                        />
                                                                     <!-- <input [(ngModel)]="item.pickupTime"
                                                                     name="item.pickupTime{{i}}" type="text" class="form-control" placeholder="hour:minute"  #pickupTime="ngModel" required pickupTime id="timepicker2"> -->
                                                                  </div>
                                                                  <!-- <div *ngIf="pickupTime.touched && (shippersReceivers[0].shippers.pickupTime == null || shippersReceivers[0].shippers.pickupTime == '') && finalShippersReceivers[0].shippers.length == 0" class="text-danger">
      
                                                                     Pickup time is required.
      
                                                                </div> -->
                                                               </div>
                                                               <!-- <div class="col-lg-3 mt-1">
                                                               </div> -->
                                                            </div>
                                                            <div class="row mt-3 mr-4">
      
                                                               <div class="col-lg-12 col-md-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Pickup Instruction</label>
      
                                                                  <textarea placeholder="eg. Enter pickup instruction" [(ngModel)]="pick.pickupInstruction"
                                                                     name="pickupInstruction_{{w}}" class="form-control h-auto" rows="2" #Pickup1= "ngModel" pattern ="^[\s\S]{500}$"
                                                                     ></textarea>
      
                                                               </div>
      
                                                            </div>
                                                            <div class="row mt-3 mr-4">
      
                                                               <div class="col-lg-12 col-md-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Contact Person at Pickup
                                                                     <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span> -->
                                                                  </label>
      
                                                                  <input placeholder="eg. John Smith" [(ngModel)]="pick.contactPerson"
                                                                     name="shippers.contactPerson_{{w}}" type="text" class="form-control"
                                                                     id="inputDefault" >
      
                                                               </div>
      
                                                            </div>
                                                            <div class="row mt-3 mr-4">
      
                                                               <div class="col-lg-12 col-md-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Phone
                                                                     <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span> -->
                                                                  </label>
      
                                                                  <input placeholder="eg. 2234567891" [(ngModel)]="pick.phone" name="shippers.phone_{{w}}"
                                                                     type="text" class="form-control" id="inputDefault" >
      
                                                               </div>
      
                                                            </div>
      
      
                                                            <div *ngFor="let commodity of pick.commodity; let z = index;">
                                                               <div class="row mt-3 mr-4">
                                                                  <div class="col-lg-12">
                                                                     <label class="control-label font-weight-bold labelmt text-3 text-dark">Commodity
                                                                        <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span> -->
                                                                     </label>
                                                                  </div>
      
                                                                  <div class="col-lg-11">
      
                                                                     <input placeholder="eg. cakes" type="text" [(ngModel)]="commodity.name" name="name_{{w}}{{z}}" class="form-control" >
      
                                                                  </div>
                                                                  <div class="col-lg-1 text-right mt-1 pl-0">
                                                                     <a class="btn btn-danger btn-sm" href="javascript:;" *ngIf="z != 0" (click)="removeCommodity('shipper', i, w, z)"><i class="fas fa-minus"></i> </a>
                                                                     <a class="btn btn-success btn-sm" href="javascript:;" *ngIf="z == 0" (click)="addCommodity('shipper', i, w)"><i class="fas fa-plus"></i></a>
                                                                  </div>
                                                               </div>
      
                                                               <div class="row mt-3 mr-4">
      
                                                                  <div class="col-lg-12 col-md-12">
                                                                     <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                        >PU# &nbsp;<i class="fas fa-question-circle" data-toggle="tooltip"
                                                                        data-placement="top"
                                                                        title="Pickup Number"></i>
      
                                                                        <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span> -->
                                                                     </label>
      
                                                                     <input placeholder="eg. 1348,0096" [(ngModel)]="commodity.pu"
                                                                        name="pu{{z}}" type="text" class="form-control" >
      
                                                                  </div>
      
                                                               </div>
      
                                                               <div class="row mt-3 mr-4">
                                                                  <div class="col-lg-12">
                                                                     <label class="control-label font-weight-bold labelmt text-3 text-dark">Quantity
                                                                        <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span> -->
                                                                     </label>
                                                                  </div>
                                                                  <div class="col-lg-6">
      
                                                                     <input placeholder="eg. 20,400" type="text" [(ngModel)]="commodity.quantity" name="quantity_{{w}}{{z}}" class="form-control" >
      
                                                                  </div>
      
      
                                                                  <div class="col-lg-6">
      
                                                                     <ng-select dropdownPosition='top' [(ngModel)]="commodity.quantityUnit" name="quantityUnit_{{w}}{{z}}" placeholder="eg. select quantity"class="form-control">
                                                                           <ng-option value="Bag" data-select2-id="21">Bag</ng-option>
                                                                           <ng-option value="Bale" data-select2-id="285">Bale</ng-option>
                                                                           <ng-option value="Barrel" data-select2-id="286">Barrel</ng-option>
                                                                           <ng-option value="Basket" data-select2-id="287">Basket</ng-option>
                                                                           <ng-option value="Bin" data-select2-id="288">Bin</ng-option>
                                                                           <ng-option value="Box" data-select2-id="289">Box</ng-option>
                                                                           <ng-option value="Bucket" data-select2-id="290">Bucket</ng-option>
                                                                           <ng-option value="Can" data-select2-id="291">Can</ng-option>
                                                                           <ng-option value="Crate" data-select2-id="292">Crate</ng-option>
                                                                           <ng-option value="Cases" data-select2-id="293">Cases</ng-option>
                                                                           <ng-option value="Pallets" data-select2-id="294">Pallets</ng-option>
                                                                     </ng-select>
      
      
                                                                  </div>
                                                                  <div class="col-lg-3"> </div>
                                                               </div>
                                                               <div class="row mt-3 mr-4">
                                                                  <div class="col-lg-12">
                                                                     <label class="control-label font-weight-bold labelmt text-3 text-dark">Weight
                                                                        <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span>                                                                      -->
                                                                     </label>
                                                                  </div>
                                                                  <div class="col-lg-6">
      
                                                                     <input placeholder="eg. 500 Kg" type="text" [(ngModel)]="commodity.weight" name="weight_{{w}}{{z}}" class="form-control" >
                                                                     <!-- <div *ngIf="oWeight.invalid && (oWeight.dirty || oWeight.touched)" class="text-danger">
                                                                        <div *ngIf="oWeight.errors.pattern">
                                                                       Weight must contains numbers only.
                                                                         </div>
                                                                    </div> -->
                                                                     <!-- <span class="text-danger"
                                                                        *ngIf="isShipperSubmit &&  shippersReceivers[i].shippers.commodity[z].weight == ''"
                                                                        >
                                                                        This Field is required
                                                                     </span> -->
                                                                  </div>
      
                                                                  <div class="col-lg-6">
                                                                     <ng-select dropdownPosition='top' placeholder="eg. select weight" [(ngModel)]="commodity.weightUnit" name="weightUnit_{{w}}{{z}}" class="form-control" data-select2-id="19" tabindex="-1" aria-hidden="false" >
      
                                                                           <ng-option value="ton(s)">ton(s)</ng-option>
                                                                           <ng-option value="Kilograms">Kilograms</ng-option>
                                                                           <ng-option value="lbs">lbs</ng-option>
                                                                     </ng-select>
      
      
                                                                  </div>
      
                                                               </div>
                                                            </div>
      
                                                            
                                                            
                                                         </div>
                                                      </div>
                                                      <div class="row mt-3">
                                                         <div class="col-lg-4 col-sm-12 col-xs-12 col-12">
                                                            <label class="control-label font-weight-bold mb-0 mt-2 text-3 text-dark"
                                                               for="inputDefault">Will Driver Load ?</label>
                                                         </div>

                                                         <div class="col-lg-5 mb-3 pl-0 pr-0">
                                                            <div class="btn-group-toggle" data-toggle="buttons">
                                                                  <label class="btn btn-outline btn-yesno mr-2 mb-2" [ngClass]="{'active': item.shippers.driverLoad}" (click)="driverLoadChange(i, true)">
                                                                  <input [(ngModel)]="item.shippers.driverLoad"
                                                                     name="driverLoad" type="radio"
                                                                     id="loadyes" checked="">Yes</label>

                                                                  <label class="btn btn-outline btn-yesno mr-2 mb-2" [ngClass]="{'active': !item.shippers.driverLoad}" (click)="driverLoadChange(i, false)">
                                                                  <input [(ngModel)]="item.shippers.driverLoad"
                                                                     name="driverLoad" type="radio"
                                                                     id="loadyes" checked="">No</label>
                                                            </div>
                                                         </div>

                                                         <div class="col-lg-3 col-sm-12 col-xs-12 col-12 text-right">
                                                            <p class="mb-1"><a *ngIf="item.shippers.save" href="javascript:;" (click)="saveShipper(i)"
                                                               class="btn btnw90px btn-md btn-dark">Save</a></p>
                                                            <p><a *ngIf="item.shippers.update" href="javascript:;" (click)="updateShipperReceiver('shipper', i)"
                                                               class="btn btnw90px btn-md btn-dark">Update</a></p>
                                                         </div>
                                                      </div>
                                                   </div>
                                                </section>
                                             </div>
                                          </div>

                                          <!-- <a (click)="addShipper()" class="btn btn-success btn-sm"
                                             href="javascript:;"><i class="fas fa-plus"></i> Add Next Shipper</a> -->


                                       </div>



                                       <div class="col-lg-4 pr-0 offset-lg-2">

                                          <div class="">
                                             <div>
                                                <section>
                                                   <div id="collapseReceiverArea-{{i}}" class="collapse show">
                                                      <div class="mr-4">
                                                         <div class="row">

                                                            <div class="col-lg-11 col-md-12">
                                                               <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                  for="inputDefault">Receiver <span class="mandfield text-2 ml-1"><sup>*</sup></span>
                                                               </label>

                                                               <ng-select [(ngModel)]="item.receivers.receiverID"
                                                                  name="receiverID" #receiverID="ngModel" required
                                                                  receiverID placeholder="Select Receiver"class="form-control" data-select2-id="16"
                                                                  tabindex="-1" aria-hidden="true" #consignee="ngModel" required>
                                                                  <ng-option *ngFor="let item of receivers | async;" value="{{item.contactID}}">{{item.companyName}}</ng-option>
                                                               </ng-select>
                                                               <div *ngIf="consignee.touched && ( shippersReceivers[0].receivers.receiverID == null || shippersReceivers[0].receivers.receiverID == '') && finalShippersReceivers[0].receivers.length == 0" class="text-danger">
                                                                  Receiver is required.

                                                            </div>

                                                            </div>
                                                            <div class="col-lg-1 mar-top-37  pl-0">
                                                               <a data-toggle="modal" data-target="#addConsigneeModal" href="javascript:;"
                                                                  class="modal-with-form btn btn-sm btn-success">
                                                                  <em class="fas fa-plus"></em>
                                                            </a>
                                                            </div>
                                                         </div>
                                                      </div>
                                                      <div class="addsr-scrollbar addsr-scroll-y pickup-location__main">
                                                         
                                                         <div *ngFor="let dropItem of item.receivers.dropPoint; let y = index;" class="mr-4" [ngClass]="{'p-3 bg-grey mt-2': y != 0}">
                                                            <div class="row mt-3">

                                                               <div class="col-lg-11 col-md-11">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Drop Off Location
                                                                     <span class="mandfield text-2 ml-1"><sup>*</sup></span>
                                                                  </label>
      
                                                                  <input placeholder="eg. Calgary,Alberta" [disabled]="dropItem.address.manual" [(ngModel)]="dropItem.address.dropOffLocation"
                                                                     name="dropOffLocation_{{y}}" #dropLoc="ngModel"
                                                                     required dropLoc
                                                                     (keyup)="searchTerm.next($event);" class="form-control" autocomplete="off"
                                                                     tabindex="-1" aria-hidden="true" #drop="ngModel" required >
                                                                     <!-- <div *ngIf="dropOffLocation.touched && shippersReceivers[0].receivers.dropOffLocation == '' && finalShippersReceivers[0].receivers.length == 0" class="text-danger">
                                                                         Drop off location is required.
      
      
                                                                    </div> -->
      
                                                                  <div class="map-search__results bg-white row mt-3 mar-top-30 ml-0" style="width: 93%">
                                                                     <ul class="p-0 m-0 text-left">
                                                                        <li *ngFor="let item of searchResults;">
                                                                           <a href="javascript:;" (click)="assignLocation(i, y, 'receiver', item.address.label)"
                                                                              title="{{item.address.label}}">{{item.address.label}}</a>
                                                                        </li>
                                                                     </ul>
                                                                  </div>
                                                               </div>
                                                               <div class="col-lg-1 mar-top-37  pl-0">
                                                                  <a (click)="addPickUpPoint(i, 'receiver')" *ngIf="y == 0" href="javascript:;" class="modal-with-form btn btn-sm btn-success">
                                                                     <em class="fas fa-plus"></em>
                                                                  </a>
                                                                  <a (click)="removePickUpPoint(i, y, 'receiver')" *ngIf="y != 0" href="javascript:;" class="modal-with-form btn btn-sm btn-danger">
                                                                     <em class="fas fa-minus"></em>
                                                                  </a>
                                                               </div>
                                                               <div class="col-lg-4 text-center">
                                                                  <div class="checkbox-custom checkbox-default pl-0">
                                                                     <input type="checkbox" [(ngModel)]="dropItem.address.manual"
                                                                     name="manualAddress_{{y}}" (change)="manualAddress($event.target.checked, i, y, 'receiver')"  id="locationaddBtn">
                                                                     <label class="control-label mt-2 font-weight-bold" for="locationaddBtn"> Type Manually</label>
                                                                  </div>
                                                               </div>
                                                               <div class="col-lg-6 text-center">
                                                                  <div class="checkbox-custom checkbox-default pl-0">
                                                                     <input [(ngModel)]="dropItem.unit"
                                                                     name="unit_{{y}}" type="checkbox" id="locationaddBtn3">
                                                                     <label class="control-label mt-2 font-weight-bold" for="locationaddBtn3"> Type Unit Number Manually</label>
                                                                  </div>
                                                               </div>
                                                            </div>
                                                            <div class="row mt-3" *ngIf="dropItem.unit">
                                                               <div class="col-lg-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">Unit Number</label>
                                                                  <input [(ngModel)]="dropItem.unitNumber"
                                                                  name="unitNumber_{{y}}" type="text" class="form-control" placeholder="Unit Number">
                                                               </div>
                                                            
                                                               <div class="col-12 pl-4 pr-4">
                                                                  <div class="row">
                                                                     <div class="col-12 bordbtm">
                                                                        &nbsp;
                                                                     </div>
                                                                  </div>
                                                               </div>
                                                            
                                                            </div>
                                                            <div class="row mt-3" *ngIf="dropItem.address.manual">
                                                               <div class="col-lg-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">Address</label>
                                                                  <input type="text" [(ngModel)]="dropItem.address.address"
                                                                  name="address_{{y}}"  class="form-control" placeholder="type address">
                                                               </div>
                                                            
                                                               <div class="col-lg-6 pull-left">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">City</label>
                                                                  <input [(ngModel)]="dropItem.address.city"
                                                                  name="city_{{y}}" type="text" class="form-control" placeholder="toronto">
                                                               </div>
                                                               <div class="col-lg-6 pull-left">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">State</label>
                                                                  <input [(ngModel)]="dropItem.address.state"
                                                                  name="state_{{y}}" type="text" class="form-control" placeholder="ON">
                                                               </div>
                                                               <div class="col-lg-6 pull-left">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">Country</label>
                                                                  <input [(ngModel)]="dropItem.address.country"
                                                                  name="country_{{y}}" type="text" class="form-control" placeholder="canada">
                                                               </div>
                                                               <div class="col-lg-6 pull-left">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark">Zip Code</label>
                                                                  <input [(ngModel)]="dropItem.address.zipCode"
                                                                  name="zipCode_{{y}}" type="text" class="form-control" placeholder="V6C 1Z6">
                                                               </div>
                                                               <div class="col-12 pl-4 pr-4 pull-left">
                                                                  <div class="row">
                                                                     <div class="col-12 bordbtm">
                                                                        &nbsp;
                                                                     </div>
                                                                  </div>
                                                               </div>
                                                            
                                                            </div>
                                                            <div class="row mt-3">
                                                               <div class="col-lg-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Delivery Date and Time
                                                                     <span class="mandfield text-2 ml-1"><sup>*</sup></span>
                                                                  </label>
                                                               </div>
                                                               <div class="col-lg-6">
                                                                  <div class="input-group">
      
                                                                     <input [(ngModel)]="dropItem.dropOffDate" name="dropOffDate_{{y}}" type="text"
                                                                        placeholder="yyyy/mm/dd" (click)="dropOffDate.toggle()" ngbDatepicker #dropOffDate="ngbDatepicker"
                                                                        class="form-control" autocomplete="off" #delDate="ngModel" required  [minDate]="dateMinLimit" [maxDate]="futureDatesLimit">
      
      
                                                                  </div>
                                                                  <!-- <div *ngIf="delDate.touched && shippersReceivers[0].receivers.dropOffDate == '' && finalShippersReceivers[0].receivers.length == 0" class="text-danger">
      
      
                                                                    Delivery date is required.
      
                                                                 </div> -->
      
                                                               </div>
                                                               <div class="col-lg-6">
                                                                  <div class="input-group">
                                                                     <input [(ngModel)]="dropItem.dropOffTime"
                                                                        name="dropOffTime_{{y}}" #dropOffTime="ngModel" required
                                                                        dropOffTime type="time" class="timepicker form-control" placeholder=""
                                                                        />
                                                                  </div>
                                                                  <!-- <div *ngIf="dropOffTime.touched && shippersReceivers[0].receivers.dropOffTime == '' && finalShippersReceivers[0].receivers.length == 0" class="text-danger">
      
      
                                                                     Delivery time is required.
      
                                                                  </div> -->
                                                               </div>
                                                               <!-- <div class="col-lg-3 mt-1">
                                                               </div> -->
                                                            </div>
                                                            <div *ngFor="let commodity of dropItem.commodity; let z = index;">
                                                               <div class="row mt-3">
                                                                  <div class="col-lg-12">
                                                                     <label class="control-label font-weight-bold labelmt text-3 text-dark">Commodity
                                                                        <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span> -->
                                                                     </label>
                                                                  </div>
                                                                  <div class="col-lg-11">
      
                                                                     <input placeholder="eg. cakes" type="text" [(ngModel)]="commodity.name" name="name{{y}}{{z}}" class="form-control" >
      
      
                                                                  </div>
                                                                  <div class="col-lg-1 text-right mt-1 pl-0">
                                                                     <a class="btn btn-danger btn-sm" href="javascript:;" *ngIf="z != 0" (click)="removeCommodity('receiver', i, y, z)"><i class="fas fa-minus"></i> </a>
                                                                     <a class="btn btn-success btn-sm" href="javascript:;" *ngIf="z == 0" (click)="addCommodity('receiver', i, y)"><i class="fas fa-plus"></i></a>
      
      
                                                                  </div>
                                                               </div>
      
                                                               <div class="row mt-3">
      
                                                                  <div class="col-lg-12 col-md-12">
                                                                     <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                        >DEL# &nbsp;<i
                                                                        class="fas fa-question-circle" data-toggle="tooltip"
                                                                        data-placement="top"
                                                                        title="Delivery Number "></i>
      
      
                                                                        <!-- PU#<span class="mandfield text-2 ml-1"><sup>*</sup></span> -->
      
                                                                     </label>
      
                                                                     <input placeholder="eg. 1458,16325" [(ngModel)]="commodity.del" name="pu{{y}}{{z}}"
      
                                                                        type="text" class="form-control" >
                                                                        <!-- <div *ngIf="delNum.invalid && (delNum.dirty || delNum.touched)" class="text-danger">
                                                                           <div *ngIf="delNum.errors.pattern">
                                                                         Delivery Number must contains number only.
                                                                            </div>
                                                                       </div> -->
                                                                     <!-- <span class="text-danger"
                                                                        *ngIf="isReceiverSubmit &&  shippersReceivers[i].receivers.commodity[z].del == ''">
                                                                        This Field is required
                                                                     </span> -->
                                                                  </div>
      
                                                               </div>
      
                                                               <div class="row mt-3">
                                                                  <div class="col-lg-12">
                                                                     <label class="control-label font-weight-bold labelmt text-3 text-dark">Quantity
                                                                        <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span>                                                                      -->
                                                                     </label>
                                                                  </div>
                                                                  <div class="col-lg-6">
      
                                                                  <input placeholder="eg. 20,200" type="text" [(ngModel)]="commodity.quantity" name="quantity{{y}}{{z}}" class="form-control" >
                                                                  <!-- <div *ngIf="txtQuantity.invalid && (txtQuantity.dirty || txtQuantity.touched)" class="text-danger">
                                                                     <div *ngIf="txtQuantity.errors.pattern">
                                                                   Quantity must contains number only.
                                                                      </div>
                                                                 </div> -->
      
                                                                     <!-- <span class="text-danger"
                                                                        *ngIf="isReceiverSubmit &&  shippersReceivers[i].receivers.commodity[z].quantity == ''">
                                                                        This Field is required
                                                                     </span> -->
                                                                  </div>
      
                                                                  <div class="col-lg-6">
                                                                     <ng-select placeholder="eg. select quantity" dropdownPosition='top' [(ngModel)]="commodity.quantityUnit" name="quantityUnit{{y}}{{z}}" class="form-control" data-select2-id="19" tabindex="-1" aria-hidden="false" >
                                                                        <ng-option value="Bag" data-select2-id="21">Bag</ng-option>
                                                                           <ng-option value="Bale" data-select2-id="285">Bale</ng-option>
                                                                           <ng-option value="Barrel" data-select2-id="286">Barrel</ng-option>
                                                                           <ng-option value="Basket" data-select2-id="287">Basket</ng-option>
                                                                           <ng-option value="Bin" data-select2-id="288">Bin</ng-option>
                                                                           <ng-option value="Box" data-select2-id="289">Box</ng-option>
                                                                           <ng-option value="Bucket" data-select2-id="290">Bucket</ng-option>
                                                                           <ng-option value="Can" data-select2-id="291">Can</ng-option>
                                                                           <ng-option value="Crate" data-select2-id="292">Crate</ng-option>
                                                                           <ng-option value="Cases" data-select2-id="293">Cases</ng-option>
                                                                           <ng-option value="Pallets" data-select2-id="294">Pallets</ng-option>
                                                                     </ng-select>
                                                                     <!-- <div *ngIf="qty.invalid && (qty.dirty || qty.touched)" class="text-danger">
                                                                        <div *ngIf="qty.errors.required">
                                                                      Select valid quantity from the list.
                                                                         </div>
                                                                    </div> -->
      
                                                                     <!-- <span class="text-danger"
                                                                        *ngIf="isReceiverSubmit &&  shippersReceivers[i].receivers.commodity[z].quantityUnit == ''">
                                                                        This Field is required
                                                                     </span> -->
      
                                                                  </div>
      
                                                               </div>
                                                               <div class="row mt-3">
                                                                  <div class="col-lg-12">
                                                                     <label class="control-label font-weight-bold labelmt text-3 text-dark">Weight
                                                                        <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span>                                                                      -->
                                                                     </label>
                                                                  </div>
                                                                  <div class="col-lg-6">
      
                                                                     <input placeholder="eg. 500 Kg" type="text" [(ngModel)]="commodity.weight" name="weight{{y}}{{z}}" class="form-control" >
                                                                     <!-- <div *ngIf="txtWeight.invalid && (txtWeight.dirty || txtWeight.touched)" class="text-danger">
                                                                        <div *ngIf="txtWeight.errors.pattern">
                                                                      Weight must contains numbers only.
                                                                         </div>
                                                                    </div> -->
                                                                     <!-- <span class="text-danger"
                                                                        *ngIf="isReceiverSubmit && shippersReceivers[i].receivers.commodity[z].weight == ''">
                                                                        This Field is required
                                                                     </span> -->
                                                                  </div>
      
                                                                  <div class="col-lg-6">
                                                                     <ng-select placeholder="eg. select weight" dropdownPosition='top' [(ngModel)]="commodity.weightUnit" name="weightUnit{{y}}{{z}}" class="form-control" data-select2-id="19" tabindex="-1" aria-hidden="false" >
                                                                           <ng-option value="ton(s)">ton(s)</ng-option>
                                                                           <ng-option value="Kilograms">Kilograms</ng-option>
                                                                           <ng-option value="lbs">lbs</ng-option>
                                                                     </ng-select>
                                                                     <!-- <div *ngIf="sltWeightType.invalid && (sltWeightType.dirty || sltWeightType.touched)" class="text-danger">
                                                                        <div *ngIf="sltWeightType.errors.required">
                                                                      Select valid weight from the list.
                                                                         </div>
                                                                    </div> -->
      
                                                                     <!-- <span class="text-danger"
                                                                        *ngIf="isReceiverSubmit && shippersReceivers[i].receivers.commodity[z].weightUnit == ''">
                                                                        This Field is required
                                                                     </span> -->
                                                                  </div>
      
                                                               </div>
                                                            </div>
                                                            
                                                            <div class="row mt-3">
      
                                                               <div class="col-lg-12 col-md-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Delivery Instruction</label>
      
                                                                  <textarea placeholder="eg. Enter delivery instruction" [(ngModel)]="dropItem.dropOffInstruction"
                                                                     name="dropOffInstruction_{{y}}" class="form-control h-auto" rows="2" #Deliv1= "ngModel" pattern ="^[\s\S]{500}$"
      
                                                                     style="margin-top: 0px; margin-bottom: 0px; height: 74px;"></textarea>
                                                                     <!-- <div *ngIf="Deliv1.invalid && (Deliv1.dirty || Deliv1.touched)" class="text-danger">
                                                                      <div>
                                                                        <div *ngIf="Deliv1.errors.pattern">
                                                                          Only 500 characters are allowed.
                                                                         </div>
                                                                      </div>
                                                                    </div> -->
                                                               </div>
      
                                                            </div>
                                                            <div class="row mt-3">
      
                                                               <div class="col-lg-12 col-md-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Contact Person at Delivery
                                                                     <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span>                                                                      -->
                                                                  </label>
      
                                                                  <input placeholder="eg. John Smith" [(ngModel)]="dropItem.contactPerson"
                                                                     name="contactPerson_{{y}}" type="text" class="form-control"
                                                                     id="inputDefault" >
                                                                     <!-- <div *ngIf="conPickup.invalid && (conPickup.dirty || conPickup.touched)" class="text-danger">
                                                                        <div *ngIf="conPickup.errors.pattern">
                                                                        Contact person at  delivery must contains uppercase,lowercase and special chracters for period(space) only.
                                                                         </div>
                                                                    </div> -->
                                                                  <!-- <span class="text-danger"
                                                                     *ngIf="isReceiverSubmit &&  shippersReceivers[i].receivers.contactPerson == ''">
                                                                     This Field is required
                                                                  </span> -->
                                                               </div>
      
                                                            </div>
      
                                                            <div class="row mt-3">
      
                                                               <div class="col-lg-12 col-md-12">
                                                                  <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                                                     for="inputDefault">Phone
                                                                     <!-- <span class="mandfield text-2 ml-1"><sup>*</sup></span>                                                                      -->
                                                                  </label>
      
                                                                  <input placeholder="eg. 2234567891" [(ngModel)]="dropItem.phone" name="phone_{{y}}"
                                                                     type="text" class="form-control" id="inputDefault" >
                                                                     <!-- <div *ngIf="cPhone.invalid && (cPhone.dirty || cPhone.touched)" class="text-danger">
                                                                        <div *ngIf="cPhone.errors.pattern">
                                                                         Phone must contains 10 number only eg. +12234567891.
                                                                         </div>
                                                                    </div> -->
                                                                  <!-- <span class="text-danger"
                                                                     *ngIf="isReceiverSubmit &&  shippersReceivers[i].receivers.phone == ''">
                                                                     This Field is required
                                                                  </span> -->
                                                               </div>
      
                                                            </div>
                                                         </div>
                                                      </div>
                                                     
                                                      <div class="row mt-3">
                                                         <div class="col-lg-4 col-sm-12 col-xs-12 col-12">
                                                            <label class="control-label font-weight-bold mb-0 mt-2 text-3 text-dark"
                                                               for="inputDefault">Will Driver Unload ?</label>
                                                         </div>

                                                         <div class="col-lg-5 mb-3 pl-0 pr-0">
                                                            <div class="btn-group-toggle" data-toggle="buttons">
                                                               <label class="btn btn-outline btn-yesno mr-2 mb-2" [ngClass]="{'active': item.receivers.driverUnload}" (click)="driverUnLoadChange(i, true)">
                                                                  <input [(ngModel)]="item.receivers.driverUnload"
                                                                  name="driverUnload" type="radio"
                                                                  id="unloadyes" checked=""> Yes</label>
                                                               <label class="btn btn-outline btn-yesno mr-2 mb-2" [ngClass]="{'active': !item.receivers.driverUnload}" (click)="driverUnLoadChange(i, false)">
                                                                  <input [(ngModel)]="item.receivers.driverUnload"
                                                                  name="driverUnload" type="radio"
                                                                  id="unloadno"> No</label>
                                                            </div>
                                                         </div>

                                                         <div class="col-lg-3 col-sm-12 col-xs-12 col-12 text-right">
                                                            <p><a *ngIf="item.receivers.save" href="javascript:;"
                                                               class="btn btnw90px btn-md btn-dark"
                                                               (click)="saveReceiver(i)">Save</a></p>
                                                            <p><a *ngIf="item.receivers.update" href="javascript:;" (click)="updateShipperReceiver('receiver', i)"
                                                               class="btn btnw90px btn-md btn-dark">Update</a></p>

                                                         </div>


                                                      </div>

                                                   </div>
                                                </section>
                                             </div>
                                          </div>

                                          <!-- <a class="btn btn-success btn-sm" href="javascript:"
                                             (click)="addReceiver()"><i class="fas fa-plus"></i> Add Next Receiver</a> -->


                                       </div>
                                    </div>

                                    <div class="row">
                                       <div class="col-11 pr-0 text-right">
                                          <button *ngIf="i != 0" (click)="removeAccordian(i)" type="button" class="btn btn-danger mt-3 ml-2">Remove</button>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="form-group row">
                              <div class="col-lg-11 text-right pr-0">
                                 <button  (click)="addAccordian()" type="button" class="btn btn-success pull-right">Add More</button>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>


                  <div class="row mb-3">
                     <div class="col-12">
                        <div class="bg-white p-3 text-dark">
                           <div class="form-group row">

                              <div class="col-lg-6">
                                 <div class="row">
                                    <div class="col-lg-8 offset-lg-2">
                                       <h4 class="text-dark font-weight-bold text-5">Additional Details</h4>
                                    </div>
                                 </div>

                                 <div class="row mt-3">

                                    <div class="col-lg-8 offset-lg-2">
                                       <!-- <label class="control-label font-weight-bold text-3 text-dark"
                                          for="inputDefault">&nbsp;</label> -->

                                       <div class="checkbox-custom checkbox-default">
                                          <input (change)="checkTrailer($event.target.value)"
                                             [(ngModel)]="orderData.additionalDetails.dropTrailer" name="dropTrailer"
                                             type="checkbox" id="droptrailer">
                                          <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                             for="droptrailer">Drop Asset</label>
                                       </div>

                                    </div>

                                 </div>



                                 <div class="row mt-3" *ngIf="!orderData.additionalDetails.dropTrailer">

                                    <div class="col-lg-8 offset-lg-2">
                                       <label class="control-label font-weight-bold text-3 text-dark"
                                          for="inputDefault">Asset Type</label>

                                       <ng-select placeholder="eg. Reefer" [(ngModel)]="orderData.additionalDetails.trailerType" name="trailerType"
                                          class="form-control populate" >

                                           <ng-option value="container">Container</ng-option>
                                           <ng-option value="double_drop">Double Drop</ng-option>
                                           <ng-option value="dump_trailer">Dump Trailer</ng-option>
                                           <ng-option value="flat_bed">Flat bed</ng-option>
                                           <ng-option value="lowboy">Lowboy</ng-option>
                                           <ng-option value="stepDeck">StepDeck</ng-option>
                                           <ng-option value="removable_gooseneck">Removable Gooseneck</ng-option>
                                           <ng-option value="dry_van">Dry Van</ng-option>
                                           <ng-option value="over_size">Over Size</ng-option>
                                           <ng-option value="reefer">Reefer</ng-option>
                                         <ng-option value="hazmat">Hazmat</ng-option>
                                           <ng-option value="power_only">Power Only</ng-option>
                                           <ng-option value="conestoga_trailer">Conestoga Trailer</ng-option>
                                           <ng-option value="side_kit_trailer">Side Kit Trailer</ng-option>
                                           <ng-option value="specialized_trailer">Specialized Trailer</ng-option>
                                           <ng-option value="enclosed_trailer">Enclosed Trailer</ng-option>
                                           <ng-option value="scrap_trailer">Scrap Trailer</ng-option>
                                           <ng-option value="semi_trailer">Semi Trailer</ng-option>
                                           <ng-option value="chassis">Chassis</ng-option>
                                           <ng-option value="tank_trailer">Tank Trailer</ng-option>

                                       </ng-select>
                                       <!-- <div *ngIf="sltAssetType.invalid && (sltAssetType.dirty || sltAssetType.touched)" class="text-danger">
                                          <div *ngIf="sltAssetType.errors.required">
                                        Select valid asset type from the list.
                                           </div>
                                      </div> -->
                                    </div>
                                    <div class="col-lg-3">
                                    </div>
                                 </div>


                                 <!-- <div class="row mt-3">
                                    <div class="col-lg-10 offset-lg-2">
                                       <label class="control-label font-weight-bold text-3 text-dark" for="inputDefault">Load Type&nbsp; <span class="text-1 optional-label-color">(optional)</span></label>
                                    </div>

                                    <div class="wltype pl-3 offset-lg-2">
                                       <div class="checkbox-custom checkbox-default">
                                          <input name="orderData.additionalDetails.loadType.hazMat" [(ngModel)]="orderData.additionalDetails.loadType.hazMat" [checked]="orderData.additionalDetails.loadType.hazMat"
                                              type="checkbox" id="HazMat">
                                          <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                             for="HazMat">HazMat</label>
                                       </div>
                                    </div>


                                    <div class="wltype pl-3">
                                       <div class="checkbox-custom checkbox-default">
                                          <input name="orderData.additionalDetails.loadType.oversize" [(ngModel)]="orderData.additionalDetails.loadType.oversize" [checked]="orderData.additionalDetails.loadType.oversize"
                                             type="checkbox" id="Load">
                                          <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                             for="Load">Oversize Load</label>
                                       </div>
                                    </div>

                                    <div class="wltype pl-3">
                                       <div class="checkbox-custom checkbox-default">

                                          <input name="orderData.additionalDetails.loadType.reefer" [(ngModel)]="orderData.additionalDetails.loadType.reefer" [checked]="orderData.additionalDetails.loadType.reefer"

                                            type="checkbox" id="Reefer">
                                          <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                             for="Reefer">Reefer</label>
                                       </div>
                                    </div>

                                    <div class="wltype pl-3">
                                       <div class="checkbox-custom checkbox-default">
                                          <input name="orderData.additionalDetails.loadType.tanker" [(ngModel)]="orderData.additionalDetails.loadType.tanker" [checked]="orderData.additionalDetails.loadType.tanker"
                                              type="checkbox" id="Tanker">
                                          <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                             for="Tanker">Tanker</label>
                                       </div>
                                    </div>


                                 </div> -->

                                 <!--Tempratures-->
                                 <div class="row mt-2" *ngIf="orderData.additionalDetails.trailerType == 'reefer'">
                                    <div class="col-lg-10 offset-lg-2">
                                       <label class="control-label font-weight-bold text-3 text-dark" for="inputDefault">Temperature</label>
                                    </div>
                                    <div class="col-lg-4 offset-lg-2">
                                       <input
                                          name="orderData.additionalDetails.refeerTemp.minTemprature" [(ngModel)]="orderData.additionalDetails.refeerTemp.minTemprature" type="text" class="form-control"
                                          placeholder="From" id="inputDefault" >
                                          <!-- <div *ngIf="temperature.invalid && (temperature.dirty || temperature.touched)" class="text-danger">
                                             <div *ngIf="temperature.errors.pattern">
                                           Temperature must contains numbers and special characters for period('.') only.
                                              </div>
                                         </div> -->
                                    </div>
                                    <div class="col-lg-4">
                                       <ng-select

                                       name="orderData.additionalDetails.refeerTemp.minTempratureUnit" (change)="tempChange($event)" [(ngModel)]="orderData.additionalDetails.refeerTemp.minTempratureUnit"
                                        placeholder="select unit" class="form-control populate" data-select2-id="10"

                                          tabindex="-1" aria-hidden="true">

                                             <ng-option value="°C">°C</ng-option>
                                             <ng-option value="°F">°F</ng-option>

                                       </ng-select>
                                    </div>

                                 </div>




                                 <div class="row mt-3" *ngIf="orderData.additionalDetails.trailerType == 'reefer'">

                                    <div class="col-lg-4 offset-lg-2">
                                       <input
                                       name="orderData.additionalDetails.refeerTemp.maxTemprature" [(ngModel)]="orderData.additionalDetails.refeerTemp.maxTemprature" type="text" class="form-control"
                                       type="text" class="form-control"
                                          placeholder="To" id="inputDefault" >
                                          <!-- <div *ngIf="temp2.invalid && (temp2.dirty || temp2.touched)" class="text-danger">
                                             <div *ngIf="temp2.errors.pattern">
                                           Temperature must contains numbers and special characters for period('.') only.
                                              </div>
                                         </div> -->
                                    </div>
                                    <div class="col-lg-4">
                                       <ng-select
                                       name="orderData.additionalDetails.refeerTemp.maxTempratureUnit" [(ngModel)]="orderData.additionalDetails.refeerTemp.maxTempratureUnit" type="text" class="form-control"
                                       (change)="tempChange($event)"
                                       placeholder="select unit" class="form-control populate" data-select2-id="13"
                                          tabindex="-1" aria-hidden="true">
                                             <ng-option value="°C">°C</ng-option>
                                             <ng-option value="°F">°F</ng-option>

                                       </ng-select>
                                    </div>

                                 </div>


                                 <div class="row mt-3">

                                    <div class="col-lg-8 offset-lg-2">
                                       <label class="control-label font-weight-bold labelmt text-3 text-dark">Attachments Type</label>
                                       <input [(ngModel)]="orderData.additionalDetails.uploadedDocs" name="uploadedDocs"
                                          type="file" (change)="selectDocuments($event)" multiple class="form-control p-0">
                                    </div>
                                 </div>
                                 <div class="row mt-2" *ngIf="orderAttachments?.length">
                                    <div class="col-lg-8 offset-lg-2">
                                       <div class="vehicle-common-box p-3">
                                          <div class="row">
                                             <div class="col-lg-6"><label class="control-label font-weight-bold text-3">Document(s)</label>
                                             </div>
                                             <div class="col-lg-6 text-right">
                                             </div>
                                          </div>
                                          <hr class="solid mt-2">
                                          <div class="row mb-1" *ngFor="let doc of orderAttachments;let d= index">
                                             <div class="col-lg-9"><a href="javascript:;" data-toggle="modal" data-target="#viewDocModal"
                                                   (click)="setPDFSrc(doc.path)">Document {{d+1}}</a> </div>
                                             <div class="col-lg-3 text-right">
                                                <i class="far fa-file text-dak mr-1" (click)="setPDFSrc(doc.path)" data-toggle="modal"
                                                   data-target="#viewDocModal"></i>
                                                <a href="javascript:;" (click)="delete('attachment',doc.name, d)" class="modal-with-form"><i
                                                      class="fas fa-times text-danger"></i></a>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                 </div>

                                 <div class="row mt-3">
                                    <div class="col-lg-8 offset-lg-2">
                                       <div class="bordall pull-left w100 p-3">
                                       <h5 class="font-weight-bold text-4 text-dark">Miles <span class="mandfield text-2 ml-1"><sup>*</sup></span></h5>
                                       <h5 *ngIf="orderData.orderMode === 'FTL'" class="text-4 text-dark font-weight-semibold mb-3">Calculated Using</h5>


                                       <!-- <div class="col-lg-12 mb-3 pl-0 pr-0">
                                          <div class="btn-group-toggle" data-toggle="buttons">
                                             <label class="btn btn-outline btn-miles mr-2 mb-2">
                                             <input id="googleMiles" name="calculateMiles" type="radio"> Google Miles</label>
                                             <label class="btn btn-outline btn-miles mr-2 mb-2">
                                             <input id="pcmiles" name="calculateMiles" type="radio"> PC Miles</label>
                                             <label class="btn btn-outline btn-miles mr-2 mb-2 active">
                                             <input id="manualmiles" name="calculateMiles" type="radio"> Manual</label>
                                          </div>
                                       </div> -->

                                       <div class="col-lg-12 mb-3 pl-0 pr-0">

                                          <div class="btn-group-toggle" data-toggle="buttons">
                                             <!-- <label class="btn btn-outline btn-miles mr-2 milesCommon" [class.active]="orderData.milesInfo.calculateBy === 'google'" id="google"
                                              (click)="getMiles('google')">
                                             <input type="radio" [(ngModel)]="orderData.milesInfo.calculateBy" name="calculateBy"
                                                checked hidden value="google"> Google Miles </label> -->

                                                <label class="btn btn-outline btn-miles mr-2 milesCommon" id="pcmiles"
                                             [class.active]="orderData.milesInfo.calculateBy === 'pcmiles'" (click)="getMiles('pcmiles')">
                                             <input type="radio" [(ngModel)]="orderData.milesInfo.calculateBy" name="calculateBy"
                                                hidden value="pcmiles"> PC Miles </label>

                                          <label class="btn btn-outline btn-miles milesCommon" id="manual"
                                             [class.active]="orderData.milesInfo.calculateBy === 'manual'" (click)="getMiles('manual')">
                                             <input type="radio" [(ngModel)]="orderData.milesInfo.calculateBy" name="calculateBy"
                                                hidden value="manual"> Manual </label>
                                          </div>


                                       </div>
                                    </div>
                                    </div>

                                 </div>

                                <div class="row mt-1">
                                       <div class="col-lg-8 offset-lg-2 mt-3">
                                          <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                             for="inputDefault">Total Miles <span class="mandfield text-2 ml-1"><sup>*</sup></span></label>
                                          <input placeholder="eg. 5,15,20" type="text" [disabled]="orderData.milesInfo.calculateBy == 'google' || orderData.milesInfo.calculateBy == 'pcmiles'" [(ngModel)]="orderData.milesInfo.totalMiles" name="totalMiles"
                                          #totalMiles="ngModel" required totalMiles class="form-control" #tMiles="ngModel" required pattern="^[0-9\.]+$">
                                          <div *ngIf="tMiles.invalid && (tMiles.dirty || tMiles.touched)" class="text-danger">

                                             <div *ngIf="tMiles.errors.required">
                                           Total Miles are required.
                                              </div>
                                              <div *ngIf="tMiles.errors.pattern">
                                                Total miles must contains number and with decimal allowed.
                                                   </div>


                                         </div>

                                       </div>
                                    </div>

                                 <!-- <div class="row mt-1">
                                    <div class="col-lg-8 offset-lg-2 mt-3">
                                       <label class="control-label font-weight-bold text-4 text-dark"
                                          for="inputDefault">Remarks</label>
                                       <textarea placeholder="eg. Enter Remarks" [(ngModel)]="orderData.remarks" name="remarks" class="form-control h-auto" rows="2"
                                          ></textarea>
                                    </div>
                                 </div> -->


                              </div>

                              <div class="col-lg-4 pr-0 offset-lg-1">
                                 <div class="row">
                                    <div class="col-lg-12">
                                       <h4 class="text-dark font-weight-bold text-5">Charges</h4>
                                    </div>
                                 </div>

                                 <div class="row mt-3">
                                    <div class="col-lg-12">
                                       <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                          for="inputDefault">Freight Fee
                                          <span class="mandfield text-2 ml-1"><sup>*</sup></span>
                                       </label>
                                    </div>
                                    <div class="col-lg-3 col-md-12">
                                       <ng-select placeholder="eg. Flat Fee " [(ngModel)]="orderData.charges.freightFee.type" name="freight_type"

                                       #freightType="ngModel" required freightType

                                          class="form-control populate" #sltFreight="ngModel" required >
                                             <ng-option value="Flat Fee">Flat Fee</ng-option>
                                             <!-- <ng-option value="Per Mile">Per Mile</ng-option>
                                             <ng-option value="Bag">Bag</ng-option>
                                             <ng-option value="Box">Box</ng-option>
                                             <ng-option value="Carton">Carton</ng-option>
                                             <ng-option value="Case">Case</ng-option>
                                             <ng-option value="Container Bulk Cargo">Container Bulk Cargo</ng-option>
                                             <ng-option value="Pieces">Pieces</ng-option>
                                             <ng-option value="Parcel">Parcel</ng-option>
                                             <ng-option value="Skid">Skid</ng-option>
                                             <ng-option value="Unit">Unit</ng-option> -->
                                       </ng-select>
                                       <div *ngIf="sltFreight.invalid && (sltFreight.dirty || sltFreight.touched)" class="text-danger">

                                          <div *ngIf="sltFreight.errors.required">
                                           Freight fee is required.
                                           </div>



                                      </div>

                                    </div>
                                    <div class="col-lg-3">
                                       <div class="input-group mb-3">
                                          <input [(ngModel)]="orderData.charges.freightFee.amount" name="freight_amount"

                                             (blur)="calculateAmount()"  #freightAmt="ngModel" required freightAmt type="number" min="0" class="form-control" placeholder="0.00" #txtFreight="ngModel" required>
                                             <div *ngIf="txtFreight.invalid && (txtFreight.dirty || txtFreight.touched)" class="text-danger">

                                                <div *ngIf="txtFreight.errors.required">
                                                  Freight amount must contains numbers only.
                                                 </div>



                                            </div>

                                       </div>
                                    </div>
                                    <div class="col-lg-3">
                                       <ng-select (change)="changeCurrency($event)" [(ngModel)]="orderData.charges.freightFee.currency"
                                       #freightCur="ngModel" required freightCur  name="freight_currency"

                                       placeholder="select currency" class="form-control populate" #sltcurrency="ngModel" required>

                                          <ng-option value="CAD">CAD</ng-option>
                                          <ng-option value="USD">USD</ng-option>

                                       </ng-select>
                                       <div *ngIf="sltcurrency.invalid && (sltcurrency.dirty || sltcurrency.touched)" class="text-danger">

                                          <div *ngIf="sltcurrency.errors.required">
                                             Currency is required.
                                           </div>



                                      </div>

                                    </div>
                                    <div class="col-lg-3">
                                       <p class="text-right"> <span>{{orderData.charges.freightFee.amount}}</span> </p>
                                    </div>

                                 </div>
                                 <div class="row mt-3">
                                    <div class="col-lg-12">
                                       <label class="control-label font-weight-bold labelmt text-3 text-dark"
                                          for="inputDefault">Fuel Surcharge</label>
                                    </div>
                                    <div class="col-lg-3">
                                       <ng-select placeholder="eg. Flat Fee" [(ngModel)]="orderData.charges.fuelSurcharge.type" name="fuel_type"
                                          class="form-control populate" data-select2-id="55" tabindex="-1" aria-hidden="true" >

                                          <ng-option value="Flat Fee">Flat Fee</ng-option>
                                          <ng-option value="Per Mile">Per Mile</ng-option>
                                          <ng-option value="Percentage">Percentage</ng-option>


                                       </ng-select>
                                       <!-- <div *ngIf="sltSurcharge.invalid && (sltSurcharge.dirty || sltSurcharge.touched)" class="text-danger">
                                          <div *ngIf="sltSurcharge.errors.required">
                                             Select valid freight surcharge from the list.
                                           </div>
                                      </div> -->
                                    </div>
                                    <div class="col-lg-3">
                                       <div class="input-group mb-3">
                                          <input [(ngModel)]="orderData.charges.fuelSurcharge.amount" name="fuel_amount"
                                             (blur)="calculateAmount()" type="number" min="0"  class="form-control" placeholder="0.00" >
                                             <!-- <div *ngIf="Amount.invalid && (Amount.dirty || Amount.touched)" class="text-danger">
                                                <div *ngIf="Amount.errors.required">
                                                Freight Surcharge amount must contains numbers only.
                                             </div>
                                            </div> -->
                                       </div>
                                    </div>
                                    <div class="col-lg-3">
                                       <ng-select (change)="changeCurrency($event)" [(ngModel)]="orderData.charges.fuelSurcharge.currency" name="fuel_currency"
                                       placeholder="select currency" class="form-control populate" data-select2-id="52" tabindex="-1" aria-hidden="true">

                                          <ng-option value="CAD">CAD</ng-option>
                                          <ng-option value="USD">USD</ng-option>

                                       </ng-select>
                                       <!-- <div *ngIf="Currency.invalid && (Currency.dirty || Currency.touched)" class="text-danger">
                                          <div *ngIf="Currency.errors.required">
                                             Select valid currency from the list.
                                           </div>
                                      </div> -->
                                    </div>
                                    <div class="col-lg-3">
                                       <p class="text-right"> <span>{{orderData.charges.fuelSurcharge.amount}} </span></p>
                                    </div>
                                 </div>
                                 <div class="row mt-3" *ngFor="let item of accessFeesInfo.accessFees; let i = index;">
                                    <div class="col-lg-12">
                                       <label class="control-label font-weight-bold text-3 text-dark"
                                          for="inputDefault"> Accessorial Fee</label>
                                    </div>
                                    <div class="col-lg-3">
                                       <ng-select placeholder="eg. Lumper" [(ngModel)]="item.type" name="accessfee_type{{i}}"
                                          class="form-control populate" >

                                          <ng-option value="Stop Off">Stop Off</ng-option>
                                          <ng-option value="Lumper">Lumper</ng-option>
                                          <ng-option value="Detention">Detention</ng-option>
                                          <ng-option value="Tarp">Tarp</ng-option>

                                       </ng-select>
                                       <!-- <div *ngIf="sltAccessorial.invalid && (sltAccessorial.dirty || sltAccessorial.touched)" class="text-danger">
                                          <div *ngIf="sltAccessorial.errors.required">
                                             Select valid accessorial fee from the list.
                                           </div>
                                      </div> -->
                                    </div>
                                    <div class="col-lg-3">
                                       <div class="input-group mb-3">
                                          <input (blur)="calculateAmount()"
                                             [(ngModel)]="item.amount" name="accessfee_amount{{i}}" type="number" min="0"
                                             class="form-control" placeholder="0.00" >
                                             <!-- <div *ngIf="aAmount.invalid && (aAmount.dirty || aAmount.touched)" class="text-danger">
                                                <div *ngIf="aAmount.errors.required">
                                                   Accessorial fee amount must contains numbers only.
                                                 </div>
                                            </div> -->
                                       </div>
                                    </div>
                                    <div class="col-lg-3">
                                       <ng-select (change)="changeCurrency($event)" [(ngModel)]="item.currency" name="accessfee_currency{{i}}"
                                       placeholder="select currency" class="form-control populate" data-select2-id="52" tabindex="-1" aria-hidden="true" >

                                          <ng-option value="CAD">CAD</ng-option>
                                          <ng-option value="USD">USD</ng-option>

                                       </ng-select>
                                       <!-- <div *ngIf="aCurrency.invalid && (aCurrency.dirty || aCurrency.touched)" class="text-danger">
                                          <div *ngIf="aCurrency.errors.required">
                                             Select valid currency from the list.
                                           </div>
                                      </div> -->
                                    </div>
                                    <div class="col-lg-1">
                                       <a *ngIf="i != 0" class="btn btn-danger btn-sm" (click)="deleteAccessFee('accessFee', i)" href="javascript:;"><i class="fas fa-minus"></i></a>
                                       <a *ngIf="i == 0" class="btn btn-success btn-sm" (click)="addAccessFee('accessFee')" href="javascript:;"><i class="fas fa-plus"></i></a>
                                    </div>
                                    <div class="col-lg-2">
                                       <p class="text-right"> <span>{{item.amount}} </span></p>
                                    </div>

                                 </div>


                                 <div class="row mt-3" *ngFor="let item of accessorialDeductionInfo.accessDeductions; let i = index;" >
                                    <div class="col-lg-12">
                                       <label class="control-label font-weight-bold text-3 text-dark"
                                          for="inputDefault">Accessorial Deduction</label>
                                    </div>
                                    <div class="col-lg-3">
                                       <ng-select placeholder="eg. Lumper" [(ngModel)]="item.type" name="type{{i}}"
                                          class="form-control populate" data-select2-id="61" tabindex="-1" aria-hidden="true" >

                                          <ng-option value="Stop Off" data-select2-id="63">Stop Off</ng-option>
                                          <ng-option value="Lumper">Lumper</ng-option>
                                          <ng-option value="Detention">Detention</ng-option>
                                          <ng-option value="Tarp">Tarp</ng-option>

                                       </ng-select>
                                       <!-- <div *ngIf="aDeduction.invalid && (aDeduction.dirty || aDeduction.touched)" class="text-danger">
                                          <div *ngIf="aDeduction.errors.required">
                                             Accessorial deduction amount must contains numbers only.
                                           </div>
                                      </div> -->
                                    </div>
                                    <div class="col-lg-3">
                                       <div class="input-group mb-3">
                                          <input (blur)="calculateAmount()"
                                             [(ngModel)]="item.amount" name="amount{{i}}"
                                             type="number"  min="0" class="form-control" placeholder="0.00" >
                                             <!-- <div *ngIf="dAmount.invalid && (dAmount.dirty || dAmount.touched)" class="text-danger">
                                                <div *ngIf="dAmount.errors.required">
                                                   Accessorial deduction must contains numbers only.
                                                 </div>
                                            </div> -->
                                       </div>
                                    </div>
                                    <div class="col-lg-3">
                                       <ng-select (change)="changeCurrency($event)" [(ngModel)]="item.currency" name="currency{{i}}"
                                          data-plugin-selecttwo="" placeholder="select currency"  class="form-control populate" data-select2-id="52"
                                          tabindex="-1" aria-hidden="true" >


                                          <ng-option value="CAD">CAD</ng-option>
                                          <ng-option value="USD">USD</ng-option>

                                       </ng-select>
                                       <!-- <div *ngIf="dCurrency.invalid && (dCurrency.dirty || dCurrency.touched)" class="text-danger">
                                          <div *ngIf="dCurrency.errors.required">
                                             Select valid currency from the list.
                                           </div>
                                      </div> -->
                                    </div>
                                    <div class="col-lg-1">
                                       <a *ngIf="i != 0" class="btn btn-danger btn-sm" (click)="deleteAccessFee('accessDeduct', i)" href="javascript:;"><i class="fas fa-minus"></i></a>
                                       <a *ngIf="i == 0" class="btn btn-success btn-sm" href="javascript:;" (click)="addAccessFee('accessDeduct')"><i class="fas fa-plus"></i></a>
                                    </div>


                                    <div class="col-lg-2">
                                       <p class="text-right"> <span>{{item.amount}} </span></p>
                                    </div>


                                 </div>

                                 <div class="row">
                                    <div class="col-lg-12">
                                       <div class="row mt-3 pb-1 mb-1">
                                          <div class="col-lg-9 pt-1">
                                             <h5 class="text-right font-weight-bold text-4 text-dark">Order Total</h5>
                                          </div>
                                          <div class="col-lg-3 mt-2 pt-1">
                                             <p class="text-right"><span [innerHTML]="subTotal"> </span></p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>


                                 <div class="row mt-3">
                                    <div class="col-lg-12 pl-3 mb-2">
                                       <div class="checkbox-custom checkbox-default">
                                          <input type="checkbox" id="ZeroRated" (change)="calculateAmount()" [(ngModel)]="orderData.zeroRated" name="zeroRated">
                                          <label class="control-label font-weight-semibold labelmt text-3 text-dark" for="ZeroRated">Exempt </label>
                                       </div>
                                    </div>
                                    <div class="col-lg-12" *ngIf="!orderData.zeroRated">
                                       <label class="control-label font-weight-bold text-3 text-dark" for="inputDefault">Province/State</label>
                                    </div>
                                    <div class="col-lg-9" *ngIf="!orderData.zeroRated">
                                       <ng-select
                                       [(ngModel)]="orderData.stateTaxID"
                                       name="stateTaxID"
                                        (change)="stateSelectChange()"
                                          class="form-control populate">
                                          <ng-option *ngFor="let stateTax of stateTaxes" selected value="{{stateTax.stateTaxID}}">{{stateTax.stateName}}</ng-option>
                                       </ng-select>
                                    </div>
                                 </div>

                                 <!-- <div class="row">
                                    <div class="col-lg-8">
                                       <div class="row mt-3" *ngFor="let item of orderData.taxesInfo; let i = index;">
                                          <div class="col-lg-2 offset-lg-3 pl-0">
                                             <label class="control-label font-weight-bold text-3 text-dark pt-2">{{item.name}}</label>
                                          </div>
                                          <div class="col-lg-3">
                                             <div class="input-group">
                                                <input type="text" class="form-control" value="{{item.amount}}" placeholder="0" disabled>
                                                <span class="input-group-append">
                                                   <span class="input-group-text pt-0 pb-0">
                                                      %
                                                   </span>
                                                </span>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                    <div class="col-lg-4">
                                       <div class="row">
                                          <div class="col-lg-9 bordtop pt-1">
                                             <h5 class="text-right font-weight-bold text-4 text-dark">Taxes</h5>
                                          </div>
                                          <div class="col-lg-3 bordtop pt-1">
                                             <p class="text-right">
                                                $<span [innerHTML]="tax"> </span>
                                             </p>
                                          </div>
                                       </div>
                                       <div class="row">
                                          <div class="col-lg-9 bordtop pt-1">
                                             <h5 class="text-right font-weight-bold text-4 text-dark">Total Amount</h5>
                                          </div>
                                          <div class="col-lg-3 bordtop pt-1">
                                             <p class="text-right"> $ <span [innerHTML]="totalAmount"> </span> </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div> -->


                                 <div class="row">
                                    <div class="col-lg-9">
                                       <div *ngIf="!orderData.zeroRated">
                                          <div class="row mt-4" *ngFor="let item of orderData.taxesInfo; let i = index;">
                                             <div class="col-lg-5">
                                                <input type="text" class="form-control" value="{{item.name}}" disabled>
                                             </div>
                                             <div class="col-lg-7">
                                                <div class="input-group">
                                                   <input type="text" class="form-control" placeholder="0.00" value="{{item.amount}}" disabled>
                                                   <span class="input-group-append">
                                                   <span class="input-group-text pt-0 pb-0">%</span>
                                                   </span>
                                                </div>
                                             </div>
                                          </div>
                                          <div class="row mt-3">
                                             <div class="col-lg-10 offset-lg-2">
                                                <span>&nbsp;</span>
                                             </div>
                                          </div>
                                       </div>

                                       <!-- <div class="row mt-3">
                                          <div class="col-lg-5">
                                             <input type="number" min="0"  name="advance" [(ngModel)]="orderData.advance" class="form-control" (blur)="calculateAmount()">
                                          </div>
                                       </div>
                                       <div class="row mt-4">
                                          <div class="col-lg-10 offset-lg-2">
                                             <span>&nbsp;</span>
                                          </div>
                                       </div> -->
                                    </div>
                                    <div class="col-lg-3">
                                       <div *ngIf="!orderData.zeroRated">
                                          <div class="row mt-4 pb-1 mb-1" *ngFor="let item of newTaxes; let i = index">
                                             <div class="col-lg-12 pt-1">
                                                <p class="text-right m-0">{{item.taxAmount ? item.taxAmount : 0}}</p>
                                             </div>
                                          </div>
                                       </div>

                                       <!-- <div class="row">
                                          <div class="col-lg-9 bordtop pt-1">
                                             <h5 class="text-right font-weight-bold text-4 text-dark">Advance Paid</h5>
                                          </div>
                                          <div class="col-lg-3 bordtop pt-1">
                                             <p class="text-right" [innerHTML]="orderData.advance"></p>
                                          </div>
                                       </div> -->
                                       <!-- <div class="row">
                                          <div class="col-lg-9 bordtop pt-1">
                                             <h5 class="text-right font-weight-bold text-4 text-dark">Total Amount to be Paid</h5>
                                          </div>
                                          <div class="col-lg-3 bordtop pt-1">
                                             <p class="text-right" [innerHTML]="orderData.finalAmount"></p>
                                          </div>
                                       </div> -->
                                    </div>
                                 </div>
                                 <div class="row mt-1">
                                    <div class="col-lg-9 bordtop pt-1">
                                       <h5 class="text-right font-weight-bold text-4 text-dark">Total Amount</h5>
                                    </div>
                                    <div class="col-lg-3 bordtop pt-1">
                                       <p class="text-right"><span [innerHTML]="totalAmount"> </span></p>
                                    </div>
                                 </div>

                              </div>

                           </div>
                           <div class="form-group row">
                              <div class="col-lg-11 text-right pr-0">
                                 <a href="javascript:;" routerLink="/dispatch/orders"
                                    class="mb-1 mt-1 mr-2 btn btn-default">Cancel</a>
                                 <button *ngIf="!getOrderID" type="button" (click)="onSubmit()" [disabled]="disableButton()" class="btn btn-success" >Save</button>
                                 <button *ngIf="getOrderID" type="button" (click)="updateOrder()" [disabled]="disableButton()" class="btn btn-success text-white" >Update</button>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>




               </form>




            </div>
         </div>
        </div>
     </section>
  </div>
</section>


<!-- VIEW DOCUMENT MODAL -->
<div class="modal fade" id="viewDocModal" tabindex="-1" role="dialog" aria-labelledby="viewDocModalLabel"
 aria-hidden="true">
 <div class="modal-dialog w-50 h-auto mx-auto mt-4" role="document">
   <div class="modal-content">
     <div class="modal-header">
       <h5 class="modal-title" id="viewDocModalLabel">View Document</h5>
       <button type="button" class="close" data-dismiss="modal" aria-label="Close">
         <span aria-hidden="true">&times;</span>
       </button>
     </div>
     <div class="modal-body">
       <div class="form-row">
         <div class="form-group col-md-12">
           <div>
             <iframe [src]='pdfSrc' frameborder="0" width="100%" height="400px"> </iframe>

           </div>
         </div>
       </div>

     </div>
     <div class="modal-footer">
       <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
     </div>
   </div>
 </div>
</div>


<!-- Add Customer MODAL -->
<div
  class="modal fade"
  id="addOrderCustomerModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="addOrderCustomerLabel"
  aria-hidden="true"
>
  <div class="modal-dialog w-50 h-auto mx-auto mt-4" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addOrderCustomerLabel">Which one you want to add?</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <ul class="customer-order__main m-0 p-0">
           <li>
              <a href="javascript:;" data-dismiss="modal" data-toggle="modal" data-target="#addBrokerModal">Broker</a>
           </li>
           <li>
            <a href="javascript:;" data-dismiss="modal" data-toggle="modal" data-target="#addCarrierModal">Carrier</a>
         </li>
           <li>
            <a href="javascript:;" data-dismiss="modal" data-toggle="modal" data-target="#addConsigneeModal">Receiver</a>
         </li>
         <li>
            <a href="javascript:;" data-dismiss="modal" data-toggle="modal" data-target="#addShipperModal">Shipper</a>
         </li>
         <li>
            <a href="javascript:;" data-dismiss="modal" data-toggle="modal" data-target="#addCustomerModal">Customer</a>
         </li>
         <li>
            <a href="javascript:;" data-dismiss="modal" data-toggle="modal" data-target="#addFCModal">Factoring Company</a>
         </li>
         <li>
            <a href="javascript:;" data-dismiss="modal" data-toggle="modal" data-target="#addOwnerOperatorModal">Owner Operator</a>
         </li>
        </ul>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-default"
          data-dismiss="modal"
        >
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>
