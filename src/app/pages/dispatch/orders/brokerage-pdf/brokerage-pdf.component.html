<ng-template #ordBrokeragePrev let-modal>
  <div class="modal-content">
    <div class="modal-header">
      <h4 class="modal-title">Carrier Confirmation Preview</h4>
      <button type="button" class="close" (click)="modal.dismiss()">
        &times;
      </button>
    </div>
    <form>
      <div class="modal-body">
        <section class="cheque-wrapper p-2" id="print_brokerage">
          <table
            class="text-dark"
            width="95%"
            border="0"
            align="center"
            cellpadding="0"
            cellspacing="0"
          >
            <tbody>
              <tr>
                <td align="left">
                  <h1 style="font-size: 22px; font-weight: 700; margin: 0px">
                    Carrier Confirmation
                  </h1>
                </td>
                <td align="right">
                  <img
                    crossorigin="anonymous"
                    *ngIf="companyLogoSrc"
                    [src]="companyLogoSrc"
                    alt="logo"
                    style="max-width: 100px"
                  />
                  <p
                    *ngIf="tagLine && tagLine !== ''"
                    class="m-0 font-weight-bold text-dark"
                  >
                    {{ tagLine }}
                  </p>
                </td>
              </tr>
              <tr>
                <td colspan="2" height="1" bgcolor="#bbbbbb"></td>
              </tr>
              <tr>
                <td width="50%" valign="top">
                  <h2
                    style="
                      font-size: 18px;
                      font-weight: 600;
                      margin-bottom: 1px;
                      margin-top: 1px;
                      text-transform: uppercase;
                    "
                  >
                    {{ orderData.carrierData.companyName }}
                  </h2>
                  <p
                    style="font-size: 12px; margin-bottom: 2px"
                    class="text-dark"
                  >
                    {{ orderData.carrierData.address }}<br />
                    <strong>Phone:</strong> {{ orderData.carrierData.phone
                    }}<br />
                    <strong>Fax:</strong> {{ orderData.carrierData.fax }}
                    <br />
                    <strong>Email:</strong> {{ orderData.carrierData.email }}
                  </p>
                </td>
                <td width="50%" valign="middle">
                  <!-- company logo -->
                </td>
              </tr>
              <tr>
                <td colspan="2" height="1" bgcolor="#bbbbbb"></td>
              </tr>
              <tr>
                <td width="50%" valign="top">
                  <h2
                    style="
                      font-size: 18px;
                      font-weight: 600;
                      margin-bottom: 1px;
                      margin-top: 1px;
                      text-transform: uppercase;
                    "
                  >
                    Carrier: {{ carrierData.name }}
                  </h2>
                  <p
                    style="font-size: 12px; margin-bottom: 2px"
                    class="text-dark"
                  >
                    {{ carrierData.address }}<br />
                    <strong>Phone:</strong> {{ carrierData.phone }}<br />
                    <strong>Email:</strong> {{ carrierData.email }}<br />

                    <strong
                      style="
                        font-size: 18px;
                        margin-bottom: 2px;
                        margin-top: 3px;
                      "
                      >Agreed Amount</strong
                    ><br />
                    <strong style="font-size: 26px; margin-bottom: 2px"
                      >{{ brokerage.brokerageAmount | number: "1.2-2" }}
                      {{ brokerage.brkCurrency }}</strong
                    ><br />
                  </p>
                </td>
                <td valign="top">
                  <table
                    width="95%"
                    border="0"
                    align="right"
                    cellpadding="0"
                    cellspacing="0"
                  >
                    <tbody>
                      <tr>
                        <td width="40" colspan="2">
                          <h2
                            style="
                              font-size: 18px;
                              font-weight: 600;
                              margin-bottom: 1px;
                              margin-top: 1px;
                            "
                          >
                            Order Detail
                          </h2>
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <table
                            class="text-dark"
                            width="100%"
                            border="0"
                            style="
                              border: 1px solid #adadad;
                              font-size: 12px;
                              margin-bottom: 10px;
                            "
                            cellpadding="0"
                            cellspacing="0"
                          >
                            <tbody class="text-dark">
                              <tr>
                                <td
                                  style="
                                    border-bottom: 1px solid #adadad;
                                    border-right: 1px solid #adadad;
                                    padding-left: 10px;
                                  "
                                  bgcolor="#f3f3f3"
                                  width="25%"
                                >
                                  <p style="font-weight: 600; color: #000000">
                                    Order#
                                  </p>
                                </td>
                                <td
                                  style="
                                    border-bottom: 1px solid #adadad;
                                    border-right: 1px solid #adadad;
                                    padding-left: 10px;
                                  "
                                >
                                  <p style="color: #000000">
                                    {{ brokerage.orderNo }}
                                  </p>
                                </td>
                                <td
                                  style="
                                    border-bottom: 1px solid #adadad;
                                    border-right: 1px solid #adadad;
                                    padding-left: 10px;
                                  "
                                  width="25%"
                                  bgcolor="#f3f3f3"
                                >
                                  <p style="font-weight: 600; color: #000000">
                                    Distance
                                  </p>
                                </td>
                                <td
                                  style="
                                    border-bottom: 1px solid #adadad;
                                    padding-left: 10px;
                                    color: #000000;
                                  "
                                >
                                  <p style="color: #000000">
                                    {{ brokerage.miles }}
                                    mi
                                  </p>
                                </td>
                              </tr>
                              <tr>
                                <td
                                  style="
                                    border-bottom: 1px solid #adadad;
                                    border-right: 1px solid #adadad;
                                    padding-left: 10px;
                                  "
                                  bgcolor="#f3f3f3"
                                >
                                  <p style="font-weight: 600; color: #000000">
                                    Today Date
                                  </p>
                                </td>
                                <td
                                  colspan="3"
                                  style="
                                    border-bottom: 1px solid #adadad;
                                    border-right: 1px solid #adadad;
                                    padding-left: 10px;
                                  "
                                >
                                  <p style="color: #000000">
                                    {{ brokerage.today | date: "yyyy/MM/dd" }}
                                  </p>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td colspan="2" height="1" bgcolor="#bbbbbb"></td>
              </tr>
              <tr>
                <td colspan="2">
                  <table width="100%">
                    <tbody>
                      <tr *ngFor="let ship of orderData.data; let i = index">
                        <td>
                          <table width="100%">
                            <tbody>
                              <tr>
                                <td colspan="2">
                                  <h2
                                    style="
                                      font-size: 18px;
                                      font-weight: 600;
                                      margin-bottom: 1px;
                                      margin-top: 1px;
                                    "
                                  >
                                    Shipment - {{ i + 1 }}
                                  </h2>
                                </td>
                              </tr>
                              <tr>
                                <td colspan="2">
                                  <table
                                    width="100%"
                                    border="0"
                                    style=""
                                    cellspacing="0"
                                    cellpadding="0"
                                  >
                                    <tbody>
                                      <table
                                        width="100%"
                                        style="
                                          border: 1px solid #adadad;
                                          font-size: 12px;
                                        "
                                      >
                                        <tbody>
                                          <tr bgcolor="#f3f3f3">
                                            <td
                                              width="40%"
                                              style="
                                                border-bottom: 1px solid #adadad;
                                                border-right: 1px solid #adadad;
                                                padding-left: 10px;
                                              "
                                            >
                                              <p
                                                style="
                                                  font-weight: 600;
                                                  color: #000000;
                                                  margin-bottom: 1px;
                                                "
                                              >
                                                Shipper
                                              </p>
                                            </td>
                                            <td
                                              width="60%"
                                              style="
                                                border-bottom: 1px solid #adadad;
                                                border-right: 1px solid #adadad;
                                                padding-left: 10px;
                                              "
                                            >
                                              <p
                                                style="
                                                  font-weight: 600;
                                                  color: #000000;
                                                  margin-bottom: 1px;
                                                "
                                              >
                                                Pickup(s)
                                              </p>
                                            </td>
                                          </tr>
                                          <tr
                                            *ngFor="let shipr of ship.allShipp"
                                          >
                                            <td
                                              style="
                                                border-right: 1px solid #adadad;
                                                padding-left: 10px;
                                              "
                                            >
                                              <p
                                                style="
                                                  color: #000000;
                                                  text-transform: uppercase;
                                                "
                                              >
                                                <strong>
                                                  {{
                                                    shipr.companyName
                                                  }} </strong
                                                ><br />
                                                {{ shipr.shipAddress }}
                                              </p>
                                            </td>
                                            <td
                                              style="
                                                border-right: 1px solid #adadad;
                                                padding-left: 10px;
                                              "
                                            >
                                              <span
                                                *ngFor="
                                                  let pick of shipr.pickupPoint;
                                                  let sind = index
                                                "
                                              >
                                                <span
                                                  *ngIf="!pick.address.manual"
                                                  >{{ sind + 1 }})
                                                  {{
                                                    pick.address.pickupLocation
                                                  }}
                                                </span>
                                                <span
                                                  *ngIf="pick.address.manual"
                                                  >{{ sind + 1 }})
                                                  {{ pick.address.address }},
                                                  {{ pick.address.cityName }},
                                                  {{ pick.address.stateName }},
                                                  {{ pick.address.countryName }}
                                                </span>
                                                <br /><strong
                                                  >Date and Time:
                                                </strong>
                                                {{ pick.dateAndTime }}<br />
                                                <strong>Commodity:</strong>
                                                <span
                                                  *ngFor="
                                                    let comm of pick.commodity;
                                                    let cind = index
                                                  "
                                                >
                                                  <br />
                                                  {{ cind + 1 }})
                                                  <strong> Name: </strong
                                                  >{{ comm.name }}
                                                  <strong>, Weight: </strong>
                                                  {{ comm.weight }}
                                                  {{ comm.weightUnit }}
                                                  <strong>, Quantity: </strong>
                                                  {{ comm.quantity }}
                                                  {{ comm.quantityUnit }}
                                                  <strong> , PU#: </strong>
                                                  {{ comm.pu }}
                                                  <br />
                                                </span>
                                                <strong> Customer PO#: </strong>
                                                <span
                                                  *ngFor="
                                                    let po of pick.customerPO;
                                                    let poin = index
                                                  "
                                                >
                                                  {{ po }}
                                                  <span
                                                    *ngIf="
                                                      poin <
                                                      pick.customerPO.length - 1
                                                    "
                                                    >,</span
                                                  >
                                                </span>
                                              </span>
                                              <br />
                                            </td>
                                          </tr>
                                          <tr>
                                            <td
                                              colspan="3"
                                              style="margin-top: 20px"
                                            >
                                              <table
                                                width="100%"
                                                border="0"
                                                style="font-size: 13px"
                                                cellspacing="0"
                                                cellpadding="0"
                                              >
                                                <tbody>
                                                  <tr bgcolor="#f3f3f3">
                                                    <td
                                                      width="40%"
                                                      style="
                                                        border-bottom: 1px solid
                                                          #adadad;
                                                        border-top: 1px solid
                                                          #adadad;
                                                        border-right: 1px solid
                                                          #adadad;
                                                        padding-left: 10px;
                                                      "
                                                    >
                                                      <p
                                                        style="
                                                          color: #000000;
                                                          font-weight: 600;
                                                          margin-bottom: 1px;
                                                        "
                                                      >
                                                        Receiver
                                                      </p>
                                                    </td>
                                                    <td
                                                      width="60%"
                                                      style="
                                                        border-bottom: 1px solid
                                                          #adadad;
                                                        border-top: 1px solid
                                                          #adadad;
                                                        padding-left: 10px;
                                                      "
                                                    >
                                                      <p
                                                        style="
                                                          color: #000000;
                                                          font-weight: 600;
                                                          margin-bottom: 1px;
                                                        "
                                                      >
                                                        Drop(s)
                                                      </p>
                                                    </td>
                                                  </tr>
                                                  <tr
                                                    *ngFor="
                                                      let recvr of ship.allRec
                                                    "
                                                  >
                                                    <td
                                                      style="
                                                        border-right: 1px solid
                                                          #adadad;
                                                        padding-left: 10px;
                                                        text-transform: uppercase;
                                                      "
                                                    >
                                                      <p
                                                        style="
                                                          color: #000000;
                                                          font-size: 13px;
                                                        "
                                                      >
                                                        <strong>{{
                                                          recvr.companyName
                                                        }}</strong
                                                        ><br />
                                                        {{ recvr.shipAddress }}
                                                      </p>
                                                    </td>
                                                    <td
                                                      style="padding-left: 10px"
                                                    >
                                                      <span
                                                        *ngFor="
                                                          let drop of recvr.dropPoint;
                                                          let rind = index
                                                        "
                                                      >
                                                        <span
                                                          *ngIf="
                                                            !drop.address.manual
                                                          "
                                                          >{{ rind + 1 }})
                                                          {{
                                                            drop.address
                                                              .dropOffLocation
                                                          }}
                                                        </span>
                                                        <span
                                                          *ngIf="
                                                            drop.address.manual
                                                          "
                                                          >{{ rind + 1 }})
                                                          {{
                                                            drop.address
                                                              .address
                                                          }},
                                                          {{
                                                            drop.address
                                                              .cityName
                                                          }},
                                                          {{
                                                            drop.address
                                                              .stateName
                                                          }},
                                                          {{
                                                            drop.address
                                                              .countryName
                                                          }}
                                                        </span>
                                                        <br /><strong
                                                          >Date and Time:
                                                        </strong>
                                                        {{ drop.dateAndTime
                                                        }}<br />
                                                        <strong
                                                          >Commodity:</strong
                                                        >
                                                        <span
                                                          *ngFor="
                                                            let comm of drop.commodity;
                                                            let cind = index
                                                          "
                                                        >
                                                          <br />
                                                          {{ cind + 1 }})
                                                          <strong>
                                                            Name: </strong
                                                          >{{ comm.name }}
                                                          <strong
                                                            >, Weight:
                                                          </strong>
                                                          {{ comm.weight }}
                                                          {{ comm.weightUnit }}
                                                          <strong
                                                            >, Quantity:
                                                          </strong>
                                                          {{ comm.quantity }}
                                                          {{
                                                            comm.quantityUnit
                                                          }}
                                                          <strong>
                                                            , DU#:
                                                          </strong>
                                                          {{ comm.del }}
                                                          <br />
                                                        </span>
                                                        <br />
                                                      </span>
                                                    </td>
                                                  </tr>
                                                </tbody>
                                              </table>
                                            </td>
                                          </tr>
                                        </tbody>
                                      </table>
                                      <tr>
                                        <td colspan="3">&nbsp;</td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td colspan="2">&nbsp;</td>
              </tr>

              <tr>
                <td colspan="2">&nbsp;</td>
              </tr>
              <div class="html2pdf__page-break"></div>

              <tr *ngIf="brokerage.instructions">
                <td colspan="2">
                  <p
                    style="
                      font-size: 13px;
                      color: #000000;

                      text-transform: uppercase;
                      margin-top: 2px;
                      margin-bottom: 12px;
                    "
                  >
                    <strong
                      ><span
                        style="
                          background: #ffff00;
                          padding-top: 2px;
                          padding-bottom: 2px;
                        "
                        >Special Instructions:
                        {{ brokerage.instructions }}</span
                      >
                    </strong>
                  </p>
                </td>
              </tr>

              <tr *ngIf="carrierTerms !== ''">
                <td colspan="2">
                  <p
                    style="
                      font-size: 14px;
                      color: #000000;
                      line-height: 18px;
                      margin-top: 12px;
                    "
                  >
                    <strong>Terms And Conditions For Carrier:</strong>
                    {{ carrierTerms }}
                  </p>
                </td>
              </tr>

              <tr>
                <td colspan="2">
                  <p
                    style="
                      font-size: 13px;
                      color: #000000;
                      line-height: 18px;
                      margin-top: 12px;
                    "
                  >
                    <strong
                      >Please send all invoices and accounting queries to
                      {{ orderData.carrierData.email }}</strong
                    >
                  </p>
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <table width="100%" cellspacing="0" cellpadding="0">
                    <tbody>
                      <tr>
                        <td width="10%">
                          <p style="font-size: 13px; color: #000000">
                            <strong>Accepted By: </strong>
                          </p>
                        </td>
                        <td width="23%" style="border-bottom: solid 1px #999">
                          &nbsp;
                        </td>
                        <td width="10%">
                          <strong style="font-size: 13px; color: #000000"
                            >Date:</strong
                          >
                        </td>
                        <td width="23%" style="border-bottom: solid 1px #999">
                          &nbsp;
                        </td>
                        <td width="10%">
                          <p style="font-size: 13px; color: #000000">
                            <strong>Signature</strong>
                          </p>
                        </td>
                        <td style="border-bottom: solid 1px #999">&nbsp;</td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td colspan="2">&nbsp;</td>
              </tr>
              <tr>
                <td colspan="2">
                  <table
                    border="0"
                    align="center"
                    cellpadding="0"
                    cellspacing="0"
                  >
                    <tbody>
                      <tr>
                        <td align="center">
                          <h2 style="font-size: 13px">Powered By</h2>
                          <img
                            alt="Fleet Hawks
                                                            Inc."
                            [src]="logoSrc"
                            width="207"
                            height="28"
                          />
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td colspan="2">&nbsp;</td>
              </tr>
            </tbody>
          </table>
        </section>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" (click)="modal.dismiss()">
          Close
        </button>
        <button type="button" class="btn btn-success" (click)="generatePDF()">
          Download
        </button>
        <button
          type="button"
          *ngIf="type === 'detail'"
          class="btn btn-success"
          (click)="openEmailInv()"
        >
          Send Email
        </button>
      </div>
    </form>
  </div>
</ng-template>

<ng-template #emailBrokerageModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Send Brokerage</h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <form>
    <div class="modal-body">
      <div class="email--invoice__main">
        <div class="row align-items-center mb-2">
          <div class="col-12">
            <label
              class="control-label font-weight-bold mt-2 text-3 text-dark"
              for="inputDefault"
              >Order#: {{ orderData.orderNumber }}
            </label>
          </div>

          <div class="col-12">
            <label
              class="control-label font-weight-bold mt-2 text-3 text-dark"
              for="inputDefault"
              >Send To:
              <small> You can add multiple email(s)</small>
              <span class="mandfield text-2 ml-1"><sup>*</sup> </span>
            </label>
            <ng-select
              multiple="true"
              notFoundText="Please type
                                to add email"
              [addTag]="true"
              placeholder="eg. johnsmith@gmail.com"
              [(ngModel)]="brokEmails"
              name="emails"
              type="text"
              class="form-control h-auto"
              pattern="^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9]+$"
            >
            </ng-select>
          </div>
          <div class="col-12">
            <label
              class="control-label font-weight-bold mt-2 text-3 text-dark"
              for="inputDefault"
              >Subject line:
              <span class="mandfield text-2 ml-1"><sup>*</sup></span></label
            >
            <input
              type="text"
              [(ngModel)]="brokEmail.subject"
              class="form-control"
              placeholder="Enter subject"
              name="subject"
            />
          </div>
          <div class="col-12 mt-2">
            <input
              class="form-check-input ml-0"
              name="copyBrok"
              [(ngModel)]="brokEmail.sendCopy"
              type="checkbox"
              value=""
              id="copy"
            />
            <label class="form-check-label pl-3" for="copy">
              Send me a copy at <strong> {{ brokEmail.carrierEmail }}</strong>
            </label>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button
        type="button"
        (click)="modal.dismiss('Cross click')"
        class="btn btn-default"
      >
        Cancel
      </button>
      <button
        type="submit"
        [disabled]="isEmail"
        (click)="addEmails()"
        class="btn btn-success"
      >
        Submit
      </button>
    </div>
  </form>
</ng-template>
