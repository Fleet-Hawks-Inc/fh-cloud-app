{"ast":null,"code":"import _asyncToGenerator from \"C:/FH/fh-cloud-app/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"!C:\\\\FH\\\\fh-cloud-app\\\\node_modules\\\\@ngtools\\\\webpack\\\\src\\\\loaders\\\\direct-resource.js!./sales-invoice-detail.component.html\";\nimport __NG_CLI_RESOURCE__1 from \"./sales-invoice-detail.component.css\";\nimport { Component, ViewChild } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { AccountService, ApiService } from 'src/app/services';\nimport * as html2pdf from \"html2pdf.js\";\nimport { ToastrService } from 'ngx-toastr';\nlet SalesInvoiceDetailComponent = class SalesInvoiceDetailComponent {\n  constructor(accountService, toaster, modalService, apiService, route) {\n    this.accountService = accountService;\n    this.toaster = toaster;\n    this.modalService = modalService;\n    this.apiService = apiService;\n    this.route = route;\n    this.transactionLog = [];\n    this.isPDF = false;\n    this.emailDisabled = false;\n  }\n\n  ngOnInit() {\n    this.saleID = this.route.snapshot.params[`saleID`];\n\n    if (this.saleID) {\n      this.fetchSaleOrder();\n    }\n  }\n\n  fetchSaleOrder() {\n    this.accountService.getData(`sales-invoice/detail/${this.saleID}`).subscribe(res => {\n      let result = res[0];\n      this.txnDate = result.txnDate;\n      this.cName = result.customerName;\n      this.cusAddress = result.address;\n      this.cusPhone = result.workPhone;\n      this.cusEmail = result.workEmail;\n      this.finalTotal = result.total.finalTotal;\n      this.balance = result.balance;\n      this.received = this.finalTotal - this.balance;\n      this.currency = result.currency;\n      this.paymentTerm = result.paymentTerm;\n      this.dueDate = result.dueDate;\n      this.shipDate = result.shipDate;\n      this.sRef = result.sRef;\n      this.salePerson = result.salePerson;\n      this.remarks = result.remarks;\n      this.sOrderDetails = result.sOrderDetails;\n      this.status = result.status;\n      this.sInvNo = result.sInvNo;\n      this.taxes = result.charges.taxes;\n      this.chargeName = result.charges.cName;\n      this.chargeType = result.charges.cType;\n      this.chargeAmount = result.charges.cAmount;\n      this.isPDF = true;\n      this.isInvDue = result.due;\n      this.logo = result.logo;\n      this.tagline = result.tagline;\n      this.payStatus = result.payStatus;\n      this.transactionLog = result.transactionLog;\n    });\n  }\n\n  openModal() {\n    let ngbModalOptions = {\n      keyboard: false,\n      backdrop: \"static\",\n      windowClass: \"preview-sale-invoice\"\n    };\n    this.saleInvPrev = this.modalService.open(this.previewSaleInvoice, ngbModalOptions);\n  }\n\n  generatePDF() {\n    var data = document.getElementById(\"print_invoice\");\n    html2pdf(data, {\n      margin: 0.5,\n      pagebreak: {\n        mode: \"avoid-all\",\n        before: \"print_invoice\"\n      },\n      filename: \"sale-invoice.pdf\",\n      image: {\n        type: \"jpeg\",\n        quality: 0.98\n      },\n      html2canvas: {\n        dpi: 300,\n        letterRendering: true,\n        allowTaint: true,\n        useCORS: true\n      },\n      jsPDF: {\n        unit: \"in\",\n        format: \"a4\",\n        orientation: \"landscape\"\n      }\n    });\n    this.saleInvPrev.close();\n  }\n\n  sendConfirmationEmail() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.emailDisabled = true;\n      let result = yield _this.accountService.getData(`sales-invoice/send/confirmation-email/${_this.saleID}`).toPromise();\n      _this.emailDisabled = false;\n\n      if (result) {\n        _this.toaster.success(\"Email sent successfully\");\n      } else {\n        _this.toaster.error(\"Something went wrong.\");\n      }\n    })();\n  }\n\n};\n\nSalesInvoiceDetailComponent.ctorParameters = () => [{\n  type: AccountService\n}, {\n  type: ToastrService\n}, {\n  type: NgbModal\n}, {\n  type: ApiService\n}, {\n  type: ActivatedRoute\n}];\n\nSalesInvoiceDetailComponent.propDecorators = {\n  previewSaleInvoice: [{\n    type: ViewChild,\n    args: [\"previewSaleInvoice\", {\n      static: true\n    }]\n  }]\n};\nSalesInvoiceDetailComponent = __decorate([Component({\n  selector: 'app-sales-invoice-detail',\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], SalesInvoiceDetailComponent);\nexport { SalesInvoiceDetailComponent };","map":null,"metadata":{},"sourceType":"module"}