{"ast":null,"code":"import _asyncToGenerator from \"C:/FH/fh-cloud-app/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"!C:\\\\FH\\\\fh-cloud-app\\\\node_modules\\\\@ngtools\\\\webpack\\\\src\\\\loaders\\\\direct-resource.js!./purchase-order-detail.component.html\";\nimport __NG_CLI_RESOURCE__1 from \"./purchase-order-detail.component.css\";\nimport { Component } from \"@angular/core\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { ToastrService } from \"ngx-toastr\";\nimport { AccountService } from \"src/app/services/account.service\";\nimport { ApiService } from \"src/app/services/api.service\";\nlet PurchaseOrderDetailComponent = class PurchaseOrderDetailComponent {\n  constructor(accountService, route, apiService, toaster) {\n    this.accountService = accountService;\n    this.route = route;\n    this.apiService = apiService;\n    this.toaster = toaster;\n    this.commDetails = [];\n    this.taxes = [];\n    this.emailDisabled = false;\n    this.documents = [];\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.purchaseID = _this.route.snapshot.params[\"purchaseID\"];\n      yield _this.fetchDetails();\n    })();\n  }\n\n  fetchDetails() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      let result = yield _this2.accountService.getData(`purchase-orders/details/${_this2.purchaseID}`).toPromise();\n      yield _this2.fetchVendor(result[0].vendorID);\n      _this2.txnDate = result[0].txnDate;\n      _this2.currency = result[0].currency;\n      _this2.finalTotal = result[0].total.finalTotal;\n      _this2.refNo = result[0].refNo;\n      _this2.remarks = result[0].remarks;\n      _this2.poType = result[0].poType;\n      _this2.orderNo = result[0].orderNo;\n      _this2.status = result[0].status;\n      _this2.billStatus = result[0].billStatus;\n      _this2.commDetails = result[0].detail;\n\n      if (result[0].docs.length > 0) {\n        result[0].docs.forEach(x => {\n          let obj = {};\n\n          if (x.storedName.split(\".\")[1] === \"jpg\" || x.storedName.split(\".\")[1] === \"png\" || x.storedName.split(\".\")[1] === \"jpeg\") {\n            obj = {\n              imgPath: `${x.urlPath}`,\n              docPath: `${x.urlPath}`,\n              displayName: x.displayName,\n              name: x.storedName,\n              ext: x.storedName.split(\".\")[1]\n            };\n          } else {\n            obj = {\n              imgPath: \"assets/img/icon-pdf.png\",\n              docPath: `${x.urlPath}`,\n              displayName: x.displayName,\n              name: x.storedName,\n              ext: x.storedName.split(\".\")[1]\n            };\n          }\n\n          _this2.documents.push(obj);\n        });\n      }\n    })();\n  }\n\n  deleteDocument(name, index) {\n    this.accountService.deleteData(`purchase-orders/uploadDelete/${this.purchaseID}/${name}`).subscribe(result => {\n      this.documents.splice(index, 1);\n      this.toaster.success(\"Attachment deleted successfully.\");\n    });\n  }\n\n  fetchVendor(vendorID) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      let result = yield _this3.apiService.getData(`contacts/minor/detail/${vendorID}`).toPromise();\n\n      if (result.Items.length > 0) {\n        _this3.vendorName = result.Items[0].cName;\n      }\n    })();\n  }\n\n  sendConfirmationEmail() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      _this4.emailDisabled = true;\n      let result = yield _this4.accountService.getData(`purchase-orders/send/confirmation-email/${_this4.purchaseID}`).toPromise();\n      _this4.emailDisabled = false;\n\n      if (result) {\n        _this4.toaster.success(\"Email sent successfully\");\n      } else {\n        _this4.toaster.error(\"Something went wrong.\");\n      }\n    })();\n  }\n\n};\n\nPurchaseOrderDetailComponent.ctorParameters = () => [{\n  type: AccountService\n}, {\n  type: ActivatedRoute\n}, {\n  type: ApiService\n}, {\n  type: ToastrService\n}];\n\nPurchaseOrderDetailComponent = __decorate([Component({\n  selector: \"app-purchase-order-detail\",\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], PurchaseOrderDetailComponent);\nexport { PurchaseOrderDetailComponent };","map":null,"metadata":{},"sourceType":"module"}