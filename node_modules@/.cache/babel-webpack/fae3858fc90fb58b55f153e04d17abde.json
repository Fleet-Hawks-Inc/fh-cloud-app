{"ast":null,"code":"import _asyncToGenerator from \"C:/FH/fh-cloud-app/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"!C:\\\\FH\\\\fh-cloud-app\\\\node_modules\\\\@ngtools\\\\webpack\\\\src\\\\loaders\\\\direct-resource.js!./expense-payment-list.component.html\";\nimport __NG_CLI_RESOURCE__1 from \"./expense-payment-list.component.css\";\nimport { Component } from \"@angular/core\";\nimport { ToastrService } from \"ngx-toastr\";\nimport Constants from \"src/app/pages/fleet/constants\";\nimport { AccountService } from \"src/app/services/account.service\";\nimport { DashboardUtilityService } from \"src/app/services/dashboard-utility.service\";\nlet ExpensePaymentListComponent = class ExpensePaymentListComponent {\n  constructor(accountService, toaster, dashboardUtilityService) {\n    this.accountService = accountService;\n    this.toaster = toaster;\n    this.dashboardUtilityService = dashboardUtilityService;\n    this.dataMessage = Constants.FETCHING_DATA;\n    this.filter = {\n      startDate: null,\n      endDate: null,\n      type: null,\n      searchValue: null\n    };\n    this.dateMinLimit = {\n      year: 1950,\n      month: 1,\n      day: 1\n    };\n    this.date = new Date();\n    this.futureDatesLimit = {\n      year: this.date.getFullYear() + 30,\n      month: 12,\n      day: 31\n    };\n    this.payments = [];\n    this.lastItemSK = \"\";\n    this.loaded = false;\n    this.disableSearch = false;\n    this.driversObject = {};\n    this.carriersObject = {};\n    this.ownerOpObjects = {};\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.getList();\n\n      _this.driversObject = yield _this.dashboardUtilityService.getDrivers();\n      _this.carriersObject = yield _this.dashboardUtilityService.getContactsCarriers();\n      _this.ownerOpObjects = yield _this.dashboardUtilityService.getOwnerOperators();\n    })();\n  }\n\n  getList() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      let searchParam = \"\";\n\n      if (_this2.filter.searchValue !== null && _this2.filter.searchValue !== \"\") {\n        searchParam = _this2.filter.type === 'amount' || _this2.filter.type === 'paymentNo' ? encodeURIComponent(`\"${_this2.filter.searchValue}\"`) : `${_this2.filter.searchValue}`;\n      } else {\n        searchParam = null;\n      }\n\n      if (_this2.lastItemSK !== \"end\") {\n        const result = yield _this2.accountService.getData(`expense-payments/paging?type=${_this2.filter.type}&searchValue=${searchParam}&start=${_this2.filter.startDate}&end=${_this2.filter.endDate}&lastKey=${_this2.lastItemSK}`).toPromise();\n        _this2.lastItemSK = \"end\";\n        _this2.disableSearch = false;\n\n        if (result.length === 0) {\n          _this2.dataMessage = Constants.NO_RECORDS_FOUND;\n        } else {\n          if (result[result.length - 1].sk !== undefined) {\n            _this2.lastItemSK = encodeURIComponent(result[result.length - 1].sk);\n          }\n\n          _this2.loaded = true;\n        } // this.payments = result;\n\n\n        result.map(v => {\n          v.payMode = v.payMode.replace(\"_\", \" \");\n          v.paymentTo = v.paymentTo.replace(\"_\", \" \");\n          v.url = `/accounts/payments/expense-payments/detail/${v.paymentID}`;\n\n          _this2.payments.push(v);\n        });\n      }\n    })();\n  }\n\n  unitTypeChange() {\n    this.filter.searchValue = null;\n  }\n\n  searchFilter() {\n    if (this.filter.type != null && this.filter.searchValue == null) {\n      this.toaster.error('Please type value');\n      this.disableSearch = false;\n      return;\n    }\n\n    if (this.filter.startDate !== null || this.filter.endDate !== null || this.filter.searchValue !== null || this.filter.type !== null) {\n      this.disableSearch = true;\n      this.dataMessage = Constants.FETCHING_DATA;\n      this.payments = [];\n      this.lastItemSK = \"\";\n      this.getList();\n    }\n  }\n\n  resetFilter() {\n    this.disableSearch = true;\n    this.filter.startDate = null;\n    this.filter.endDate = null;\n    this.filter.searchValue = null;\n    this.filter.type = null;\n    this.lastItemSK = \"\";\n    this.dataMessage = Constants.FETCHING_DATA;\n    this.payments = [];\n    this.getList();\n  }\n\n  onScroll() {\n    if (this.loaded) {\n      this.getList();\n    }\n\n    this.loaded = false;\n  }\n\n};\n\nExpensePaymentListComponent.ctorParameters = () => [{\n  type: AccountService\n}, {\n  type: ToastrService\n}, {\n  type: DashboardUtilityService\n}];\n\nExpensePaymentListComponent = __decorate([Component({\n  selector: \"app-expense-payment-list\",\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], ExpensePaymentListComponent);\nexport { ExpensePaymentListComponent };","map":null,"metadata":{},"sourceType":"module"}